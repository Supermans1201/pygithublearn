From c71d18dc2a8afc4f784c8581c6d1bcbd41f08064 Mon Sep 17 00:00:00 2001
From: Geert Janssens <janssens-geert@telenet.be>
Date: Mon, 17 Feb 2014 10:54:57 +0100
Subject: [PATCH 01/16] Improved Dutch translation

Translate new strings (except for currenties)
Fix some typos
Account should be translated as 'rekening' instead of 'dagboek'
---
 app/res/values-nl/strings.xml | 142 +++++++++++++++++++++---------------------
 1 file changed, 71 insertions(+), 71 deletions(-)

diff --git a/app/res/values-nl/strings.xml b/app/res/values-nl/strings.xml
index be088a28..c8f6b76e 100644
--- a/app/res/values-nl/strings.xml
+++ b/app/res/values-nl/strings.xml
@@ -18,13 +18,13 @@
 
 <resources>
     <string name="app_name">GnuCash</string>
-    <string name="title_add_account">Nieuw dagboek</string>
-    <string name="title_edit_account">Dagboek bewerken</string>
+    <string name="title_add_account">Nieuw rekening</string>
+    <string name="title_edit_account">Rekening bewerken</string>
     <string name="info_details">Info</string>
     <string name="menu_export_ofx">OFX exporteren</string>
-    <string name="description_add_transaction_icon">Nieuwe transactie in een dagboek</string>
-    <string name="label_no_accounts">Geen dagboeken beschikbaar</string>
-    <string name="label_account_name">Dagboeknaam</string>
+    <string name="description_add_transaction_icon">Nieuwe transactie in een rekening</string>
+    <string name="label_no_accounts">Geen rekeningen beschikbaar</string>
+    <string name="label_account_name">Rekeningnaam</string>
     <string name="btn_cancel">Annuleren</string>
     <string name="btn_save">Bewaren</string>
     <string name="label_no_transactions_to_display">Geen transacties beschikbaar</string>
@@ -33,17 +33,17 @@
     <string name="title_add_transaction">Nieuwe transactie</string>
     <string name="label_no_transactions">Geen transacties beschikbaar</string>
     <string name="label_timeanddate">Datum &amp; Tijd</string>
-    <string name="label_account">Dagboek</string>
+    <string name="label_account">Rekening</string>
     <string name="label_debit">Debet</string>
     <string name="label_credit">Credit</string>
-    <string name="title_accounts">Dagboeken</string>
+    <string name="title_accounts">Rekeningen</string>
     <string name="title_transactions">Transacties</string>
     <string name="menu_delete">Verwijderen</string>
     <string name="alert_dialog_ok_delete">Verwijderen</string>
     <string name="alert_dialog_cancel">Annuleren</string>
-    <string name="toast_account_deleted">Het dagboek werd verwijderd</string>
+    <string name="toast_account_deleted">De rekening werd verwijderd</string>
     <string name="title_confirm_delete">Verwijderen bevestigen</string>
-    <string name="delete_account_confirmation_message">Alle transacties in dit dagboek zullen ook verwijderd worden</string>
+    <string name="delete_account_confirmation_message">Alle transacties in deze rekening zullen ook verwijderd worden</string>
     <string name="title_edit_transaction">Transactie bewerken</string>
     <string name="label_transaction_description">Opmerking</string>
     <string name="menu_move">Verplaatsen</string>
@@ -64,24 +64,24 @@
     </string-array>
     <string name="btn_move">Verplaatsen</string>
     <string name="title_move_transactions">%1$d transactie(s) verplaatsen</string>
-    <string name="label_move_destination">Bestemmingsdagboek</string>
+    <string name="label_move_destination">Bestemmingsrekening</string>
     <string name="permission_access_sdcard">SD kaart benaderen</string>
     <string name="title_share_ofx_with">OFX data verzenden via&#8230;</string>
-    <string name="toast_incompatible_currency">Transacties kunnen niet verplaatst worden.\nHet munteenheid van het dagboeken is niet compatibel</string>
+    <string name="toast_incompatible_currency">Transacties kunnen niet verplaatst worden.\nDe munteenheden van de rekeningen zijn niet compatibel</string>
     <string name="header_general_settings">Algemeen</string>
     <string name="header_about_gnucash">Over</string>
     <string name="title_choose_currency">Standaard munteenheid kiezen</string>
     <string name="title_default_currency">Standaard munteenheid</string>
-    <string name="summary_default_currency">Standaard munteenheid voor nieuwe dagboeken</string>
+    <string name="summary_default_currency">Standaard munteenheid voor nieuwe rekeningen</string>
     <string name="label_permission_record_transactions">Staat het bewaren van transacties in GnuCash for Android toe</string>
-    <string name="label_permission_create_accounts">Staat het aanmaken van dagboeken in GnuCash for Android toe</string>
+    <string name="label_permission_create_accounts">Staat het aanmaken van rekeningen in GnuCash for Android toe</string>
     <string name="label_permission_group">Uw GnuCash data</string>
     <string name="description_permission_group">GnuCash data lezen en bewerken</string>
     <string name="label_permission_record_transaction">Transacties bewaren</string>
-    <string name="label_permission_create_account">Dagboeken aanmaken</string>
-    <string name="label_display_account">Dagboek tonen</string>
-    <string name="btn_create_accounts">Dagboeken aanmaken</string>
-    <string name="title_default_accounts">Aan te maken dagboeken selecteren</string>
+    <string name="label_permission_create_account">Rekeningen aanmaken</string>
+    <string name="label_display_account">Rekening tonen</string>
+    <string name="btn_create_accounts">Rekeningen aanmaken</string>
+    <string name="title_default_accounts">Aan te maken rekeningen selecteren</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -266,7 +266,7 @@
 	    <item>Eigen Vermogen</item>
 	    <item>Passiva</item>
 	</string-array>
-	<string name="error_no_accounts">Geen dagboeken beschikbaar.\nU moet een dagboek aanmaken alvorens een widget toe te voegen</string>
+	<string name="error_no_accounts">Geen rekeningen beschikbaar.\nU moet een rekening aanmaken alvorens een widget toe te voegen</string>
 	<string name="title_build_version">Versie</string>
 	<string name="title_license">License</string>
 	<string name="summary_licence_details">Apache License v2.0. Klik voor details</string>
@@ -276,7 +276,7 @@
 	<string name="title_about_gnucash">Over GnuCash</string>
 	<string name="summary_about_gnucash">GnucashMobile is een mobiele uitgavebeheerstoepassing voor Android.\nHet laat onderweg een snelle en flexibele registratie van uitgaven toe, die als OFX gegevens ge&#235;xporteerd kunnen worden om in de GnuCash-toepassing op een desktop-computer te importeren.</string>
 	<string name="title_about">Over</string>
-	<string name="toast_error_exporting">Fout bij het schrijven van de OFX data naar bestand :\n</string>
+	<string name="toast_error_exporting">Fout bij het schrijven van de OFX data naar bestand:\n</string>
 	<string name="toast_ofx_exported_to">OFX data ge&#235;exporteerd naar:\n</string>
 	<string name="title_export_email">GnuCash OFX export</string>
 	<string name="description_export_email">GnuCash OFX Export van </string>
@@ -284,10 +284,10 @@
 	<string name="title_transaction_preferences">Transactie voorkeuren</string>
 	<string name="title_account_preferences">Account voorkeuren</string>
 	<string name="title_default_transaction_type">Standaard Transactietype</string>
-	<string name="summary_default_transaction_type">Het standaard transactietype, CREDIT or DEBIT</string>
+	<string name="summary_default_transaction_type">Het standaard transactietype, CREDIT or DEBET</string>
 	<string-array name="transaction_types">
 		<item>CREDIT</item>
-		<item>DEBIT</item>
+		<item>DEBET</item>
 	</string-array>
 	<string name="msg_delete_all_transactions_confirmation">Weet u zeker dat u alle transacties wil verwijderen?</string>
 	<string name="msg_delete_transaction_confirmation">Weet u zeker dat u deze transactie wil verwijderen?</string>
@@ -298,12 +298,12 @@
 	<string name="summary_default_export_email">Het standaard emailaddress om gexporteerde data heen te sturen. U kan dit emailadres nog wijzigen als u exporteerd.</string>	
 	<string name="label_double_entry_account">Draag Account over</string>
 	<string name="summary_use_double_entry">Alle transacties zullen worden overgedragen van het ene account naar de andere</string>
-	<string name="title_use_double_entry">Schake Double Entry in</string>
+	<string name="title_use_double_entry">Schakel dubbel boekhouden in</string>
 	<string name="account_balance">Saldo</string>
 	<string name="toast_no_account_name_entered">Vul een accountnaam in</string>
 	<string name="label_account_currency">Munteenheid</string>
-	<string name="label_parent_account">Parent account</string>
-	<string name="title_xml_ofx_header">Gebruik XML OFX header</string>
+	<string name="label_parent_account">Hoofdrekening</string>
+	<string name="title_xml_ofx_header">Gebruik XML OFX hoofding</string>
 	<string name="summary_xml_ofx_header">Schakel deze optie in als u naar een applicatie anders dan GnuCash wil exporteren</string>
 	<string name="title_whats_new">Nieuw sinds de vorige versie</string>
 	<string name="whats_new">
@@ -318,45 +318,45 @@
 	</string>
 	<string name="label_dismiss">Wijs af</string>
     <string name="toast_transanction_amount_required">Vul een bedrag in om de transactie op te slaan.</string>
-    <string name="menu_import_accounts">Import GnuCash Accounts</string>
-    <string name="btn_import_accounts">Import Accounts</string>
-    <string name="toast_error_importing_accounts">An error occurred while importing the GnuCash accounts</string>
-    <string name="toast_success_importing_accounts">GnuCash accounts successfully imported</string>
-    <string name="summary_import_accounts">Import account structure exported from GnuCash desktop</string>
-    <string name="title_import_accounts">Import GnuCash accounts</string>
-    <string name="summary_delete_all_accounts">Delete all accounts in the database. All transactions will be deleted as
-        well.
+    <string name="menu_import_accounts">GnuCash rekeningen importeren</string>
+    <string name="btn_import_accounts">Rekeningen importeren</string>
+    <string name="toast_error_importing_accounts">Fout bij het importeren van de GnuCash rekeningen</string>
+    <string name="toast_success_importing_accounts">GnuCash rekeningen met succes gemporteerd</string>
+    <string name="summary_import_accounts">Rekeningstructuur uit desktop-GnuCash importeren</string>
+    <string name="title_import_accounts">GnuCash rekeningen importeren</string>
+    <string name="summary_delete_all_accounts">Alle rekeningen uit de database verwijderen. Alle transacties zullen ook
+        verwijderd worden.
     </string>
-    <string name="title_delete_all_accounts">Delete all accounts</string>
-    <string name="header_account_settings">Accounts</string>
-    <string name="toast_all_accounts_deleted">All accounts have been successfully deleted</string>
-    <string name="confirm_delete_all_accounts">Are you sure you want to delete all accounts and transactions? \nThis
-        operation cannot be undone!
+    <string name="title_delete_all_accounts">Alle rekeningen verwijderen</string>
+    <string name="header_account_settings">Rekeningen</string>
+    <string name="toast_all_accounts_deleted">Alle rekeningen werden met succes verwijderd</string>
+    <string name="confirm_delete_all_accounts">Weet je zeker dat je alle rekeningen en transacties wil verwijderen? \nDeze
+        verrichting kan niet ongedaan gemaakt worden!
     </string>
-    <string name="label_account_type">Account Type</string>
-    <string name="summary_delete_all_transactions">All transactions in all accounts will be deleted!</string>
-    <string name="title_delete_all_transactions">Delete all transactions</string>
-    <string name="toast_all_transactions_deleted">All transactions successfully deleted!</string>
-    <string name="title_progress_importing_accounts">Importing accounts</string>
-    <string name="toast_tap_again_to_confirm_delete">Tap again to confirm. ALL entries will be deleted!!</string>
-    <string name="section_header_transactions">Transactions</string>
-    <string name="section_header_subaccounts">Sub-Accounts</string>
-    <string name="menu_search_accounts">Search</string>
-    <string name="title_default_export_format">Default Export Format</string>
-    <string name="summary_default_export_format">File format to use by default when exporting transactions</string>
-    <string name="menu_export_transactions">Export transactions</string>
-    <string name="label_recurring_transaction">Recurrence</string>
+    <string name="label_account_type">Rekening Type</string>
+    <string name="summary_delete_all_transactions">Alle transacties in alle rekeningen zullen verwijderd worden!</string>
+    <string name="title_delete_all_transactions">Alle transacties verwijderen</string>
+    <string name="toast_all_transactions_deleted">Alle transacties werden met succes verwijderd!</string>
+    <string name="title_progress_importing_accounts">Rekeningen importeren</string>
+    <string name="toast_tap_again_to_confirm_delete">Tap opnieuw op te bevestigen. ALLE regels zullen verwijderd worden!!</string>
+    <string name="section_header_transactions">Transacties</string>
+    <string name="section_header_subaccounts">Subrekeningen</string>
+    <string name="menu_search_accounts">Zoeken</string>
+    <string name="title_default_export_format">Standaard Export Formaat</string>
+    <string name="summary_default_export_format">Bestandsformaat om standaard te gebruiken bij het experteren van transacties</string>
+    <string name="menu_export_transactions">Transacties exporteren</string>
+    <string name="label_recurring_transaction">Herhaling</string>
     <!-- This should be the same name used by GnuCash desktop for imbalance accounts -->
     <string name="imbalance_account_name">Imbalance</string>
-    <string name="title_progress_exporting_transactions">Exporting transactions</string>
-    <string name="label_no_recurring_transactions">No recurring transactions to display.</string>
-    <string name="toast_recurring_transaction_deleted">Successfully deleted recurring transaction</string>
-    <string name="label_placeholder_account">Placeholder account</string>
-    <string name="label_default_transfer_account">Default Transfer Account</string>
-    <string name="label_account_color_and_type">Account Color &amp; Type</string>
+    <string name="title_progress_exporting_transactions">Transactions exporteren</string>
+    <string name="label_no_recurring_transactions">Geen repetitieve transacties gevonden.</string>
+    <string name="toast_recurring_transaction_deleted">Repetitieve transactie met succes verwijderd</string>
+    <string name="label_placeholder_account">Aggregatie rekening</string>
+    <string name="label_default_transfer_account">Standard tegenrekening</string>
+    <string name="label_account_color_and_type">Rekening kleur &amp; type</string>
     <plurals name="label_sub_accounts">
-        <item quantity="one">%d sub-account</item>
-        <item quantity="other">%d sub-accounts</item>
+        <item quantity="one">%d subrekening</item>
+        <item quantity="other">%d subrekeningen</item>
     </plurals>
     <string-array name="account_type_entry_values">
         <item>CASH</item>
@@ -378,19 +378,19 @@
         <item>OFX</item>
     </string-array>
     <!-- Default title for color picker dialog [CHAR LIMIT=30] -->
-    <string name="color_picker_default_title">Select a Color</string>
-    <string name="label_delete_sub_accounts">Delete sub-accounts</string>
+    <string name="color_picker_default_title">Kies een kleur</string>
+    <string name="label_delete_sub_accounts">Subrekeningen verwijderen</string>
     <string name="title_recent_accounts">Recent</string>
-    <string name="title_favorite_accounts">Favorites</string>
-    <string name="title_all_accounts">All</string>
-    <string name="summary_create_default_accounts">Creates default GnuCash commonly-used account structure</string>
-    <string name="title_create_default_accounts">Create default accounts</string>
-    <string name="msg_confirm_create_default_accounts_setting">New accounts will be created in addition to the existing
-        account structure.\n\nIf you wish to replace currently existing accounts, delete them first before proceeding!
+    <string name="title_favorite_accounts">Favorieten</string>
+    <string name="title_all_accounts">Alle</string>
+    <string name="summary_create_default_accounts">Creert standaard GnuCash veelgebruikte rekeningstructuur</string>
+    <string name="title_create_default_accounts">Standaard rekeningen creren</string>
+    <string name="msg_confirm_create_default_accounts_setting">Nieuwe rekeningen zullen toegevoegd worden aan de bestaande
+        rekeningstructuur.\n\nAls je de bestaande rekeningen wil vervangen, verwijder ze dan eerst voor verder te gaan!
     </string>
-    <string name="msg_confirm_create_default_accounts_first_run">Welcome to GnuCash Android! \nYou can either create
-        a hierarchy of commonly-used accounts, or import your own GnuCash account structure. \n\nBoth options are also
-        available in app Settings so you can decide later.
+    <string name="msg_confirm_create_default_accounts_first_run">Welkom in GnuCash Android! \nJe kan een nieuwe structuur van
+        veel gebruikte rekeningen creren, of je eigen GnuCash rekeningstructuur importeren. \n\nBeide opties zijn ook
+        beschikbaar in app Instellingen zodat je later kan beslissen.
     </string>
     <string-array name="recurrence_period_strings">
         <item>GEEN</item>
@@ -398,6 +398,6 @@
         <item>WEKELIJKSE</item>
         <item>MAANDELIJKS</item>
     </string-array>
-    <string name="menu_scheduled_transactions">Scheduled Transactions</string>
-    <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="menu_scheduled_transactions">Vaste journaalposten</string>
+    <string name="title_scheduled_transactions">Vaste journaalposten</string>
 </resources>

From 218e837e9239bec1dbfc485189da43e3ff0629e4 Mon Sep 17 00:00:00 2001
From: jesseshieh <jesse.shieh.pub@gmail.com>
Date: Wed, 5 Mar 2014 11:54:33 -0800
Subject: [PATCH 02/16] In double-entry accounting, all transactions should
 have a double-entry. If the transaction is a credit, then the double-entry is
 a debit and vice versa. Also, the transaction amount is positive or negative
 depending on if the account the transaction is in is a debit account or a
 credit account. Example: If you create a salary transaction in the income
 account, that should be a credit which is a positive number. If the
 double-entry account is the checking account, that is a debit account so it's
 entry should also be a positive number.

---
 app/src/org/gnucash/android/db/AccountsDbAdapter.java   |  2 +-
 .../org/gnucash/android/db/TransactionsDbAdapter.java   |  9 +++++++--
 app/src/org/gnucash/android/model/Account.java          | 17 +++++++++++++++--
 app/src/org/gnucash/android/model/Transaction.java      | 17 ++++++++++++++++-
 4 files changed, 39 insertions(+), 6 deletions(-)

diff --git a/app/src/org/gnucash/android/db/AccountsDbAdapter.java b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
index d99fd663..0e83043d 100644
--- a/app/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -526,7 +526,7 @@ public Money getAccountBalance(long accountId){
                 balance = balance.add(subBalance);
             }
         }
-        return balance.add(mTransactionsAdapter.getTransactionsSum(accountId));
+        return balance.add(getAccount(accountId).getBalance());
     }
 
     /**
diff --git a/app/src/org/gnucash/android/db/TransactionsDbAdapter.java b/app/src/org/gnucash/android/db/TransactionsDbAdapter.java
index f2c53047..5bfc881c 100644
--- a/app/src/org/gnucash/android/db/TransactionsDbAdapter.java
+++ b/app/src/org/gnucash/android/db/TransactionsDbAdapter.java
@@ -24,6 +24,7 @@
 import org.gnucash.android.model.Account;
 import org.gnucash.android.model.Money;
 import org.gnucash.android.model.Transaction;
+import org.gnucash.android.model.Transaction.TransactionType;
 
 import java.math.BigDecimal;
 import java.util.ArrayList;
@@ -179,9 +180,13 @@ public Cursor fetchAllTransactionsForAccount(long accountID){
 		while (c.moveToNext()) {
 			Transaction transaction = buildTransactionInstance(c);
 			String doubleEntryAccountUID = transaction.getDoubleEntryAccountUID();
-			//negate double entry transactions for the transfer account
+			// Negate double entry transactions for the transfer account
 			if (doubleEntryAccountUID != null && doubleEntryAccountUID.equals(accountUID)){
-				transaction.setAmount(transaction.getAmount().negate());
+				if (transaction.getType() == TransactionType.DEBIT) {
+					transaction.setType(TransactionType.CREDIT);
+				} else {
+					transaction.setType(TransactionType.DEBIT);
+				}
 			}
 			transactionsList.add(transaction);
 		}
diff --git a/app/src/org/gnucash/android/model/Account.java b/app/src/org/gnucash/android/model/Account.java
index f5c409ae..bb003df4 100644
--- a/app/src/org/gnucash/android/model/Account.java
+++ b/app/src/org/gnucash/android/model/Account.java
@@ -369,10 +369,23 @@ public boolean hasUnexportedTransactions(){
 	 * @return {@link Money} aggregate amount of all transactions in account.
 	 */
 	public Money getBalance(){
-		//TODO: Consider double entry transactions
 		Money balance = new Money(new BigDecimal(0), this.mCurrency);
 		for (Transaction transaction : mTransactionsList) {
-			balance = balance.add(transaction.getAmount());
+			boolean isDebitAccount = getAccountType().hasDebitNormalBalance();
+			boolean isDebitTransaction = transaction.getType() == TransactionType.DEBIT;
+			if (isDebitAccount) {
+				if (isDebitTransaction) {
+					balance = balance.add(transaction.getAmount());
+				} else {
+					balance = balance.subtract(transaction.getAmount());
+				}
+			} else {
+				if (isDebitTransaction) {
+					balance = balance.subtract(transaction.getAmount());
+				} else {
+					balance = balance.add(transaction.getAmount());
+				}
+			}
 		}
 		return balance;
 	}
diff --git a/app/src/org/gnucash/android/model/Transaction.java b/app/src/org/gnucash/android/model/Transaction.java
index 0456b75b..98a30b42 100644
--- a/app/src/org/gnucash/android/model/Transaction.java
+++ b/app/src/org/gnucash/android/model/Transaction.java
@@ -366,7 +366,22 @@ public String getDoubleEntryAccountUID() {
 	public void setDoubleEntryAccountUID(String doubleEntryAccountUID) {
 		this.mDoubleEntryAccountUID = doubleEntryAccountUID;
 	}
-	
+
+	/**
+	 * Returns type of this transaction
+	 * @return Type of this transaction
+	 */
+	public TransactionType getType() {
+		return mType;
+	}
+
+	/**
+	 * Sets the type of this transaction
+	 * @param Type of this transaction
+	 */
+	public void setType(TransactionType type) {
+		mType = type;
+	}
 
 	/**
 	 * Returns UID of account to which this transaction belongs

From 05d5d88f1e2b20877e6e6f20afe50b31cb203a9e Mon Sep 17 00:00:00 2001
From: Menelaos Maglis <mmaglis@metacom.gr>
Date: Sat, 22 Feb 2014 22:55:12 +0100
Subject: [PATCH 03/16] Greek translation update

---
 app/res/values-el/strings.xml | 66 +++++++++++++++++++++----------------------
 1 file changed, 33 insertions(+), 33 deletions(-)

diff --git a/app/res/values-el/strings.xml b/app/res/values-el/strings.xml
index 8c415781..cf8f8295 100644
--- a/app/res/values-el/strings.xml
+++ b/app/res/values-el/strings.xml
@@ -351,23 +351,23 @@
     <string name="title_delete_all_transactions">   </string>
     <string name="toast_all_transactions_deleted">   
 	 !</string>
-    <string name="title_progress_importing_accounts">Importing accounts</string>
-    <string name="toast_tap_again_to_confirm_delete">Tap again to confirm. ALL entries will be deleted!!</string>
-    <string name="section_header_transactions">Transactions</string>
-    <string name="section_header_subaccounts">Sub-Accounts</string>
-    <string name="menu_search_accounts">Search</string>
-    <string name="title_default_export_format">Default Export Format</string>
-    <string name="summary_default_export_format">File format to use by default when exporting transactions</string>
-    <string name="menu_export_transactions">Export transactions</string>
-    <string name="label_recurring_transaction">Recurrence</string>
+    <string name="title_progress_importing_accounts"> </string>
+    <string name="toast_tap_again_to_confirm_delete">   .     !!</string>
+    <string name="section_header_transactions"></string>
+    <string name="section_header_subaccounts">-</string>
+    <string name="menu_search_accounts"></string>
+    <string name="title_default_export_format">  </string>
+    <string name="summary_default_export_format">        .</string>
+    <string name="menu_export_transactions"> </string>
+    <string name="label_recurring_transaction"></string>
     <!-- This should be the same name used by GnuCash desktop for imbalance accounts -->
     <string name="imbalance_account_name">Imbalance</string>
-    <string name="title_progress_exporting_transactions">Exporting transactions</string>
-    <string name="label_no_recurring_transactions">No recurring transactions to display.</string>
-    <string name="toast_recurring_transaction_deleted">Successfully deleted recurring transaction</string>
-    <string name="label_placeholder_account">Placeholder account</string>
-    <string name="label_default_transfer_account">Default Transfer Account</string>
-    <string name="label_account_color_and_type">Account Color &amp; Type</string>
+    <string name="title_progress_exporting_transactions"> </string>
+    <string name="label_no_recurring_transactions">     .</string>
+    <string name="toast_recurring_transaction_deleted">   </string>
+    <string name="label_placeholder_account">  </string>
+    <string name="label_default_transfer_account">  </string>
+    <string name="label_account_color_and_type">  &amp; </string>
     <plurals name="label_sub_accounts">
         <item quantity="one">%d -</item>
         <item quantity="other">%d -</item>
@@ -392,26 +392,26 @@
         <item>OFX</item>
     </string-array>
     <!-- Default title for color picker dialog [CHAR LIMIT=30] -->
-    <string name="color_picker_default_title">Select a Color</string>
-    <string name="label_delete_sub_accounts">Delete sub-accounts</string>
-    <string name="title_recent_accounts">Recent</string>
-    <string name="title_favorite_accounts">Favorites</string>
-    <string name="title_all_accounts">All</string>
-    <string name="summary_create_default_accounts">Creates default GnuCash commonly-used account structure</string>
-    <string name="title_create_default_accounts">Create default accounts</string>
-    <string name="msg_confirm_create_default_accounts_setting">New accounts will be created in addition to the existing
-        account structure.\n\nIf you wish to replace currently existing accounts, delete them first before proceeding!
+    <string name="color_picker_default_title"> </string>
+    <string name="label_delete_sub_accounts"> -</string>
+    <string name="title_recent_accounts"></string>
+    <string name="title_favorite_accounts"></string>
+    <string name="title_all_accounts"></string>
+    <string name="summary_create_default_accounts">      GnuCash</string>
+    <string name="title_create_default_accounts">  </string>
+    <string name="msg_confirm_create_default_accounts_setting">      
+         .\n\n     ,    !
     </string>
-    <string name="menu_scheduled_transactions">Scheduled Transactions</string>
-    <string name="msg_confirm_create_default_accounts_first_run">Welcome to GnuCash Android! \nYou can either create
-        a hierarchy of commonly-used accounts, or import your own GnuCash account structure. \n\nBoth options are also
-        available in app Settings so you can decide later.
+    <string name="menu_scheduled_transactions"> </string>
+    <string name="msg_confirm_create_default_accounts_first_run">GnuCash Android.  ! \n   
+           ,         GnuCash. \n\n     
+             '     .
     </string>
     <string-array name="recurrence_period_strings">
-        <item>NONE</item>
-        <item>DAILY</item>
-        <item>WEEKLY</item>
-        <item>MONTHLY</item>
+        <item></item>
+        <item></item>
+        <item></item>
+        <item></item>
     </string-array>
-    <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_scheduled_transactions"> </string>
 </resources>

From 054954c87c33238077f0d967f5c57ce37c7d96e2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Stephan=20Windm=C3=BCller?= <windy@white-hawk.de>
Date: Thu, 13 Mar 2014 11:30:38 +0100
Subject: [PATCH 04/16] Improved German translation

---
 app/res/values-de/strings.xml | 83 +++++++++++++++++++++----------------------
 1 file changed, 40 insertions(+), 43 deletions(-)

diff --git a/app/res/values-de/strings.xml b/app/res/values-de/strings.xml
index d73bab8d..a03ac04f 100644
--- a/app/res/values-de/strings.xml
+++ b/app/res/values-de/strings.xml
@@ -49,12 +49,12 @@
     <string name="title_selected">%1$d ausgew&#228;hlt</string>
     <string name="label_transactions_total">Summe:</string>
     <string name="label_export_destination">Exportziel</string>
-    <string name="title_export_dialog">Buchungen Exportieren</string>
+    <string name="title_export_dialog">Buchungen exportieren</string>
     <string name="option_export_all_transactions">Alle Buchungen exportieren</string>
     <string name="hint_export_choice">Auswhlen, um alle Buchungen zu exportieren. Andernfalls werden nur die neuen Buchungen seit letztem Export exportiert.</string>
     <string name="error_exporting">Fehler beim Exportieren der OFX-Datei</string>    
     <string name="btn_export">Export</string>
-    <string name="option_delete_after_export">L&#246;schen nach dem exportieren</string>
+    <string name="option_delete_after_export">L&#246;schen nach dem Exportieren</string>
     <string name="hint_delete_after_export">Alle exportierten Buchungen werden nach dem Export gelscht.</string>
     <string name="title_settings">Einstellungen</string>
     <string-array name="export_destinations">
@@ -69,16 +69,16 @@
     <string name="toast_incompatible_currency">Buchungen k&#246;nnten nicht verschoben werden.\Die W&#228;hrung des Zielkontos ist inkompatibel</string>
     <string name="header_general_settings">Allgemein</string>
     <string name="header_about_gnucash">&#220;ber Gnucash</string>
-    <string name="title_choose_currency">Standard W&#228;hrung ausw&#228;hlen</string>
-    <string name="title_default_currency">Standard W&#228;hrung</string>
-    <string name="summary_default_currency">Standard W&#228;hrung f&#252;r neuen Konten</string>
+    <string name="title_choose_currency">Standardw&#228;hrung ausw&#228;hlen</string>
+    <string name="title_default_currency">Standardw&#228;hrung</string>
+    <string name="summary_default_currency">Standardw&#228;hrung f&#252;r neuen Konten</string>
     <string name="label_permission_record_transactions">Erm&#246;glicht das Speichern von Buchungen in Gnucash</string>
     <string name="label_permission_create_accounts">Erm&#246;glicht das Erstellen von Konten in Gnucash</string>
-    <string name="label_permission_group">Ihre Gnucash Daten</string>
-    <string name="description_permission_group">Lesen und Bearbeiten von Gnucash Daten</string>
+    <string name="label_permission_group">Ihre Gnucash-Daten</string>
+    <string name="description_permission_group">Lesen und Bearbeiten von Gnucash-Daten</string>
     <string name="label_permission_record_transaction">Buchungen speichern</string>
     <string name="label_permission_create_account">Konten erstellen</string>
-    <string name="label_display_account">Konto Anzeigen</string>
+    <string name="label_display_account">Konto anzeigen</string>
     <string name="btn_create_accounts">Konten erstellen</string>
     <string name="title_default_accounts">Zu erstellende Konten ausw&#228;hlen</string>
     <string-array name="currency_names">
@@ -271,7 +271,7 @@
 	<string name="summary_licence_details">Apache License v2.0. Klicken f&#252;r Details</string>
 	<string name="title_general_prefs">Allgemein</string>
 	<string name="label_widget_configuration">Konto ausw&#228;hlen</string>
-	<string name="toast_no_transactions_to_export">Keine Buchungen zum exportieren</string>
+	<string name="toast_no_transactions_to_export">Keine Buchungen zum Exportieren</string>
 	<string name="title_about_gnucash">&#220;ber Gnucash</string>
 	<string name="summary_about_gnucash">GnucashMobile ist eine mobile Datenaufzeichungs-App f&#252;r Android. \nEs erm&#246;glicht die schnelle und flexible Registrierung von Zahlungsvorg&#228;ngen unterwegs, die dann als Datei im OFX-Format exportiert und von der GnuCash-Anwendung an einem Desktop-PC importiert werden k&#246;nnen.</string>
 	<string name="title_about">&#220;ber</string>
@@ -279,7 +279,7 @@
 	<string name="toast_error_exporting_ofx">Fehler beim Exportieren der OFX-Datei:\n</string>
 	<string name="toast_ofx_exported_to">OFX-Datei erfolgreich exportiert nach:\n</string>
 	<string name="title_export_email">Gnucash exportierte OFX-Datei</string>
-	<string name="description_export_email">Gnucash accounts export from </string>
+	<string name="description_export_email">Gnucash-Konten-Export von </string>
 	<string name="header_transaction_settings">Buchungen</string>
 	<string name="title_transaction_preferences">Einstellungen Buchungen</string>
 	<string name="title_account_preferences">Einstellungen Konten</string>
@@ -295,16 +295,16 @@
 	<string name="title_export_all_transactions">Alle Buchungen exportieren</string>
 	<string name="title_always_delete_exported_transactions">Alle exportierten Buchungen l&#246;schen</string>
 	<string name="title_default_export_email">Standard Export E-mail</string>
-	<string name="summary_default_export_email">Die Standard Email an die exportierte OFX Dateien geschickt werden. Sie knnen diese immer noch beim exportieren ndern</string>
+	<string name="summary_default_export_email">Die Standard-E-Mail, an die exportierte OFX Dateien geschickt werden. Sie knnen diese immer noch beim Exportieren ndern.</string>
 	<string name="label_double_entry_account">berweisungskonto</string>
 	<string name="summary_use_double_entry">Alle Buchungen stellen eine berweisung von einem Konto zu einem anderen dar</string>
 	<string name="title_use_double_entry">Doppelte Buchfhrung aktivieren</string>
 	<string name="account_balance">Kontostand</string>
-	<string name="toast_no_account_name_entered">Geben Sie einen Kontonamen ein um das Konto zu erstellen</string>
+	<string name="toast_no_account_name_entered">Geben Sie einen Kontonamen ein, um das Konto zu erstellen</string>
 	<string name="label_account_currency">Whrung</string>
 	<string name="label_parent_account">Hauptkonto</string>
-	<string name="title_xml_ofx_header">XML OFX header verwenden</string>
-	<string name="summary_xml_ofx_header">Dieses Option aktivieren wenn Sie die OFX Dateien fr ein anderes Programm als GnuCash auf dem Desktop exportieren</string>
+	<string name="title_xml_ofx_header">XML-OFX-Header verwenden</string>
+	<string name="summary_xml_ofx_header">Diese Option aktivieren, wenn Sie die OFX-Dateien fr ein anderes Programm als GnuCash auf dem Desktop exportieren</string>
 	<string name="title_whats_new">Neuigkeiten in dieser Version</string>
 	<string name="whats_new">
         - Mark favorite accounts and quickly access them\n
@@ -317,13 +317,13 @@
         - Numerous bug fixes and improvements\n
     </string>
 	<string name="label_dismiss">Schlieen</string>
-    <string name="toast_transanction_amount_required">Geben Sie einen Betrag ein um die Buchung speichern zu knnen</string>
-    <string name="menu_import_accounts">GnuCash Konten importieren</string>
+    <string name="toast_transanction_amount_required">Geben Sie einen Betrag ein, um die Buchung speichern zu knnen</string>
+    <string name="menu_import_accounts">GnuCash-Konten importieren</string>
     <string name="btn_import_accounts">Konten importieren</string>
-    <string name="toast_error_importing_accounts">Beim importieren von den GnuCash Konten ist einen Fehler aufgetreten!</string>
-    <string name="toast_success_importing_accounts">GnuCash Konten wurden erfolgreich importiert</string>
-    <string name="summary_import_accounts">Import account structure exported from GnuCash desktop</string>
-    <string name="title_import_accounts">GnuCash Konten importieren</string>
+    <string name="toast_error_importing_accounts">Beim Importieren der GnuCash-Konten ist ein Fehler aufgetreten!</string>
+    <string name="toast_success_importing_accounts">GnuCash-Konten wurden erfolgreich importiert</string>
+    <string name="summary_import_accounts">Importiere Kontenstruktur, welche von der Desktop-Version von GnuCash exportiert wurde</string>
+    <string name="title_import_accounts">GnuCash-Konten importieren</string>
     <string name="summary_delete_all_accounts">Alle Konten lschen. Alle Buchungen werden ebenfalls gelscht!</string>
     <string name="title_delete_all_accounts">Alle Konten lschen</string>
     <string name="header_account_settings">Konten</string>
@@ -332,16 +332,16 @@
         \n\nDiese Operation kann nicht rckgngig gemacht werden!
     </string>
     <string name="label_account_type">Kontoart</string>
-    <string name="summary_delete_all_transactions">Alle Buchungen in alle Konten werden gelscht</string>
+    <string name="summary_delete_all_transactions">Alle Buchungen in allen Konten werden gelscht</string>
     <string name="title_delete_all_transactions">Alle Buchungen lschen</string>
     <string name="toast_all_transactions_deleted">Alle Buchungen wurden erfolgreich gelscht</string>
     <string name="title_progress_importing_accounts">Konten werden importiert</string>
-    <string name="toast_tap_again_to_confirm_delete">Tap again to confirm. ALL entries will be deleted!!</string>
+    <string name="toast_tap_again_to_confirm_delete">Erneut Tippen zum Besttigen. ALLE Eintrge werden gelscht!</string>
     <string name="section_header_transactions">Buchungen</string>
     <string name="section_header_subaccounts">Unterkonten</string>
     <string name="menu_search_accounts">Suchen</string>
-    <string name="title_default_export_format">Standard Export Format</string>
-    <string name="summary_default_export_format">File format to use by default when exporting transactions</string>
+    <string name="title_default_export_format">Standard-Export-Format</string>
+    <string name="summary_default_export_format">Dateiformat, welches standardmig verwendet wird, wenn Buchungen exportiert werden</string>
     <string name="menu_export_transactions">Buchungen exportieren</string>
     <string name="label_recurring_transaction">Wiederkehr</string>
     <!-- This should be the same name used by GnuCash desktop for imbalance accounts -->
@@ -357,19 +357,19 @@
         <item quantity="other">%d Unterkonten</item>
     </plurals>
     <string-array name="account_type_entry_values">
-        <item>CASH</item>
+        <item>BARGELD</item>
         <item>BANK</item>
-        <item>CREDIT CARD</item>
-        <item>ASSET</item>
-        <item>LIABILITY</item>
-        <item>INCOME</item>
-        <item>EXPENSE</item>
+        <item>KREDITKARTE</item>
+        <item>AKTIVA</item>
+        <item>PASSIVA</item>
+        <item>EINKOMMEN</item>
+        <item>AUFWENDUNGEN</item>
         <item>PAYABLE</item>
-        <item>RECEIVABLE</item>
-        <item>EQUITY</item>
-        <item>CURRENCY</item>
-        <item>STOCK</item>
-        <item>MUTUAL FUND</item>
+        <item>FORDERUNGEN</item>
+        <item>EIGENKAPITAL</item>
+        <item>WHRUNG</item>
+        <item>AKTIENKONTO</item>
+        <item>INVESTMENTFONDS</item>
     </string-array>
     <string-array name="export_formats">
         <item>QIF</item>
@@ -381,15 +381,12 @@
     <string name="title_recent_accounts">Krzlich</string>
     <string name="title_favorite_accounts">Favoriten</string>
     <string name="title_all_accounts">Alle</string>
-    <string name="summary_create_default_accounts">Erstellt die hufig verwendete standard GnuCash Konten</string>
-    <string name="title_create_default_accounts">Standard Konten erstellen</string>
-    <string name="msg_confirm_create_default_accounts_setting">New accounts will be created in addition to the existing
-        account structure.\n\nIf you wish to replace currently existing accounts, delete them first before proceeding!
+    <string name="summary_create_default_accounts">Erstellt die hufig verwendeten Standard-GnuCash-Konten</string>
+    <string name="title_create_default_accounts">Standard-Konten erstellen</string>
+    <string name="msg_confirm_create_default_accounts_setting">Neue Konten werden zustzlich zur existierenden Kontenstruktur erstellt.\n\nWenn Sie die derzeitig existierenden Konten ersetzen wollen, lschen Sie diese bitte, bevor Sie fortfahren!
     </string>
     <string name="menu_scheduled_transactions">Eingeplante Buchungen</string>
-    <string name="msg_confirm_create_default_accounts_first_run">Welcome to GnuCash Android! \nYou can either create
-        a hierarchy of commonly-used accounts, or import your own GnuCash account structure. \n\nBoth options are also
-        available in app Settings so you can decide later.
+    <string name="msg_confirm_create_default_accounts_first_run">Willkommen bei GnuCash Android!\nSie knnen entweder eine Hierarchie der fr gewhnlich verwendeten Konten erstellen oder Ihre eigene GnuCash-Kontenstruktur importieren\n\nBeide Optionen sind auch in den Einstellungen verfgbar, sodass Sie dies spter entscheiden knnen.
     </string>
     <string-array name="recurrence_values">
         <item>KEINE</item>
@@ -398,4 +395,4 @@
         <item>MONATLICH</item>
     </string-array>
     <string name="title_scheduled_transactions">Eingeplante Buchungen</string>
-</resources>
\ No newline at end of file
+</resources>

From 80de0325dbd48878731d9f8d67eb0069afb5eefb Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 21 Mar 2014 00:35:08 +0100
Subject: [PATCH 05/16] - Fixed: Editing account modifies the transaction type
 of transfer transactions - fixes #145 - Fixed: Bug causing double entry
 transactions not to be considered equal - Fixed: Computation of account
 balance did not properly consider double entries - Improved: Double entry
 accounting is now activated by default - Improved: Restricted parent/child
 account hierarchies relationships to those defined by GnuCash accounting
 (see: http://code.gnucash.org/docs/C/gnucash-help/acct-types.html ) Some code
 refactoring

---
 CHANGELOG.md                                       |  10 +
 app/AndroidManifest.xml                            |   2 +-
 app/pom.xml                                        |   2 +-
 app/res/values-el/strings.xml                      |   2 +-
 app/res/values/strings.xml                         |   2 +-
 app/res/xml/fragment_account_preferences.xml       |   3 +-
 app/res/xml/fragment_transaction_preferences.xml   |   1 +
 .../org/gnucash/android/db/AccountsDbAdapter.java  |  40 ++--
 app/src/org/gnucash/android/model/Account.java     |   4 +-
 app/src/org/gnucash/android/model/Transaction.java |   9 +-
 .../android/ui/account/AccountFormFragment.java    | 216 +++++++++++++++------
 .../android/ui/account/AccountsActivity.java       |  26 +--
 .../android/ui/account/AccountsListFragment.java   |   5 +-
 .../ui/transaction/TransactionFormFragment.java    |   4 +-
 integration-tests/pom.xml                          |   2 +-
 pom.xml                                            |   2 +-
 16 files changed, 233 insertions(+), 97 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index f152f304..a2850321 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,5 +1,15 @@
 Change Log
 ===============================================================================
+Version 1.3.2 *(2014-03-28)*
+----------------------------
+* Fixed: Editing account modifies the transaction type of transfer transactions
+* Fixed: Bug causing double entry transactions not to be considered equal
+* Fixed: Computation of account balance did not properly consider double entries
+* Improved: Double-entry accounting is now activated by default
+* Improved: Restricted parent/child account hierarchies relationships to those defined by GnuCash accounting
+* Improved: Dutch translation
+* Improved: German translation
+
 Version 1.3.1 *(2014-02-14)*
 ----------------------------
 * Fixed: Crash when bulk moving transactions
diff --git a/app/AndroidManifest.xml b/app/AndroidManifest.xml
index 9df9d16a..5dbebd33 100644
--- a/app/AndroidManifest.xml
+++ b/app/AndroidManifest.xml
@@ -17,7 +17,7 @@
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="org.gnucash.android"
-    android:versionCode="26"
+    android:versionCode="27"
     android:versionName="@string/app_version_name" >
 
     <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15"/>
diff --git a/app/pom.xml b/app/pom.xml
index d52dd205..18da0ae5 100644
--- a/app/pom.xml
+++ b/app/pom.xml
@@ -22,7 +22,7 @@
     <description>Gnucash Android companion application</description>
 
     <parent>
-        <version>1.3.0-SNAPSHOT</version>
+        <version>1.3.2-SNAPSHOT</version>
         <groupId>org.gnucash.android</groupId>
         <artifactId>gnucash-android-parent</artifactId>
     </parent>
diff --git a/app/res/values-el/strings.xml b/app/res/values-el/strings.xml
index cf8f8295..f08e2dea 100644
--- a/app/res/values-el/strings.xml
+++ b/app/res/values-el/strings.xml
@@ -405,7 +405,7 @@
     <string name="menu_scheduled_transactions"> </string>
     <string name="msg_confirm_create_default_accounts_first_run">GnuCash Android.  ! \n   
            ,         GnuCash. \n\n     
-             '     .
+             \'     .
     </string>
     <string-array name="recurrence_period_strings">
         <item></item>
diff --git a/app/res/values/strings.xml b/app/res/values/strings.xml
index 57dc1fd8..43a8fbd7 100644
--- a/app/res/values/strings.xml
+++ b/app/res/values/strings.xml
@@ -17,7 +17,7 @@
 
 <resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="app_name">GnuCash</string>
-    <string name="app_version_name">1.3.1</string>
+    <string name="app_version_name">1.3.2</string>
     <string name="title_add_account">Create Account</string>
     <string name="title_edit_account">Edit Account</string>
     <string name="info_details">Info</string>
diff --git a/app/res/xml/fragment_account_preferences.xml b/app/res/xml/fragment_account_preferences.xml
index 6272ebb2..d74b59eb 100644
--- a/app/res/xml/fragment_account_preferences.xml
+++ b/app/res/xml/fragment_account_preferences.xml
@@ -7,7 +7,8 @@
                     android:dialogTitle="@string/title_choose_currency"
                     android:title="@string/title_default_currency"
                     android:entries="@array/currency_names"
-                    android:entryValues="@array/currency_codes"/>
+                    android:entryValues="@array/currency_codes"
+                    android:defaultValue="USD"/>
     <Preference android:key="@string/key_import_accounts"
                 android:summary="@string/summary_import_accounts"
                 android:title="@string/title_import_accounts" />
diff --git a/app/res/xml/fragment_transaction_preferences.xml b/app/res/xml/fragment_transaction_preferences.xml
index e1670ccd..f8c7f19b 100644
--- a/app/res/xml/fragment_transaction_preferences.xml
+++ b/app/res/xml/fragment_transaction_preferences.xml
@@ -23,6 +23,7 @@
                     android:summary="@string/summary_default_transaction_type"/>
     <CheckBoxPreference android:summary="@string/summary_use_double_entry"
                         android:key="@string/key_use_double_entry"
+                        android:defaultValue="true"
                         android:title="@string/title_use_double_entry"/>
     <Preference android:key="@string/key_delete_all_transactions"
                 android:summary="@string/summary_delete_all_transactions"
diff --git a/app/src/org/gnucash/android/db/AccountsDbAdapter.java b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
index 0e83043d..bb91f66c 100644
--- a/app/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -22,6 +22,7 @@
 import org.gnucash.android.model.Money;
 import org.gnucash.android.model.Account.AccountType;
 import org.gnucash.android.model.Transaction;
+import org.gnucash.android.model.Transaction.TransactionType;
 
 import android.content.ContentValues;
 import android.content.Context;
@@ -84,11 +85,8 @@ public long addAccount(Account account){
 		if ((rowId = getAccountID(account.getUID())) > 0){
 			//if account already exists, then just update
 			Log.d(TAG, "Updating existing account");
-			int rowsAffected = mDb.update(DatabaseHelper.ACCOUNTS_TABLE_NAME, contentValues,
+			mDb.update(DatabaseHelper.ACCOUNTS_TABLE_NAME, contentValues,
                     DatabaseHelper.KEY_ROW_ID + " = " + rowId, null);
-            if (rowsAffected == 1){
-                updateAccount(rowId, DatabaseHelper.KEY_FULL_NAME, getFullyQualifiedAccountName(rowId));
-            }
 		} else {
 			Log.d(TAG, "Adding new account to db");
 			rowId = mDb.insert(DatabaseHelper.ACCOUNTS_TABLE_NAME, null, contentValues);
@@ -99,7 +97,20 @@ public long addAccount(Account account){
             //update the fully qualified account name
             updateAccount(rowId, DatabaseHelper.KEY_FULL_NAME, getFullyQualifiedAccountName(rowId));
 			for (Transaction t : account.getTransactions()) {
-				mTransactionsAdapter.addTransaction(t);
+                //FIXME: This is a hack until actual splits are implemented
+                if (t.getDoubleEntryAccountUID().equals(account.getUID())){
+                    Transaction trx = new Transaction(t,false);
+//                    trx.setAmount(trx.getAmount().negate());
+                    if (trx.getType() == TransactionType.DEBIT) {
+                        trx.setType(TransactionType.CREDIT);
+                    } else {
+                        trx.setType(TransactionType.DEBIT);
+                    }
+
+                    mTransactionsAdapter.addTransaction(trx);
+                }
+                else
+				    mTransactionsAdapter.addTransaction(t);
 			}
 		}
 		return rowId;
@@ -147,7 +158,7 @@ public boolean destructiveDeleteAccount(long rowId){
 		//first remove all transactions for the account
 		Cursor c = mTransactionsAdapter.fetchAllTransactionsForAccount(rowId);
 		if (c == null)
-			return result; 
+			return false;
 		
 		while (c.moveToNext()){
 			long id = c.getLong(DatabaseAdapter.COLUMN_ROW_ID);
@@ -210,7 +221,7 @@ public boolean transactionPreservingDelete(long accountId, long accountReassignI
      */
     public boolean recursiveDestructiveDelete(long accountId){
         Log.d(TAG, "Delete account with rowId with its transactions and sub-accounts: " + accountId);
-        boolean result = true;
+        boolean result = false;
 
         List<Long> subAccountIds = getSubAccountIds(accountId);
         for (long subAccountId : subAccountIds) {
@@ -425,7 +436,7 @@ public String getName(long accountID) {
 		while (it.hasNext()){
 			Account account = it.next();
 			
-			if (account.hasUnexportedTransactions() == false)
+			if (!account.hasUnexportedTransactions())
 				it.remove();
 		}
 		return accountsList;
@@ -440,13 +451,12 @@ public String getName(long accountID) {
 	public Cursor fetchAllRecords(){
 		Log.v(TAG, "Fetching all accounts from db");
         String selection =  DatabaseHelper.KEY_TYPE + " != ?" ;
-		Cursor cursor = mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME,
+        return mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME,
                 null,
                 selection,
                 new String[]{AccountType.ROOT.name()},
                 null, null,
                 DatabaseHelper.KEY_NAME + " ASC");
-		return cursor;
 	}
 
     /**
@@ -489,10 +499,9 @@ public boolean deleteRecord(long rowId) {
 	 */
 	public Cursor fetchAccounts(String condition){
 		Log.v(TAG, "Fetching all accounts from db where " + condition);
-		Cursor cursor = mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME, 
-				null, condition, null, null, null, 
-				DatabaseHelper.KEY_NAME + " ASC");
-		return cursor;
+        return mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME,
+                null, condition, null, null, null,
+                DatabaseHelper.KEY_NAME + " ASC");
 	}
 
     /**
@@ -612,10 +621,9 @@ public Cursor fetchRecentAccounts(int numberOfRecents){
     public Cursor fetchFavoriteAccounts(){
         Log.v(TAG, "Fetching favorite accounts from db");
         String condition = DatabaseHelper.KEY_FAVORITE + " = 1";
-        Cursor cursor = mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME,
+        return mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME,
                 null, condition, null, null, null,
                 DatabaseHelper.KEY_NAME + " ASC");
-        return cursor;
     }
 
     /**
diff --git a/app/src/org/gnucash/android/model/Account.java b/app/src/org/gnucash/android/model/Account.java
index bb003df4..4a854cf4 100644
--- a/app/src/org/gnucash/android/model/Account.java
+++ b/app/src/org/gnucash/android/model/Account.java
@@ -51,7 +51,7 @@
         ^             anchor for start of string
         #             the literal #
         (             start of group
-        ?:            indicate a non-capturing group that doesn't generate backreferences
+        ?:            indicate a non-capturing group that doesn't generate back-references
         [0-9a-fA-F]   hexadecimal digit
         {3}           three times
         )             end of group
@@ -357,7 +357,7 @@ public int getTransactionCount(){
 	 */
 	public boolean hasUnexportedTransactions(){
 		for (Transaction transaction : mTransactionsList) {
-			if (transaction.isExported() == false)
+			if (!transaction.isExported())
 				return true;			
 		}
 		return false;
diff --git a/app/src/org/gnucash/android/model/Transaction.java b/app/src/org/gnucash/android/model/Transaction.java
index 98a30b42..68bbe725 100644
--- a/app/src/org/gnucash/android/model/Transaction.java
+++ b/app/src/org/gnucash/android/model/Transaction.java
@@ -169,10 +169,12 @@ public Transaction(Money amount, String name, TransactionType type){
     /**
      * Copy constructor.
      * Creates a new transaction object which is a clone of the parameter.
-     * <p><b>Note:</b> The unique ID of the transaction is not cloned, but a new one is generated.</p>
+     * <p><b>Note:</b> The unique ID of the transaction is not cloned if the parameter <code>generateNewUID</code>,
+     * is set to false. Otherwise, a new one is generated.</p>
      * @param transaction Transaction to be cloned
+     * @param generateNewUID Flag to determine if new UID should be assigned or not
      */
-    public Transaction(Transaction transaction){
+    public Transaction(Transaction transaction, boolean generateNewUID){
         initDefaults();
         setName(transaction.getName());
         setDescription(transaction.getDescription());
@@ -182,6 +184,9 @@ public Transaction(Transaction transaction){
         setDoubleEntryAccountUID(transaction.getDoubleEntryAccountUID());
         setExported(transaction.isExported());
         setTime(transaction.getTimeMillis());
+        if (!generateNewUID){
+            setUID(transaction.getUID());
+        }
     }
 
 	/**
diff --git a/app/src/org/gnucash/android/ui/account/AccountFormFragment.java b/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
index 3551a85c..f8a7aaee 100644
--- a/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
+++ b/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
@@ -16,50 +16,44 @@
 
 package org.gnucash.android.ui.account;
 
-import java.util.Arrays;
-import java.util.Currency;
-import java.util.List;
-
 import android.app.Activity;
+import android.content.Context;
 import android.content.Intent;
 import android.content.SharedPreferences;
 import android.content.res.Resources;
 import android.content.res.TypedArray;
+import android.database.Cursor;
 import android.graphics.Color;
+import android.os.Bundle;
 import android.preference.PreferenceManager;
 import android.support.v4.app.FragmentManager;
-import org.gnucash.android.R;
-import org.gnucash.android.model.Account;
-import org.gnucash.android.model.Money;
-import org.gnucash.android.db.AccountsDbAdapter;
-import org.gnucash.android.db.DatabaseHelper;
-import org.gnucash.android.ui.UxArgument;
-import org.gnucash.android.ui.colorpicker.ColorPickerDialog;
-import org.gnucash.android.ui.colorpicker.ColorPickerSwatch;
-import org.gnucash.android.ui.colorpicker.ColorSquare;
-
-import android.content.Context;
-import android.database.Cursor;
-import android.os.Bundle;
 import android.support.v4.widget.SimpleCursorAdapter;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
 import android.view.inputmethod.InputMethodManager;
-import android.widget.ArrayAdapter;
-import android.widget.CheckBox;
-import android.widget.CompoundButton;
+import android.widget.*;
 import android.widget.CompoundButton.OnCheckedChangeListener;
-import android.widget.EditText;
-import android.widget.Spinner;
-import android.widget.Toast;
-
 import com.actionbarsherlock.app.SherlockFragment;
 import com.actionbarsherlock.view.Menu;
 import com.actionbarsherlock.view.MenuInflater;
 import com.actionbarsherlock.view.MenuItem;
+import org.gnucash.android.R;
+import org.gnucash.android.db.AccountsDbAdapter;
+import org.gnucash.android.db.DatabaseHelper;
+import org.gnucash.android.model.Account;
+import org.gnucash.android.model.Money;
+import org.gnucash.android.ui.UxArgument;
+import org.gnucash.android.ui.colorpicker.ColorPickerDialog;
+import org.gnucash.android.ui.colorpicker.ColorPickerSwatch;
+import org.gnucash.android.ui.colorpicker.ColorSquare;
 import org.gnucash.android.util.QualifiedAccountNameCursorAdapter;
 
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Currency;
+import java.util.List;
+
 /**
  * Fragment used for creating and editing accounts
  * @author Ngewi Fet <ngewif@gmail.com>
@@ -97,7 +91,14 @@
 	 * This is used if we are editing an account instead of creating one
 	 */
 	private long mSelectedAccountId = 0;
-	
+
+    /**
+     * Database ID of the parent account
+     * This value is set to the parent account of the transaction being edited or
+     * the account in which a new sub-account is being created
+     */
+    private long mParentAccountId = -1;
+
 	/**
 	 * Reference to account object which will be created at end of dialog
 	 */
@@ -202,7 +203,7 @@ public void onCreate(Bundle savedInstanceState) {
         }
 
         SharedPreferences sharedPrefs = PreferenceManager.getDefaultSharedPreferences(getActivity());
-        mUseDoubleEntry = sharedPrefs.getBoolean(getString(R.string.key_use_double_entry), false);
+        mUseDoubleEntry = sharedPrefs.getBoolean(getString(R.string.key_use_double_entry), true);
 	}
 	
 	/**
@@ -218,6 +219,19 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container,
 		mNameEditText.requestFocus();
 
         mAccountTypeSpinner = (Spinner) view.findViewById(R.id.input_account_type_spinner);
+        mAccountTypeSpinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
+            @Override
+            public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) {
+                loadParentAccountList(getSelectedAccountType());
+                setParentAccountSelection(mParentAccountId);
+            }
+
+            @Override
+            public void onNothingSelected(AdapterView<?> adapterView) {
+                //nothing to see here, move along
+            }
+        });
+
         mPlaceholderCheckBox = (CheckBox) view.findViewById(R.id.checkbox_placeholder_account);
 
 		mParentAccountSpinner = (Spinner) view.findViewById(R.id.input_parent_account);
@@ -276,9 +290,8 @@ public void onActivityCreated(Bundle savedInstanceState) {
         }
 
         //need to load the cursor adapters for the spinners before initializing the views
-        loadParentAccountList();
         loadAccountTypesList();
-        loadDefaultTransferAccoutList();
+        loadDefaultTransferAccountList();
         setDefaultTransferAccountInputsVisible(mUseDoubleEntry);
 
         if (mAccount != null){
@@ -286,6 +299,8 @@ public void onActivityCreated(Bundle savedInstanceState) {
         } else {
             initializeViews();
         }
+
+
 	}
 
     /**
@@ -297,12 +312,14 @@ private void initializeViewsWithAccount(Account account){
         if (account == null)
             throw new IllegalArgumentException("Account cannot be null");
 
+        loadParentAccountList(account.getAccountType());
+        mParentAccountId = mAccountsDbAdapter.getAccountID(account.getParentUID());
+        setParentAccountSelection(mParentAccountId);
+
         String currencyCode = account.getCurrency().getCurrencyCode();
         setSelectedCurrency(currencyCode);
 
         mNameEditText.setText(account.getName());
-        long parentAccountId = mAccountsDbAdapter.getAccountID(account.getParentUID());
-        setParentAccountSelection(parentAccountId);
 
         if (mUseDoubleEntry) {
             long doubleDefaultAccountId = mAccountsDbAdapter.getAccountID(account.getDefaultTransferAccountUID());
@@ -321,19 +338,23 @@ private void initializeViewsWithAccount(Account account){
     private void initializeViews(){
         setSelectedCurrency(Money.DEFAULT_CURRENCY_CODE);
         mColorSquare.setBackgroundColor(Color.LTGRAY);
-        long parentAccountId = getArguments().getLong(UxArgument.PARENT_ACCOUNT_ID);
-        setParentAccountSelection(parentAccountId);
+        mParentAccountId = getArguments().getLong(UxArgument.PARENT_ACCOUNT_ID);
 
-        /* This snippet causes the child account to default to same color as parent. Not sure if we want that
 
-        if (parentAccountId > 0) {
-            //child accounts by default have same type as the parent
-            setAccountTypeSelection(mAccountsDbAdapter.getAccountType(parentAccountId));
-            String colorHex = mAccountsDbAdapter.getAccountColorCode(parentAccountId);
-            initializeColorSquarePreview(colorHex);
-            mSelectedColor = colorHex;
+        if (mParentAccountId > 0) {
+            Account.AccountType parentAccountType = mAccountsDbAdapter.getAccountType(mParentAccountId);
+            setAccountTypeSelection(parentAccountType);
+            loadParentAccountList(parentAccountType);
+            setParentAccountSelection(mParentAccountId);
+//            String colorHex = mAccountsDbAdapter.getAccountColorCode(parentAccountId);
+//            initializeColorSquarePreview(colorHex);
+//            mSelectedColor = colorHex;
         }
-        */
+
+        //this must be called after changing account type
+        //because changing account type reloads list of eligible parent accounts
+
+
     }
 
     /**
@@ -392,7 +413,14 @@ private void setParentAccountSelection(long parentAccountId){
 
         for (int pos = 0; pos < mParentAccountCursorAdapter.getCount(); pos++) {
             if (mParentAccountCursorAdapter.getItemId(pos) == parentAccountId){
-                mParentAccountSpinner.setSelection(pos);
+                final int position = pos;
+                mParentAccountSpinner.postDelayed(new Runnable() {
+                    @Override
+                    public void run() {
+                        mParentAccountSpinner.setSelection(position);
+                    }
+                }, 100);
+//                mParentAccountSpinner.setSelection(pos, true);
                 break;
             }
         }
@@ -477,7 +505,7 @@ public boolean onOptionsItemSelected(MenuItem item) {
     /**
      * Initializes the default transfer account spinner with eligible accounts
      */
-    private void loadDefaultTransferAccoutList(){
+    private void loadDefaultTransferAccountList(){
         String condition = DatabaseHelper.KEY_ROW_ID + " != " + mSelectedAccountId
                 + " AND " + DatabaseHelper.KEY_PLACEHOLDER + "=0"
                 + " AND " + DatabaseHelper.KEY_UID + " != '" + mAccountsDbAdapter.getGnuCashRootAccountUID() + "'";
@@ -493,23 +521,32 @@ private void loadDefaultTransferAccoutList(){
         mDefaultTransferAccountCursorAdapter = new QualifiedAccountNameCursorAdapter(getActivity(),
                 android.R.layout.simple_spinner_item,
                 defaultTransferAccountCursor);
-        mParentAccountCursorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
-        mDefaulTransferAccountSpinner.setAdapter(mParentAccountCursorAdapter);
+        mDefaultTransferAccountCursorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
+        mDefaulTransferAccountSpinner.setAdapter(mDefaultTransferAccountCursorAdapter);
     }
 
     /**
-     * Loads the list of possible accounts which can be set as a parent account and initializes the spinner
+     * Loads the list of possible accounts which can be set as a parent account and initializes the spinner.
+     * The allowed parent accounts depends on the account type
+     * @param accountType AccountType of account whose allowed parent list is to be loaded
      */
-	private void loadParentAccountList(){
-        String condition = null;
+	private void loadParentAccountList(Account.AccountType accountType){
+        String condition = DatabaseHelper.KEY_TYPE + " IN ("
+                + getAllowedParentAccountTypes(accountType) + ") ";
+
         if (mAccount != null){  //if editing an account
             // limit cyclic account hierarchies. Still technically possible since we don't forbid descendant accounts
-            condition = "(" + DatabaseHelper.KEY_PARENT_ACCOUNT_UID + " IS NULL "
+            condition += " AND (" + DatabaseHelper.KEY_PARENT_ACCOUNT_UID + " IS NULL "
                     + " OR " + DatabaseHelper.KEY_PARENT_ACCOUNT_UID + " != '" + mAccount.getUID() + "')"
-                    + " AND " + DatabaseHelper.KEY_ROW_ID + "!=" + mSelectedAccountId;
+                    + " AND " + DatabaseHelper.KEY_ROW_ID + " != " + mSelectedAccountId;
+
             //TODO: Limit all descendants of the account to eliminate the possibility of cyclic hierarchy
         }
 
+        //if we are reloading the list, close the previous cursor first
+        if (mParentAccountCursor != null)
+            mParentAccountCursor.close();
+
 		mParentAccountCursor = mAccountsDbAdapter.fetchAccountsOrderedByFullName(condition);
 		if (mParentAccountCursor == null || mParentAccountCursor.getCount() <= 0){
             final View view = getView();
@@ -526,6 +563,68 @@ private void loadParentAccountList(){
 	}
 
     /**
+     * Returns a comma separated list of account types which can be parent accounts for the specified <code>type</code>.
+     * The strings in the list are the {@link org.gnucash.android.model.Account.AccountType#name()}s of the different types.
+     * @param type {@link org.gnucash.android.model.Account.AccountType}
+     * @return String comma separated list of account types
+     */
+    private String getAllowedParentAccountTypes(Account.AccountType type){
+
+        switch (type){
+            case EQUITY:
+                return "'" + Account.AccountType.EQUITY.name() + "'";
+
+            case INCOME:
+            case EXPENSE:
+                return "'" + Account.AccountType.EXPENSE + "', '" + Account.AccountType.INCOME + "', '"
+                        + Account.AccountType.ROOT + "'";
+
+            case CASH:
+            case BANK:
+            case CREDIT:
+            case ASSET:
+            case LIABILITY:
+            case PAYABLE:
+            case RECEIVABLE:
+            case CURRENCY:
+            case STOCK:
+            case MUTUAL: {
+                List<String> accountTypeStrings = getAccountTypeStringList();
+
+                accountTypeStrings.remove(Account.AccountType.EQUITY.name());
+                accountTypeStrings.remove(Account.AccountType.EXPENSE.name());
+                accountTypeStrings.remove(Account.AccountType.INCOME.name());
+
+                String result = "";
+                for (String accountTypeString : accountTypeStrings) {
+                    result += "'" + accountTypeString + "',";
+                }
+
+                //remove the last comma
+                return result.substring(0, result.length() - 1);
+
+            }
+
+            case ROOT:
+            default:
+                return Arrays.toString(Account.AccountType.values()).replaceAll("\\[|]", "");
+        }
+    }
+
+    /**
+     * Returns a list of all the available {@link org.gnucash.android.model.Account.AccountType}s as strings
+     * @return String list of all account types
+     */
+    private List<String> getAccountTypeStringList(){
+        String[] accountTypes = Arrays.toString(Account.AccountType.values()).replaceAll("\\[|]", "").split(",");
+        List<String> accountTypesList = new ArrayList<String>();
+        for (String accountType : accountTypes) {
+            accountTypesList.add(accountType.trim());
+        }
+
+        return accountTypesList;
+    }
+    /**
      * Loads the list of account types into the account type selector spinner
      */
     private void loadAccountTypesList(){
@@ -583,9 +682,8 @@ private void saveAccount() {
 				.getSelectedItemPosition());
 		mAccount.setCurrency(Currency.getInstance(curCode));
 
-        int selectedAccountType = mAccountTypeSpinner.getSelectedItemPosition();
-        String[] accountTypeEntries = getResources().getStringArray(R.array.account_type_entries);
-        mAccount.setAccountType(Account.AccountType.valueOf(accountTypeEntries[selectedAccountType]));
+        Account.AccountType selectedAccountType = getSelectedAccountType();
+        mAccount.setAccountType(selectedAccountType);
 
         mAccount.setPlaceHolderFlag(mPlaceholderCheckBox.isChecked());
         mAccount.setColorCode(mSelectedColor);
@@ -612,8 +710,18 @@ private void saveAccount() {
 
 		finishFragment();
 	}
-	
-	/**
+
+    /**
+     * Returns the currently selected account type in the spinner
+     * @return {@link org.gnucash.android.model.Account.AccountType} currently selected
+     */
+    private Account.AccountType getSelectedAccountType() {
+        int selectedAccountTypeIndex = mAccountTypeSpinner.getSelectedItemPosition();
+        String[] accountTypeEntries = getResources().getStringArray(R.array.account_type_entries);
+        return Account.AccountType.valueOf(accountTypeEntries[selectedAccountTypeIndex]);
+    }
+
+    /**
 	 * Retrieves the name of the account which has been entered in the EditText
 	 * @return
 	 */
diff --git a/app/src/org/gnucash/android/ui/account/AccountsActivity.java b/app/src/org/gnucash/android/ui/account/AccountsActivity.java
index 9570b852..c83147fc 100644
--- a/app/src/org/gnucash/android/ui/account/AccountsActivity.java
+++ b/app/src/org/gnucash/android/ui/account/AccountsActivity.java
@@ -37,6 +37,7 @@
 import android.support.v4.view.ViewPager;
 import android.util.Log;
 import android.util.SparseArray;
+import android.util.SparseIntArray;
 import android.view.View;
 import android.view.ViewGroup;
 import android.widget.Toast;
@@ -133,7 +134,7 @@
     /**
      * Map containing fragments for the different tabs
      */
-    private Map<Integer,Refreshable> mFragmentPageReferenceMap = new HashMap<Integer, Refreshable>();
+    private SparseArray<Refreshable> mFragmentPageReferenceMap = new SparseArray<Refreshable>();
 
     /**
      * ViewPager which manages the different tabs
@@ -238,7 +239,10 @@ public void onCreate(Bundle savedInstanceState) {
             PagerAdapter mPagerAdapter = new AccountViewPagerAdapter(getSupportFragmentManager());
             mPager.setAdapter(mPagerAdapter);
             titlePageIndicator.setViewPager(mPager);
-            mPager.setCurrentItem(INDEX_TOP_LEVEL_ACCOUNTS_FRAGMENT);
+
+            SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(this);
+            int lastTabIndex = preferences.getInt(LAST_OPEN_TAB_INDEX, INDEX_TOP_LEVEL_ACCOUNTS_FRAGMENT);
+            mPager.setCurrentItem(lastTabIndex);
         }
 
 	}
@@ -247,19 +251,22 @@ public void onCreate(Bundle savedInstanceState) {
      * Loads default setting for currency and performs app first-run initialization
      */
     private void init() {
-        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
+        PreferenceManager.setDefaultValues(this, R.xml.fragment_transaction_preferences, false);
+
         Locale locale = Locale.getDefault();
         //sometimes the locale en_UK is returned which causes a crash with Currency
         if (locale.getCountry().equals("UK")) {
             locale = new Locale(locale.getLanguage(), "GB");
         }
+
         String currencyCode;
+        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
         try { //there are some strange locales out there
             currencyCode = prefs.getString(getString(R.string.key_default_currency),
                     Currency.getInstance(locale).getCurrencyCode());
         } catch (Exception e) {
             Log.e(LOG_TAG, e.getMessage());
-            currencyCode = "USD"; //just use USD and let the user choose
+            currencyCode = "USD";
         }
 
         Money.DEFAULT_CURRENCY_CODE = currencyCode;
@@ -275,18 +282,15 @@ private void init() {
 
     }
 
-    @Override
+     @Override
     protected void onResume() {
         super.onResume();
         TransactionsActivity.sLastTitleColor = -1;
-        SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(this);
-        int lastTabIndex = preferences.getInt(LAST_OPEN_TAB_INDEX, INDEX_TOP_LEVEL_ACCOUNTS_FRAGMENT);
-        mPager.setCurrentItem(lastTabIndex);
     }
 
     @Override
-    protected void onStop() {
-        super.onPause();
+    protected void onDestroy() {
+        super.onDestroy();
         SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(this);
         preferences.edit().putInt(LAST_OPEN_TAB_INDEX, mPager.getCurrentItem()).commit();
     }
@@ -471,7 +475,7 @@ public void onClick(DialogInterface dialogInterface, int i) {
         });
 
 		mDefaultAccountsDialog = builder.create();
-		mDefaultAccountsDialog.show();		
+		mDefaultAccountsDialog.show();
 	}
 
     /**
diff --git a/app/src/org/gnucash/android/ui/account/AccountsListFragment.java b/app/src/org/gnucash/android/ui/account/AccountsListFragment.java
index 5863897e..2e6fd37a 100644
--- a/app/src/org/gnucash/android/ui/account/AccountsListFragment.java
+++ b/app/src/org/gnucash/android/ui/account/AccountsListFragment.java
@@ -633,9 +633,8 @@ public Cursor loadInBackground() {
             Cursor cursor;
 
             if (mFilter != null){
-                StringBuffer queryBuffer = new StringBuffer(DatabaseHelper.KEY_NAME)
-                        .append(" LIKE '%").append(mFilter).append("%'");
-                cursor = ((AccountsDbAdapter)mDatabaseAdapter).fetchAccounts(queryBuffer.toString());
+                cursor = ((AccountsDbAdapter)mDatabaseAdapter)
+                        .fetchAccounts(DatabaseHelper.KEY_NAME + " LIKE '%" + mFilter + "%'");
             } else {
                 if (mParentAccountId > 0)
                     cursor = ((AccountsDbAdapter) mDatabaseAdapter).fetchSubAccounts(mParentAccountId);
diff --git a/app/src/org/gnucash/android/ui/transaction/TransactionFormFragment.java b/app/src/org/gnucash/android/ui/transaction/TransactionFormFragment.java
index 251a920e..0c02bc20 100644
--- a/app/src/org/gnucash/android/ui/transaction/TransactionFormFragment.java
+++ b/app/src/org/gnucash/android/ui/transaction/TransactionFormFragment.java
@@ -213,7 +213,7 @@ public void onActivityCreated(Bundle savedInstanceState) {
 		actionBar.setDisplayShowTitleEnabled(false);
 
 		SharedPreferences sharedPrefs = PreferenceManager.getDefaultSharedPreferences(getActivity());
-		mUseDoubleEntry = sharedPrefs.getBoolean(getString(R.string.key_use_double_entry), false);
+		mUseDoubleEntry = sharedPrefs.getBoolean(getString(R.string.key_use_double_entry), true);
 		if (!mUseDoubleEntry){
 			getView().findViewById(R.id.layout_double_entry).setVisibility(View.GONE);
 		}
@@ -604,7 +604,7 @@ private void saveNewTransaction() {
             long recurrencePeriodMillis = Long.parseLong(recurrenceOptions[recurrenceIndex]);
             long firstRunMillis = System.currentTimeMillis() + recurrencePeriodMillis;
 
-            Transaction recurringTransaction = new Transaction(mTransaction);
+            Transaction recurringTransaction = new Transaction(mTransaction, true);
             recurringTransaction.setRecurrencePeriod(recurrencePeriodMillis);
             long recurringTransactionId = mTransactionsDbAdapter.addTransaction(recurringTransaction);
 
diff --git a/integration-tests/pom.xml b/integration-tests/pom.xml
index 274c36a7..6c32e8fe 100644
--- a/integration-tests/pom.xml
+++ b/integration-tests/pom.xml
@@ -17,7 +17,7 @@
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
     <modelVersion>4.0.0</modelVersion>
     <parent>
-		<version>1.3.0-SNAPSHOT</version>
+		<version>1.3.2-SNAPSHOT</version>
 		<groupId>org.gnucash.android</groupId>
 		<artifactId>gnucash-android-parent</artifactId>
 	</parent>
diff --git a/pom.xml b/pom.xml
index 3752af57..3bb0faac 100644
--- a/pom.xml
+++ b/pom.xml
@@ -17,7 +17,7 @@
 
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
     <modelVersion>4.0.0</modelVersion>
-	<version>1.3.0-SNAPSHOT</version>
+	<version>1.3.2-SNAPSHOT</version>
     <groupId>org.gnucash.android</groupId>
     <artifactId>gnucash-android-parent</artifactId>
     <name>GnuCash Android parent</name>

From acd715f1279ab9d70cd9eac39bddcece5472dfd8 Mon Sep 17 00:00:00 2001
From: aerkefiende <aerkefiende@bcfh.eu>
Date: Sun, 23 Mar 2014 12:37:09 +0100
Subject: [PATCH 06/16] Replacing Gnucash with GnuCash

---
 app/res/values-de/strings.xml | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

diff --git a/app/res/values-de/strings.xml b/app/res/values-de/strings.xml
index a03ac04f..9bdf50e3 100644
--- a/app/res/values-de/strings.xml
+++ b/app/res/values-de/strings.xml
@@ -68,14 +68,14 @@
     <string name="title_share_ofx_with">OFX-Datei senden mit</string>
     <string name="toast_incompatible_currency">Buchungen k&#246;nnten nicht verschoben werden.\Die W&#228;hrung des Zielkontos ist inkompatibel</string>
     <string name="header_general_settings">Allgemein</string>
-    <string name="header_about_gnucash">&#220;ber Gnucash</string>
+    <string name="header_about_gnucash">&#220;ber GnuCash</string>
     <string name="title_choose_currency">Standardw&#228;hrung ausw&#228;hlen</string>
     <string name="title_default_currency">Standardw&#228;hrung</string>
     <string name="summary_default_currency">Standardw&#228;hrung f&#252;r neuen Konten</string>
-    <string name="label_permission_record_transactions">Erm&#246;glicht das Speichern von Buchungen in Gnucash</string>
-    <string name="label_permission_create_accounts">Erm&#246;glicht das Erstellen von Konten in Gnucash</string>
-    <string name="label_permission_group">Ihre Gnucash-Daten</string>
-    <string name="description_permission_group">Lesen und Bearbeiten von Gnucash-Daten</string>
+    <string name="label_permission_record_transactions">Erm&#246;glicht das Speichern von Buchungen in GnuCash</string>
+    <string name="label_permission_create_accounts">Erm&#246;glicht das Erstellen von Konten in GnuCash</string>
+    <string name="label_permission_group">Ihre GnuCash-Daten</string>
+    <string name="description_permission_group">Lesen und Bearbeiten von GnuCash-Daten</string>
     <string name="label_permission_record_transaction">Buchungen speichern</string>
     <string name="label_permission_create_account">Konten erstellen</string>
     <string name="label_display_account">Konto anzeigen</string>
@@ -272,14 +272,14 @@
 	<string name="title_general_prefs">Allgemein</string>
 	<string name="label_widget_configuration">Konto ausw&#228;hlen</string>
 	<string name="toast_no_transactions_to_export">Keine Buchungen zum Exportieren</string>
-	<string name="title_about_gnucash">&#220;ber Gnucash</string>
-	<string name="summary_about_gnucash">GnucashMobile ist eine mobile Datenaufzeichungs-App f&#252;r Android. \nEs erm&#246;glicht die schnelle und flexible Registrierung von Zahlungsvorg&#228;ngen unterwegs, die dann als Datei im OFX-Format exportiert und von der GnuCash-Anwendung an einem Desktop-PC importiert werden k&#246;nnen.</string>
+	<string name="title_about_gnucash">&#220;ber GnuCash</string>
+	<string name="summary_about_gnucash">GnuCashMobile ist eine mobile Datenaufzeichungs-App f&#252;r Android. \nEs erm&#246;glicht die schnelle und flexible Registrierung von Zahlungsvorg&#228;ngen unterwegs, die dann als Datei im OFX-Format exportiert und von der GnuCash-Anwendung an einem Desktop-PC importiert werden k&#246;nnen.</string>
 	<string name="title_about">&#220;ber</string>
 	<string name="ofx_file_exported_to">OFX-Datei exportiert nach:</string>
 	<string name="toast_error_exporting_ofx">Fehler beim Exportieren der OFX-Datei:\n</string>
 	<string name="toast_ofx_exported_to">OFX-Datei erfolgreich exportiert nach:\n</string>
-	<string name="title_export_email">Gnucash exportierte OFX-Datei</string>
-	<string name="description_export_email">Gnucash-Konten-Export von </string>
+	<string name="title_export_email">GnuCash exportierte OFX-Datei</string>
+	<string name="description_export_email">GnuCash-Konten-Export von </string>
 	<string name="header_transaction_settings">Buchungen</string>
 	<string name="title_transaction_preferences">Einstellungen Buchungen</string>
 	<string name="title_account_preferences">Einstellungen Konten</string>

From c38d54bcc2422fc83a91ff286460070016a774ae Mon Sep 17 00:00:00 2001
From: aerkefiende <aerkefiende@bcfh.eu>
Date: Sun, 23 Mar 2014 12:57:05 +0100
Subject: [PATCH 07/16] Fixed small typos

---
 app/res/values-de/strings.xml | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/app/res/values-de/strings.xml b/app/res/values-de/strings.xml
index 9bdf50e3..3856c756 100644
--- a/app/res/values-de/strings.xml
+++ b/app/res/values-de/strings.xml
@@ -71,7 +71,7 @@
     <string name="header_about_gnucash">&#220;ber GnuCash</string>
     <string name="title_choose_currency">Standardw&#228;hrung ausw&#228;hlen</string>
     <string name="title_default_currency">Standardw&#228;hrung</string>
-    <string name="summary_default_currency">Standardw&#228;hrung f&#252;r neuen Konten</string>
+    <string name="summary_default_currency">Standardw&#228;hrung f&#252;r neue Konten</string>
     <string name="label_permission_record_transactions">Erm&#246;glicht das Speichern von Buchungen in GnuCash</string>
     <string name="label_permission_create_accounts">Erm&#246;glicht das Erstellen von Konten in GnuCash</string>
     <string name="label_permission_group">Ihre GnuCash-Daten</string>
@@ -265,7 +265,7 @@
 	    <item>KapitalKonto</item>
 	    <item>Passiva</item>
 	</string-array>
-	<string name="error_no_accounts">Keine Konten vorhanden.\nSie m&#252;ssen einen Konto erstellen um Widgets zu anzuf&#252;gen</string>
+	<string name="error_no_accounts">Keine Konten vorhanden.\nSie m&#252;ssen ein Konto erstellen um Widgets anf&#252;gen zu k&#246;nnen.</string>
 	<string name="title_build_version">Version</string>
 	<string name="title_license">Lizenz</string>
 	<string name="summary_licence_details">Apache License v2.0. Klicken f&#252;r Details</string>
@@ -294,7 +294,7 @@
 	<string name="title_export_preference_category">Exportieren</string>
 	<string name="title_export_all_transactions">Alle Buchungen exportieren</string>
 	<string name="title_always_delete_exported_transactions">Alle exportierten Buchungen l&#246;schen</string>
-	<string name="title_default_export_email">Standard Export E-mail</string>
+	<string name="title_default_export_email">Standard Export E-Mail</string>
 	<string name="summary_default_export_email">Die Standard-E-Mail, an die exportierte OFX Dateien geschickt werden. Sie knnen diese immer noch beim Exportieren ndern.</string>
 	<string name="label_double_entry_account">berweisungskonto</string>
 	<string name="summary_use_double_entry">Alle Buchungen stellen eine berweisung von einem Konto zu einem anderen dar</string>
@@ -386,7 +386,7 @@
     <string name="msg_confirm_create_default_accounts_setting">Neue Konten werden zustzlich zur existierenden Kontenstruktur erstellt.\n\nWenn Sie die derzeitig existierenden Konten ersetzen wollen, lschen Sie diese bitte, bevor Sie fortfahren!
     </string>
     <string name="menu_scheduled_transactions">Eingeplante Buchungen</string>
-    <string name="msg_confirm_create_default_accounts_first_run">Willkommen bei GnuCash Android!\nSie knnen entweder eine Hierarchie der fr gewhnlich verwendeten Konten erstellen oder Ihre eigene GnuCash-Kontenstruktur importieren\n\nBeide Optionen sind auch in den Einstellungen verfgbar, sodass Sie dies spter entscheiden knnen.
+    <string name="msg_confirm_create_default_accounts_first_run">Willkommen bei GnuCash Android!\nSie knnen entweder eine Hierarchie der fr gewhnlich verwendeten Konten erstellen oder Ihre eigene GnuCash-Kontenstruktur importieren.\n\nBeide Optionen sind auch in den Einstellungen verfgbar, sodass Sie dies spter entscheiden knnen.
     </string>
     <string-array name="recurrence_values">
         <item>KEINE</item>

From 7b2db061fba8e5f2dd9313231b94b474fe32bb40 Mon Sep 17 00:00:00 2001
From: aerkefiende <aerkefiende@bcfh.eu>
Date: Sun, 23 Mar 2014 14:27:19 +0100
Subject: [PATCH 08/16] Android Studio gets error if same string is defined
 more than once

Introduced in commit 3616eff03f81de2b1ff271de810388f446bcde0e
---
 app/res/values-el/strings.xml | 1 -
 1 file changed, 1 deletion(-)

diff --git a/app/res/values-el/strings.xml b/app/res/values-el/strings.xml
index f08e2dea..39a35470 100644
--- a/app/res/values-el/strings.xml
+++ b/app/res/values-el/strings.xml
@@ -285,7 +285,6 @@
 	<string name="toast_ofx_exported_to"> OFX  :\n</string>
 	<string name="title_export_email"> GnuCash OFX</string>
 	<string name="description_export_email"> GnuCash OFX  </string>
-	<string name="header_transaction_settings"></string>
 	<string name="header_transaction_settings"></string>
 	<string name="title_transaction_preferences"> </string>
 	<string name="title_account_preferences"> </string>

From b4699006d33250bbdf4cc2d456a5cd81b6fa7cbd Mon Sep 17 00:00:00 2001
From: Spanti Nicola <rydroid_dev@yahoo.com>
Date: Fri, 11 Apr 2014 20:35:14 -0400
Subject: [PATCH 09/16] An improve french translation

---
 app/res/values-fr/strings.xml | 84 +++++++++++++++++++++----------------------
 app/res/values/strings.xml    |  2 +-
 2 files changed, 43 insertions(+), 43 deletions(-)

diff --git a/app/res/values-fr/strings.xml b/app/res/values-fr/strings.xml
index 94887e1d..088c51a6 100644
--- a/app/res/values-fr/strings.xml
+++ b/app/res/values-fr/strings.xml
@@ -19,23 +19,23 @@
 <resources>
     <string name="app_name">GnuCash</string>
     <string name="title_add_account">Cr&#233;er un compte</string>
-    <string name="title_edit_account">Editer le compte</string>
+    <string name="title_edit_account">diter le compte</string>
     <string name="info_details">Informations</string>
     <string name="menu_export_ofx">Exporter en OFX</string>
     <string name="description_add_transaction_icon">Ajoute une nouvelle transaction &#224; un compte</string>
-    <string name="label_no_accounts">Aucun comptes &#224; afficher</string>
+    <string name="label_no_accounts">Aucun compte &#224; afficher</string>
     <string name="label_account_name">Nom de compte</string>
     <string name="btn_cancel">Annuler</string>
-    <string name="btn_save">Sauvgarder</string>
-    <string name="label_no_transactions_to_display">Aucune transactions &#224; afficher</string>
+    <string name="btn_save">Sauvegarder</string>
+    <string name="label_no_transactions_to_display">Aucune transaction &#224; afficher</string>
     <string name="label_transaction_name">Description</string>
     <string name="label_transaction_amount">Montant</string>
     <string name="title_add_transaction">Nouvelle transaction</string>
     <string name="label_no_transactions">Aucune transaction &#224; afficher</string>
     <string name="label_timeanddate">DATE &amp; HEURE</string>
     <string name="label_account">Compte</string>
-    <string name="label_debit">DEBIT</string>
-    <string name="label_credit">CREDIT</string>
+    <string name="label_debit">DBIT</string>
+    <string name="label_credit">CRDIT</string>
     <string name="title_accounts">Comptes</string>
     <string name="title_transactions">Transactions</string>
     <string name="menu_delete">SUPPRIMER</string>
@@ -44,13 +44,13 @@
     <string name="toast_account_deleted">Compte supprim&#233;</string>
     <string name="title_confirm_delete">Confirmer la suppression</string>
     <string name="delete_account_confirmation_message">Toutes les transactions dans ce compte seront aussi supprimes</string>
-    <string name="title_edit_transaction">Editer la transaction</string>
+    <string name="title_edit_transaction">diter la transaction</string>
     <string name="label_transaction_description">Note</string>
-    <string name="menu_move">DEPLACER</string>
+    <string name="menu_move">DPLACER</string>
     <string name="title_selected">%1$d s&#233;lectionn(s)</string>
-    <string name="label_transactions_total">Total:</string>
+    <string name="label_transactions_total">Total :</string>
     <string name="label_export_destination">Destination d\'export</string>
-    <string name="title_export_dialog">Exporter les Transactions</string>
+    <string name="title_export_dialog">Exporter les transactions</string>
     <string name="option_export_all_transactions">Exporter toutes les transactions</string>
     <string name="hint_export_choice">Par d&#233;faut, seul les nouvelles transactions depuis le dernier export seront exportes. Cochez cette option pour exporter toutes les transactions</string>
     <string name="error_exporting">Erreur lors de l\'export des donn&#233;es en OFX</string>
@@ -67,14 +67,14 @@
     <string name="label_move_destination">Compte de destination</string>
     <string name="permission_access_sdcard">Acc&#233;s carte SD</string>
     <string name="title_share_ofx_with">Partager l\'export en OFX avec</string>
-    <string name="toast_incompatible_currency">Impposible de d&#233;placer les transactions.\nLe compte de destination utilise une monnaie diff&#233;rente du compte d\'origine</string>
+    <string name="toast_incompatible_currency">Impossible de d&#233;placer les transactions.\nLe compte de destination utilise une monnaie diff&#233;rente du compte d\'origine</string>
     <string name="header_general_settings">G&#233;n&#233;ral</string>
-    <string name="header_about_gnucash">A propos</string>
+    <string name="header_about_gnucash"> propos</string>
     <string name="title_choose_currency">Choisisez une monnaie par d&#233;faut</string>
     <string name="title_default_currency">Monnaie par d&#233;faut</string>
     <string name="summary_default_currency">Monnaie par d&#233;faut &#224; assigne aux nouveau comptes</string>
-    <string name="label_permission_record_transactions">Permettre l\'enregistrement des transactions dans Gnucash pour Android</string>
-    <string name="label_permission_create_accounts">Permettre la cr&#233;ation de comptes dans Gnucash pour Android</string>
+    <string name="label_permission_record_transactions">Permettre l\'enregistrement des transactions dans GnuCash pour Android</string>
+    <string name="label_permission_create_accounts">Permettre la cr&#233;ation de comptes dans GnuCash pour Android</string>
     <string name="label_permission_group">Vos donn&#233;es GnuCash</string>
     <string name="description_permission_group">Lire et modifier les donn&#233;es GnuCash</string>
     <string name="label_permission_record_transaction">enregistrer les transactions</string>
@@ -266,31 +266,31 @@
         <item>Capitaux propres</item>
         <item>Charges</item>
     </string-array>
-    <string name="error_no_accounts">Aucun compte &#233;xistant dans Gnucash.\nCr&#233;ez un compte avant d\'ajouter un widget</string>
+    <string name="error_no_accounts">Aucun compte &#233;xistant dans GnuCash.\nCr&#233;ez un compte avant d\'ajouter un widget</string>
     <string name="title_build_version">Version logiciel</string>
     <string name="title_license">Licence</string>
-    <string name="summary_licence_details">Apache License v2.0. Clickez pour plus de d&#233;tails</string>
+    <string name="summary_licence_details">Apache License v2.0. Cliquez pour plus de d&#233;tails</string>
     <string name="title_general_prefs">G&#233;n&#233;ral</string>
     <string name="label_widget_configuration">S&#233;lectionner un compte</string>
-    <string name="toast_no_transactions_to_export">Il n\'existe pas de transactions disponible pour l\'exportation</string>
-    <string name="title_about_gnucash">A propos de Gnucash</string>
-    <string name="summary_about_gnucash">GnucashMobile est une application mobile de suivis de finance pour Android.\nElle permet un suivi simple des d&#233;penses qui peut &#234;tre export&#233; vers le format Open Financial eXchange (OFX) et import&#233; dans Gnucash pour PC.</string>
+    <string name="toast_no_transactions_to_export">Il n\'existe pas de transaction disponible pour l\'exportation</string>
+    <string name="title_about_gnucash"> propos de GnuCash</string>
+    <string name="summary_about_gnucash">GnucashMobile est une application mobile de suivis de finance pour Android.\nElle permet un suivi simple des d&#233;penses qui peut &#234;tre export&#233; vers le format Open Financial eXchange (OFX) et import&#233; dans GnuCash pour PC.</string>
     <string name="title_about">A propos</string>
-    <string name="toast_error_exporting">Impossible d\'&#233;crire un fichier OFX en:\n</string>
-    <string name="toast_ofx_exported_to">Fichier OFX export&#233; en:\n</string>
-    <string name="title_export_email">Gnucash OFX export</string>
-    <string name="description_export_email">Gnucash OFX Export de </string>
+    <string name="toast_error_exporting">Impossible d\'&#233;crire un fichier OFX en :\n</string>
+    <string name="toast_ofx_exported_to">Fichier OFX export&#233; en :\n</string>
+    <string name="title_export_email">GnuCash OFX export</string>
+    <string name="description_export_email">GnuCash OFX export de </string>
     <string name="header_transaction_settings">Transactions</string>
     <string name="title_transaction_preferences">Pr&#233;f&#233;rences des transactions</string>
     <string name="title_account_preferences">Pr&#233;f&#233;rences du compte</string>
     <string name="title_default_transaction_type">Type de transaction par d&#233;faut</string>
-    <string name="summary_default_transaction_type">Le type de transaction &#224; utiliser par d&#233;faut, CREDIT ou DEBIT</string>
+    <string name="summary_default_transaction_type">Le type de transaction &#224; utiliser par d&#233;faut, CRDIT ou DBIT</string>
     <string-array name="transaction_types">
-        <item>CREDIT</item>
-        <item>DEBIT</item>
+        <item>CRDIT</item>
+        <item>DBIT</item>
     </string-array>
-    <string name="msg_delete_all_transactions_confirmation">Etes vous s&#251;re de vouloir supprimer TOUTES les transactions?</string>
-    <string name="msg_delete_transaction_confirmation">Etes vous s&#251;re de vouloir supprimer cette transaction?</string>
+    <string name="msg_delete_all_transactions_confirmation">tes vous s&#251;re de vouloir supprimer TOUTES les transactions ?</string>
+    <string name="msg_delete_transaction_confirmation">tes vous s&#251;re de vouloir supprimer cette transaction ?</string>
     <string name="title_export_preference_category">Export</string>
     <string name="title_export_all_transactions">Exporter toutes les transactions</string>
     <string name="title_always_delete_exported_transactions">Supprimer les transactions export&#233;es</string>
@@ -317,7 +317,7 @@
         - Nombreuses corrections de bogues et amliorations\n
 	</string>
     <string name="label_dismiss">Passer</string>
-    <string name="toast_transanction_amount_required">Entrez un montant pour sauvgarder la transaction</string>
+    <string name="toast_transanction_amount_required">Entrez un montant pour sauvegarder la transaction</string>
     <string name="menu_import_accounts">Importer des comptes GnuCash</string>
     <string name="btn_import_accounts">Import de comptes</string>
     <string name="toast_error_importing_accounts">Une &#233;rreur s\'est produite pendant l\'import de vos comptes GnuCash</string>
@@ -328,19 +328,19 @@
     <string name="title_delete_all_accounts">Supprimer tous les comptes</string>
     <string name="header_account_settings">Comptes</string>
     <string name="toast_all_accounts_deleted">Tous les comptes ont &#233;t&#233; supprim&#233;s avec succ&#232;s</string>
-    <string name="confirm_delete_all_accounts">Etes-vous s&#251;r de vouloir supprimer tous les comptes et toutes les transactions?\n Cette op&#233;ration est d&#233;finitive!</string>
+    <string name="confirm_delete_all_accounts">tes-vous s&#251;r de vouloir supprimer tous les comptes et toutes les transactions?\nCette op&#233;ration est d&#233;finitive !</string>
     <string name="label_account_type">Type de compte</string>
-    <string name="summary_delete_all_transactions">Toutes les transactions sur tous les comptes seront supprim&#233;es!</string>
+    <string name="summary_delete_all_transactions">Toutes les transactions sur tous les comptes seront supprim&#233;es !</string>
     <string name="title_delete_all_transactions">Supprimer toutes les transactions</string>
-    <string name="toast_all_transactions_deleted">Toutes les transactions ont &#233;t&#233; supprim&#233;es avec succ&#232;s!</string>
+    <string name="toast_all_transactions_deleted">Toutes les transactions ont &#233;t&#233; supprim&#233;es avec succ&#232;s !</string>
     <string name="title_progress_importing_accounts">Importation de comptes</string>
-    <string name="toast_tap_again_to_confirm_delete">Taper de nouveau pour confirmer. TOUTES les entres seront supprimes!!</string>
+    <string name="toast_tap_again_to_confirm_delete">Taper de nouveau pour confirmer. TOUTES les entres seront supprimes !</string>
     <string name="section_header_transactions">Transactions</string>
-    <string name="section_header_subaccounts">Sous-Comptes</string>
+    <string name="section_header_subaccounts">Sous-comptes</string>
     <string name="menu_search_accounts">Rechercher</string>
     <string name="title_default_export_format">Format d\'export par dfaut</string>
     <string name="summary_default_export_format">Format de fichier  utiliser par dfaut pour l\'export des transactions</string>
-    <string name="menu_export_transactions">Export transactions</string>
+    <string name="menu_export_transactions">Exporter les transactions</string>
     <string name="label_recurring_transaction">Rcurrence</string>
     <!-- This should be the same name used by GnuCash desktop for imbalance accounts -->
     <string name="imbalance_account_name">Dsquilibre</string>
@@ -382,17 +382,17 @@
     <string name="summary_create_default_accounts">Cre une structure de compte GnuCash par dfaut couramment utilis</string>
     <string name="title_create_default_accounts">Cre comptes par dfaut</string>
     <string name="msg_confirm_create_default_accounts_setting">Les nouveaux comptes seront crs en plus de l\'existante
-		structure de compte.\n\n Si vous souhaitez remplacer des comptes existants, supprimez-les d\'abord avant de commencer!
+		structure de compte.\n\n Si vous souhaitez remplacer des comptes existants, supprimez-les d\'abord avant de commencer !
     </string>
-    <string name="msg_confirm_create_default_accounts_first_run">Bienvenue  GnuCash Android!\n Vous pouvez soit crer
-		une hirarchie de comptes couramment utiliss, importer votre propre structure de compte GnuCash.\n\n Les deux options sont galement
-		disponible dans les paramtres d\'applications de sorte que vous puissiez dcider plus tard.</string>
+    <string name="msg_confirm_create_default_accounts_first_run">Bienvenue sur GnuCash Android!\nVous pouvez soit crer
+		une hirarchie de comptes couramment utiliss, importer votre propre structure de compte GnuCash.\n\nLes deux options sont galement
+		disponibles dans les paramtres de l\'application de sorte que vous puissiez dcider plus tard.</string>
     <string-array name="recurrence_period_strings">
         <item>AUCUN</item>
         <item>QUOTIDIEN</item>
         <item>SEMAINE</item>
         <item>MENSUEL</item>
     </string-array>
-    <string name="menu_scheduled_transactions">Scheduled Transactions</string>
-    <string name="title_scheduled_transactions">Scheduled Transactions</string>
-</resources>
+    <string name="menu_scheduled_transactions">Transactions planifies</string>
+    <string name="title_scheduled_transactions">Transactions planifies</string>
+</resources>
\ No newline at end of file
diff --git a/app/res/values/strings.xml b/app/res/values/strings.xml
index 43a8fbd7..a75ee62c 100644
--- a/app/res/values/strings.xml
+++ b/app/res/values/strings.xml
@@ -526,7 +526,7 @@
     <string name="title_delete_all_accounts">Delete all accounts</string>
     <string name="header_account_settings">Accounts</string>
     <string name="toast_all_accounts_deleted">All accounts have been successfully deleted</string>
-    <string name="confirm_delete_all_accounts">Are you sure you want to delete all accounts and transactions? \n\nThis
+    <string name="confirm_delete_all_accounts">Are you sure you want to delete all accounts and transactions?\n\nThis
         operation cannot be undone!
     </string>
     <string name="label_account_type">Account Type</string>

From 19a346bfd4886d7b4c252eb773aa307cb4256990 Mon Sep 17 00:00:00 2001
From: Yongxin Wang <fefe.wyx@gmail.com>
Date: Wed, 7 May 2014 23:18:08 +0800
Subject: [PATCH 10/16] close cursors

---
 .../org/gnucash/android/db/AccountsDbAdapter.java  | 30 ++++++--
 .../gnucash/android/db/TransactionsDbAdapter.java  | 90 ++++++++++++++--------
 2 files changed, 79 insertions(+), 41 deletions(-)

diff --git a/app/src/org/gnucash/android/db/AccountsDbAdapter.java b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
index bb91f66c..894b576d 100644
--- a/app/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -699,10 +699,12 @@ public long getId(String accountUID){
 				new String[]{DatabaseHelper.KEY_ROW_ID, DatabaseHelper.KEY_UID}, 
 				DatabaseHelper.KEY_UID + "='" + accountUID + "'", 
 				null, null, null, null);
-		if (c != null && c.moveToFirst()){
-			id = c.getLong(DatabaseAdapter.COLUMN_ROW_ID);
-			c.close();
-		}
+		if (c != null) {
+            if (c.moveToFirst()) {
+                id = c.getLong(DatabaseAdapter.COLUMN_ROW_ID);
+            }
+            c.close();
+        }
 		return id;
 	}
 	
@@ -740,7 +742,10 @@ public String getAccountName(String accountUID){
                 DatabaseHelper.KEY_UID + " = ?",
                 new String[]{accountUID}, null, null, null);
 
-        if (cursor == null || cursor.getCount() < 1){
+        if (cursor == null) {
+            return null;
+        } else if ( cursor.getCount() < 1) {
+            cursor.close();
             return null;
         } else {  //account UIDs should be unique
             cursor.moveToFirst();
@@ -763,7 +768,10 @@ public long getDefaultTransferAccountID(long accountID){
                 DatabaseHelper.KEY_ROW_ID + " = " + accountID,
                 null, null, null, null);
 
-        if (cursor == null || cursor.getCount() < 1){
+        if (cursor == null) {
+            return 0;
+        } else if (cursor.getCount() < 1) {
+            cursor.close();
             return 0;
         } else {
             cursor.moveToFirst();
@@ -818,7 +826,10 @@ public boolean isPlaceholderAccount(String accountUID){
                 DatabaseHelper.KEY_UID + " = ?",
                 new String[]{accountUID}, null, null, null);
 
-        if (cursor == null || !cursor.moveToFirst()){
+        if (cursor == null)
+            return false;
+        if (!cursor.moveToFirst()) {
+            cursor.close();
             return false;
         }
         boolean isPlaceholder = cursor.getInt(cursor.getColumnIndexOrThrow(DatabaseHelper.KEY_PLACEHOLDER)) == 1;
@@ -847,7 +858,10 @@ public boolean isFavoriteAccount(long accountId){
                 DatabaseHelper.KEY_ROW_ID + " = " + accountId, null,
                 null, null, null);
 
-        if (cursor == null || !cursor.moveToFirst()){
+        if (cursor == null)
+            return false;
+        if (!cursor.moveToFirst()){
+            cursor.close();
             return false;
         }
         boolean isFavorite = cursor.getInt(cursor.getColumnIndexOrThrow(DatabaseHelper.KEY_FAVORITE)) == 1;
diff --git a/app/src/org/gnucash/android/db/TransactionsDbAdapter.java b/app/src/org/gnucash/android/db/TransactionsDbAdapter.java
index 5bfc881c..f6a84564 100644
--- a/app/src/org/gnucash/android/db/TransactionsDbAdapter.java
+++ b/app/src/org/gnucash/android/db/TransactionsDbAdapter.java
@@ -92,12 +92,13 @@ public long fetchTransactionWithUID(String uid){
 				DatabaseHelper.KEY_UID + " = '" + uid + "'", 
 				null, null, null, null);
 		long result = -1;
-		if (cursor != null && cursor.moveToFirst()){
-			Log.d(TAG, "Transaction already exists. Returning existing id");
-			result = cursor.getLong(0); //0 because only one row was requested
-
-			cursor.close();
-		}
+		if (cursor != null) {
+            if (cursor.moveToFirst()) {
+                Log.d(TAG, "Transaction already exists. Returning existing id");
+                result = cursor.getLong(0); //0 because only one row was requested
+            }
+            cursor.close();
+        }
 		return result;
 	}
 
@@ -113,10 +114,12 @@ public Transaction getTransaction(long rowId){
 		Log.v(TAG, "Fetching transaction with id " + rowId);
         Transaction transaction = null;
 		Cursor c =	fetchRecord(DatabaseHelper.TRANSACTIONS_TABLE_NAME, rowId);
-		if (c != null && c.moveToFirst()){
-			transaction = buildTransactionInstance(c);			
-			c.close();
-		}
+		if (c != null) {
+            if (c.moveToFirst()) {
+                transaction = buildTransactionInstance(c);
+            }
+            c.close();
+        }
 		return transaction;
 	}
 	
@@ -173,9 +176,12 @@ public Cursor fetchAllTransactionsForAccount(long accountID){
 	public List<Transaction> getAllTransactionsForAccount(String accountUID){
 		Cursor c = fetchAllTransactionsForAccount(accountUID);
 		ArrayList<Transaction> transactionsList = new ArrayList<Transaction>();
-		
-		if (c == null || (c.getCount() <= 0))
+		if (c == null)
 			return transactionsList;
+        if (c.getCount() <= 0) {
+            c.close();
+            return transactionsList;
+        }
 		
 		while (c.moveToNext()) {
 			Transaction transaction = buildTransactionInstance(c);
@@ -235,8 +241,12 @@ public String getCurrencyCode(String accountUID) {
 				DatabaseHelper.KEY_UID + "= '" + accountUID + "'", 
 				null, null, null, null);
 		
-		if (cursor == null || cursor.getCount() <= 0)
+		if (cursor == null)
 			return null;
+        if (cursor.getCount() <= 0) {
+            cursor.close();
+            return null;
+        }
 					
 		cursor.moveToFirst();
 		String currencyCode = cursor.getString(0);
@@ -338,7 +348,7 @@ public long getAllTransactionsCount(){
 	 * @param accountId Record ID of the account
 	 * @return Sum of transactions belonging to the account
 	 */
-	public Money getTransactionsSum(long accountId){
+	public Money getTransactionsSum(long accountId) {
         //FIXME: Properly compute the balance while considering normal account balance
         String accountUID = getAccountUID(accountId);
 
@@ -350,8 +360,10 @@ public Money getTransactionsSum(long accountId){
         Cursor sumCursor = mDb.rawQuery(querySum, new String[]{accountUID});
         double sum = 0d;
 
-        if (sumCursor != null && sumCursor.moveToFirst()){
-            sum += sumCursor.getFloat(0);
+        if (sumCursor != null) {
+            if (sumCursor.moveToFirst()) {
+                sum += sumCursor.getFloat(0);
+            }
             sumCursor.close();
         }
 
@@ -362,8 +374,10 @@ public Money getTransactionsSum(long accountId){
 
         sumCursor = mDb.rawQuery(querySum, new String[]{accountUID});
 
-        if (sumCursor != null && sumCursor.moveToFirst()){
-            sum -= sumCursor.getFloat(0);
+        if (sumCursor != null) {
+            if (sumCursor.moveToFirst()) {
+                sum -= sumCursor.getFloat(0);
+            }
             sumCursor.close();
         }
 
@@ -393,8 +407,10 @@ public boolean isSameAccount(long rowId, String accountUID){
                 new String[]{DatabaseHelper.KEY_TYPE},
                 DatabaseHelper.KEY_UID + "='" + accountUID + "'",
                 null, null, null, null);
-        if (c != null && c.moveToFirst()){
-            type = c.getString(c.getColumnIndexOrThrow(DatabaseHelper.KEY_TYPE));
+        if (c != null) {
+            if (c.moveToFirst()) {
+                type = c.getString(c.getColumnIndexOrThrow(DatabaseHelper.KEY_TYPE));
+            }
             c.close();
         }
         return Account.AccountType.valueOf(type);
@@ -432,6 +448,7 @@ public int markAsExported(String accountUID){
 		while (c.moveToNext()){
 			transactionsList.add(buildTransactionInstance(c));
 		}
+        c.close();
 		return transactionsList;
 	}
 
@@ -446,10 +463,12 @@ public String getAccountUID(long accountRowID){
 				new String[]{DatabaseHelper.KEY_UID}, 
 				DatabaseHelper.KEY_ROW_ID + "=" + accountRowID, 
 				null, null, null, null);
-		if (c != null && c.moveToFirst()){
-			uid = c.getString(0);
-			c.close();
-		}
+		if (c != null) {
+            if (c.moveToFirst()) {
+                uid = c.getString(0);
+            }
+            c.close();
+        }
 		return uid;
 	}
 
@@ -464,11 +483,12 @@ public String getAccountUidFromTransaction(long transactionID){
                 DatabaseHelper.KEY_ROW_ID + "=" + transactionID,
                 null, null, null, null);
         String accountUID = null;
-        if (c != null && c.moveToFirst()){
-            accountUID = c.getString(0);
+        if (c != null) {
+            if (c.moveToFirst()) {
+                accountUID = c.getString(0);
+            }
             c.close();
         }
-
         return accountUID;
     }
 
@@ -483,10 +503,12 @@ public long getAccountID(String accountUID){
 				new String[]{DatabaseHelper.KEY_ROW_ID}, 
 				DatabaseHelper.KEY_UID + "='" + accountUID + "'", 
 				null, null, null, null);
-		if (c != null && c.moveToFirst()){
-			id = c.getLong(0);
-			c.close();
-		}
+		if (c != null) {
+            if (c.moveToFirst()) {
+                id = c.getLong(0);
+            }
+            c.close();
+        }
 		return id;
 	}
 
@@ -501,8 +523,10 @@ public long getID(String transactionUID){
                 new String[]{DatabaseHelper.KEY_ROW_ID},
                 DatabaseHelper.KEY_UID + "='" + transactionUID + "'",
                 null, null, null, null);
-        if (c != null && c.moveToFirst()){
-            id = c.getLong(0);
+        if (c != null) {
+            if (c.moveToFirst()) {
+                id = c.getLong(0);
+            }
             c.close();
         }
         return id;

From f6ae9103383349d5d21f2552eb54bd2e571adf30 Mon Sep 17 00:00:00 2001
From: Yongxin Wang <fefe.wyx@gmail.com>
Date: Thu, 8 May 2014 22:59:55 +0800
Subject: [PATCH 11/16] More db resource leaks

---
 .../org/gnucash/android/db/AccountsDbAdapter.java  | 62 +++++++++++++---------
 .../ui/transaction/TransactionsActivity.java       | 15 ++++--
 .../android/util/GnucashAccountXmlHandler.java     |  2 +-
 3 files changed, 49 insertions(+), 30 deletions(-)

diff --git a/app/src/org/gnucash/android/db/AccountsDbAdapter.java b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
index 894b576d..6a24938d 100644
--- a/app/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -269,12 +269,13 @@ public long getAccountID(String uid){
 				new String[] {DatabaseHelper.KEY_ROW_ID, DatabaseHelper.KEY_UID}, 
 				DatabaseHelper.KEY_UID + " = '" + uid + "'", null, null, null, null);
 		long result = -1;
-		if (cursor != null && cursor.moveToFirst()){
-			Log.v(TAG, "Returning account id");
-			result = cursor.getLong(DatabaseAdapter.COLUMN_ROW_ID);
-
-			cursor.close();
-		}
+		if (cursor != null) {
+            if (cursor.moveToFirst()) {
+                Log.v(TAG, "Returning account id");
+                result = cursor.getLong(DatabaseAdapter.COLUMN_ROW_ID);
+            }
+            cursor.close();
+        }
 		return result;
 	}
 	
@@ -291,12 +292,13 @@ public String getParentAccountUID(String uid){
                 new String[]{uid},
                 null, null, null, null);
 		String result = null;
-		if (cursor != null && cursor.moveToFirst()){
-			Log.d(TAG, "Account already exists. Returning existing id");
-			result = cursor.getString(cursor.getColumnIndexOrThrow(DatabaseHelper.KEY_PARENT_ACCOUNT_UID));
-
-			cursor.close();
-		}
+		if (cursor != null) {
+            if (cursor.moveToFirst()) {
+                Log.d(TAG, "Account already exists. Returning existing id");
+                result = cursor.getString(cursor.getColumnIndexOrThrow(DatabaseHelper.KEY_PARENT_ACCOUNT_UID));
+            }
+            cursor.close();
+        }
 		return result;
 	}
 
@@ -320,10 +322,12 @@ public Account getAccount(long rowId){
 		Account account = null;
 		Log.v(TAG, "Fetching account with id " + rowId);
 		Cursor c =	fetchRecord(DatabaseHelper.ACCOUNTS_TABLE_NAME, rowId);
-		if (c != null && c.moveToFirst()){
-			account = buildAccountInstance(c);	
-			c.close();
-		}
+		if (c != null) {
+            if (c.moveToFirst()) {
+                account = buildAccountInstance(c);
+            }
+            c.close();
+        }
 		return account;
 	}
 		
@@ -348,10 +352,12 @@ public String getAccountUID(long id){
 				new String[]{DatabaseHelper.KEY_ROW_ID, DatabaseHelper.KEY_UID}, 
 				DatabaseHelper.KEY_ROW_ID + "=" + id, 
 				null, null, null, null);
-		if (c != null && c.moveToFirst()){
-			uid = c.getString(c.getColumnIndexOrThrow(DatabaseHelper.KEY_UID));
-			c.close();
-		}
+		if (c != null) {
+            if (c.moveToFirst()) {
+                uid = c.getString(c.getColumnIndexOrThrow(DatabaseHelper.KEY_UID));
+            }
+            c.close();
+        }
 		return uid;
 	}
 
@@ -366,8 +372,10 @@ public String getAccountColorCode(long accountId){
                 new String[]{DatabaseHelper.KEY_ROW_ID, DatabaseHelper.KEY_COLOR_CODE},
                 DatabaseHelper.KEY_ROW_ID + "=" + accountId,
                 null, null, null, null);
-        if (c != null && c.moveToFirst()){
-            colorCode = c.getString(c.getColumnIndexOrThrow(DatabaseHelper.KEY_COLOR_CODE));
+        if (c != null) {
+            if (c.moveToFirst()) {
+                colorCode = c.getString(c.getColumnIndexOrThrow(DatabaseHelper.KEY_COLOR_CODE));
+            }
             c.close();
         }
         return colorCode;
@@ -399,10 +407,12 @@ public AccountType getAccountType(long accountId){
 	public String getName(long accountID) {
 		String name = null;
 		Cursor c = fetchRecord(DatabaseHelper.ACCOUNTS_TABLE_NAME, accountID);
-		if (c != null && c.moveToFirst()){
-			name = c.getString(DatabaseAdapter.COLUMN_NAME);
-			c.close();
-		}
+		if (c != null) {
+            if (c.moveToFirst()) {
+                name = c.getString(DatabaseAdapter.COLUMN_NAME);
+            }
+            c.close();
+        }
 		return name;
 	}
 	
diff --git a/app/src/org/gnucash/android/ui/transaction/TransactionsActivity.java b/app/src/org/gnucash/android/ui/transaction/TransactionsActivity.java
index fa16cd9b..5b33acfa 100644
--- a/app/src/org/gnucash/android/ui/transaction/TransactionsActivity.java
+++ b/app/src/org/gnucash/android/ui/transaction/TransactionsActivity.java
@@ -117,6 +117,11 @@
     private AccountsDbAdapter mAccountsDbAdapter;
 
     /**
+     * Hold the accounts cursor that will be used in the Navigation
+     */
+    private Cursor mAccountsCursor = null;
+
+    /**
      * This is the last known color for the title indicator.
      * This is used to remember the color of the top level account if the child account doesn't have one.
      */
@@ -348,11 +353,14 @@ private void setTitleIndicatorColor() {
 	 */
 	private void setupActionBarNavigation() {
 		// set up spinner adapter for navigation list
-		Cursor accountsCursor = mAccountsDbAdapter.fetchAllRecordsOrderedByFullName();
+        if (mAccountsCursor != null) {
+            mAccountsCursor.close();
+        }
+		mAccountsCursor = mAccountsDbAdapter.fetchAllRecordsOrderedByFullName();
 
         SpinnerAdapter mSpinnerAdapter = new QualifiedAccountNameCursorAdapter(
                 getSupportActionBar().getThemedContext(),
-                R.layout.sherlock_spinner_item, accountsCursor);
+                R.layout.sherlock_spinner_item, mAccountsCursor);
 		((ResourceCursorAdapter) mSpinnerAdapter)
 				.setDropDownViewResource(R.layout.sherlock_spinner_dropdown_item);
 		ActionBar actionBar = getSupportActionBar();
@@ -360,7 +368,7 @@ private void setupActionBarNavigation() {
 		actionBar.setListNavigationCallbacks(mSpinnerAdapter,
 				mTransactionListNavigationListener);
         actionBar.setDisplayHomeAsUpEnabled(true);
-		
+
 		updateNavigationSelection();
 	}
 	
@@ -449,6 +457,7 @@ protected void onActivityResult(int requestCode, int resultCode, Intent data) {
     @Override
 	protected void onDestroy() {
 		super.onDestroy();
+        mAccountsCursor.close();
 		mAccountsDbAdapter.close();
 	}
 	
diff --git a/app/src/org/gnucash/android/util/GnucashAccountXmlHandler.java b/app/src/org/gnucash/android/util/GnucashAccountXmlHandler.java
index d82ed3b9..ed1e129a 100644
--- a/app/src/org/gnucash/android/util/GnucashAccountXmlHandler.java
+++ b/app/src/org/gnucash/android/util/GnucashAccountXmlHandler.java
@@ -202,7 +202,7 @@ public static void parse(Context context, InputStream accountsInputStream){
             GnucashAccountXmlHandler handler = new GnucashAccountXmlHandler(context);
             xr.setContentHandler(handler);
             xr.parse(new InputSource(bos));
-
+            handler.mDatabaseAdapter.close();
         } catch (Exception e) {
             e.printStackTrace();
             Toast.makeText(context, R.string.toast_error_importing_accounts, Toast.LENGTH_LONG).show();

From aa8cb4adc2666aad2b03db21764ee9d31312f720 Mon Sep 17 00:00:00 2001
From: Yongxin Wang <fefe.wyx@gmail.com>
Date: Sat, 10 May 2014 20:05:33 +0800
Subject: [PATCH 12/16] More resource leaks. One zh translation error.

---
 app/res/values-zh/strings.xml                             |  3 +--
 app/src/org/gnucash/android/db/AccountsDbAdapter.java     |  1 +
 app/src/org/gnucash/android/export/ExporterTask.java      |  2 ++
 app/src/org/gnucash/android/export/ofx/OfxExporter.java   |  1 +
 .../gnucash/android/ui/account/AccountFormFragment.java   | 15 +++++++++++++--
 .../android/ui/transaction/TransactionFormFragment.java   |  5 +++++
 6 files changed, 23 insertions(+), 4 deletions(-)

diff --git a/app/res/values-zh/strings.xml b/app/res/values-zh/strings.xml
index b70d4f7f..9dd96f6e 100644
--- a/app/res/values-zh/strings.xml
+++ b/app/res/values-zh/strings.xml
@@ -46,7 +46,7 @@
     <string name="title_edit_transaction"></string>
     <string name="label_transaction_description"></string>
     <string name="menu_move"></string>
-    <string name="title_selected">%1$d </string>
+    <string name="title_selected">%1$d </string>
     <string name="label_transactions_total"></string>
     <string name="label_export_destination"></string>
     <string name="title_export_dialog"></string>
@@ -352,7 +352,6 @@
     <string name="label_default_transfer_account"></string>
     <string name="label_account_color_and_type"></string>
     <plurals name="label_sub_accounts">
-        <item quantity="one">%d </item>
         <item quantity="other">%d </item>
     </plurals>
     <string-array name="account_type_entry_values">
diff --git a/app/src/org/gnucash/android/db/AccountsDbAdapter.java b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
index 6a24938d..db144a07 100644
--- a/app/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/app/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -165,6 +165,7 @@ public boolean destructiveDeleteAccount(long rowId){
 			result &= mTransactionsAdapter.deleteRecord(id);
 		}
 		result &= deleteRecord(DatabaseHelper.ACCOUNTS_TABLE_NAME, rowId);
+        c.close();
 		return result;
 	}
 
diff --git a/app/src/org/gnucash/android/export/ExporterTask.java b/app/src/org/gnucash/android/export/ExporterTask.java
index b322ee67..c8edf194 100644
--- a/app/src/org/gnucash/android/export/ExporterTask.java
+++ b/app/src/org/gnucash/android/export/ExporterTask.java
@@ -169,6 +169,7 @@ protected void onPostExecute(Boolean exportResult) {
             android.support.v4.app.FragmentManager fragmentManager = ((FragmentActivity)mContext).getSupportFragmentManager();
             Fragment currentFragment = fragmentManager
                     .findFragmentByTag(AccountsActivity.FRAGMENT_ACCOUNTS_LIST);
+
             TransactionsDeleteConfirmationDialogFragment alertFragment =
                     TransactionsDeleteConfirmationDialogFragment.newInstance(R.string.title_confirm_delete, 0);
             alertFragment.setTargetFragment(currentFragment, 0);
@@ -218,6 +219,7 @@ private void writeQifExternalStorage(String qif) throws IOException {
         writer.write(qif);
 
         writer.flush();
+        writer.close();
     }
 
     /**
diff --git a/app/src/org/gnucash/android/export/ofx/OfxExporter.java b/app/src/org/gnucash/android/export/ofx/OfxExporter.java
index 878c0c16..029ae6dc 100644
--- a/app/src/org/gnucash/android/export/ofx/OfxExporter.java
+++ b/app/src/org/gnucash/android/export/ofx/OfxExporter.java
@@ -59,6 +59,7 @@ public OfxExporter(Context context, boolean exportAll) {
 		mAccountsList = exportAll ? dbAdapter.getAllAccounts() : dbAdapter.getExportableAccounts();
 		mExportAll = exportAll;
 		mContext = context;
+        dbAdapter.close();
 	}
 
     /**
diff --git a/app/src/org/gnucash/android/ui/account/AccountFormFragment.java b/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
index f8a7aaee..736ac0f5 100644
--- a/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
+++ b/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
@@ -80,6 +80,12 @@
 	 * Accounts database adapter
 	 */
 	private AccountsDbAdapter mAccountsDbAdapter;
+
+    /**
+     * Whether the AccountsDbAdapter is created inside this class.
+     * If so, it should be also closed by this class
+     */
+    private boolean mReleaseDbAdapter = false;
 	
 	/**
 	 * List of all currency codes (ISO 4217) supported by the app
@@ -191,6 +197,7 @@ public AccountFormFragment() {
 	static public AccountFormFragment newInstance(AccountsDbAdapter dbAdapter){
 		AccountFormFragment f = new AccountFormFragment();
 		f.mAccountsDbAdapter = dbAdapter;
+        f.mReleaseDbAdapter = false;
 		return f;
 	}
 	
@@ -199,6 +206,7 @@ public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		setHasOptionsMenu(true);
         if (mAccountsDbAdapter == null){
+            mReleaseDbAdapter = true;
             mAccountsDbAdapter = new AccountsDbAdapter(getSherlockActivity());
         }
 
@@ -660,8 +668,11 @@ public void onDestroy() {
 		super.onDestroyView();
 		if (mParentAccountCursor != null)
 			mParentAccountCursor.close();
-		//do not close the database adapter. We got it from the activity, 
-		//the activity will take care of it.
+        // The mAccountsDbAdapter should only be closed when it is not passed in
+        // by other Activities.
+		if (mReleaseDbAdapter == true && mAccountsDbAdapter != null) {
+            mAccountsDbAdapter.close();
+        }
 	}
 	
 	private void saveAccount() {
diff --git a/app/src/org/gnucash/android/ui/transaction/TransactionFormFragment.java b/app/src/org/gnucash/android/ui/transaction/TransactionFormFragment.java
index 0c02bc20..f777bba6 100644
--- a/app/src/org/gnucash/android/ui/transaction/TransactionFormFragment.java
+++ b/app/src/org/gnucash/android/ui/transaction/TransactionFormFragment.java
@@ -420,6 +420,9 @@ private void updateTransferAccountsList(){
                             + "' AND " + DatabaseHelper.KEY_PLACEHOLDER + " = 0"
                             + ")";
 
+        if (mCursor != null) {
+            mCursor.close();
+        }
 		mCursor = mAccountsDbAdapter.fetchAccountsOrderedByFullName(conditions);
 
         mCursorAdapter = new QualifiedAccountNameCursorAdapter(getActivity(),
@@ -543,6 +546,8 @@ public void onAccountChanged(long newAccountId){
         }
 
 		updateTransferAccountsList();
+
+        accountsDbAdapter.close();
 	}
 	
 	/**

From 9efeaa2028582260682c3ff89bc273ba34403072 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Sat, 10 May 2014 23:14:02 +0200
Subject: [PATCH 13/16] Fixed: Wrong caption for export dialog.

---
 app/res/values-de/strings.xml                        | 2 +-
 app/res/values-el/strings.xml                        | 2 +-
 app/res/values-es-rMX/strings.xml                    | 2 +-
 app/res/values-es/strings.xml                        | 2 +-
 app/res/values-fr/strings.xml                        | 2 +-
 app/res/values-hu/strings.xml                        | 2 +-
 app/res/values-it/strings.xml                        | 2 +-
 app/res/values-nb/strings.xml                        | 2 +-
 app/res/values-nl/strings.xml                        | 2 +-
 app/res/values-pt-rBR/strings.xml                    | 2 +-
 app/res/values-ru/strings.xml                        | 2 +-
 app/res/values-zh/strings.xml                        | 2 +-
 app/res/values/strings.xml                           | 2 +-
 app/src/org/gnucash/android/export/ExporterTask.java | 3 ++-
 14 files changed, 15 insertions(+), 14 deletions(-)

diff --git a/app/res/values-de/strings.xml b/app/res/values-de/strings.xml
index 3856c756..920efe75 100644
--- a/app/res/values-de/strings.xml
+++ b/app/res/values-de/strings.xml
@@ -65,7 +65,6 @@
     <string name="title_move_transactions">%1$d Buchung(en) verschieben</string>
     <string name="label_move_destination">Zielkonto</string>
     <string name="permission_access_sdcard">Zugriff auf SD-Kartenspeicher</string>
-    <string name="title_share_ofx_with">OFX-Datei senden mit</string>
     <string name="toast_incompatible_currency">Buchungen k&#246;nnten nicht verschoben werden.\Die W&#228;hrung des Zielkontos ist inkompatibel</string>
     <string name="header_general_settings">Allgemein</string>
     <string name="header_about_gnucash">&#220;ber GnuCash</string>
@@ -395,4 +394,5 @@
         <item>MONATLICH</item>
     </string-array>
     <string name="title_scheduled_transactions">Eingeplante Buchungen</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-el/strings.xml b/app/res/values-el/strings.xml
index 39a35470..762d8e5a 100644
--- a/app/res/values-el/strings.xml
+++ b/app/res/values-el/strings.xml
@@ -66,7 +66,6 @@
     <string name="title_move_transactions"> %1$d ()</string>
     <string name="label_move_destination"> </string>
     <string name="permission_access_sdcard">  SD</string>
-    <string name="title_share_ofx_with">  OFX &#8230;</string>
     <string name="toast_incompatible_currency"> 	.\n         </string>
     <string name="header_general_settings"></string>
     <string name="header_about_gnucash"></string>
@@ -413,4 +412,5 @@
         <item></item>
     </string-array>
     <string name="title_scheduled_transactions"> </string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-es-rMX/strings.xml b/app/res/values-es-rMX/strings.xml
index 600c4cb8..67f48e75 100644
--- a/app/res/values-es-rMX/strings.xml
+++ b/app/res/values-es-rMX/strings.xml
@@ -66,7 +66,6 @@
     <string name="title_move_transactions">Mover %1$d transaccion(es)</string>
     <string name="label_move_destination">Cuenta destino</string>
     <string name="permission_access_sdcard">Acceder tarjeta SD</string>
-    <string name="title_share_ofx_with">Share OFX export with&#8230;</string>
     <string name="toast_incompatible_currency">No se pueden mover las transacciones.\nLa cuenta destino usa una moneda diferente a la cuenta de origen</string>
     <string name="header_general_settings">General</string>
     <string name="header_about_gnucash">Acerca de</string>
@@ -398,4 +397,5 @@
     </string-array>
     <string name="menu_scheduled_transactions">Scheduled Transactions</string>
     <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-es/strings.xml b/app/res/values-es/strings.xml
index d6c754b9..45c2d80f 100644
--- a/app/res/values-es/strings.xml
+++ b/app/res/values-es/strings.xml
@@ -66,7 +66,6 @@
     <string name="title_move_transactions">Mover %1$d transacci&#243;n(es)</string>
     <string name="label_move_destination">Cuenta Destino</string>
     <string name="permission_access_sdcard">Acceder a la tarjeta SD</string>
-    <string name="title_share_ofx_with">Compartir exportaci&#243;n OFX con&#8230;</string>
     <string name="toast_incompatible_currency">No se pueden mover las transacciones.\nLa cuenta destino utiliza una divisa distinta a la de la cuenta de origen</string>
     <string name="header_general_settings">General</string>
     <string name="header_about_gnucash">Acerca de</string>
@@ -395,4 +394,5 @@
     </string-array>
     <string name="menu_scheduled_transactions">Scheduled Transactions</string>
     <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-fr/strings.xml b/app/res/values-fr/strings.xml
index 088c51a6..725607fd 100644
--- a/app/res/values-fr/strings.xml
+++ b/app/res/values-fr/strings.xml
@@ -66,7 +66,6 @@
     <string name="title_move_transactions">D&#233;placer %1$d transaction(s)</string>
     <string name="label_move_destination">Compte de destination</string>
     <string name="permission_access_sdcard">Acc&#233;s carte SD</string>
-    <string name="title_share_ofx_with">Partager l\'export en OFX avec</string>
     <string name="toast_incompatible_currency">Impossible de d&#233;placer les transactions.\nLe compte de destination utilise une monnaie diff&#233;rente du compte d\'origine</string>
     <string name="header_general_settings">G&#233;n&#233;ral</string>
     <string name="header_about_gnucash"> propos</string>
@@ -395,4 +394,5 @@
     </string-array>
     <string name="menu_scheduled_transactions">Transactions planifies</string>
     <string name="title_scheduled_transactions">Transactions planifies</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
\ No newline at end of file
diff --git a/app/res/values-hu/strings.xml b/app/res/values-hu/strings.xml
index 2205af8c..ea1be410 100644
--- a/app/res/values-hu/strings.xml
+++ b/app/res/values-hu/strings.xml
@@ -65,7 +65,6 @@
     <string name="title_move_transactions">Move %1$d transaction(s)</string>
     <string name="label_move_destination">Destination Account</string>
     <string name="permission_access_sdcard">Access SD Card</string>
-    <string name="title_share_ofx_with">Share OFX export with&#8230;</string>
     <string name="toast_incompatible_currency">Cannot move transactions.\nThe destination account uses a different currency from origin account</string>
     <string name="header_general_settings">General</string>
     <string name="header_about_gnucash">About</string>
@@ -397,4 +396,5 @@
         <item>MONTHLY</item>
     </string-array>
     <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
\ No newline at end of file
diff --git a/app/res/values-it/strings.xml b/app/res/values-it/strings.xml
index 82aa4c51..280cd67b 100644
--- a/app/res/values-it/strings.xml
+++ b/app/res/values-it/strings.xml
@@ -66,7 +66,6 @@
     <string name="title_move_transactions">Sposta %1$d transazioni</string>
     <string name="label_move_destination">Conto di destinazione</string>
     <string name="permission_access_sdcard">Accedi alla scheda SD</string>
-    <string name="title_share_ofx_with">Condividi l\'esportazione OFX con&#8230;</string>
     <string name="toast_incompatible_currency">Impossibile spostare le transazioni.\nIl conto di destinazione ha una valuta diversa dal conto di origine</string>
     <string name="header_general_settings">Generali</string>
     <string name="header_about_gnucash">Informazioni</string>
@@ -399,4 +398,5 @@
     </string-array>
     <string name="menu_scheduled_transactions">Scheduled Transactions</string>
     <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-nb/strings.xml b/app/res/values-nb/strings.xml
index 4db72c56..98cffaff 100644
--- a/app/res/values-nb/strings.xml
+++ b/app/res/values-nb/strings.xml
@@ -67,7 +67,6 @@
     <string name="title_move_transactions">Flytt %1$d transaksjoner</string>
     <string name="label_move_destination">Til konto</string>
     <string name="permission_access_sdcard">Aksesser minnekort</string>
-    <string name="title_share_ofx_with">Del OFX-eksport med&#8230;</string>
     <string name="toast_incompatible_currency">Kan ikke flytte transaksjonen(e).\nMottakerkonto har en annen valuta</string>
     <string name="header_general_settings">Generelt</string>
     <string name="header_about_gnucash">Om</string>
@@ -398,4 +397,5 @@ format og importeres i regnskapsprogrammet GnuCash for PC.</string>
     </string-array>
     <string name="menu_scheduled_transactions">Scheduled Transactions</string>
     <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-nl/strings.xml b/app/res/values-nl/strings.xml
index c8f6b76e..dc7711a5 100644
--- a/app/res/values-nl/strings.xml
+++ b/app/res/values-nl/strings.xml
@@ -66,7 +66,6 @@
     <string name="title_move_transactions">%1$d transactie(s) verplaatsen</string>
     <string name="label_move_destination">Bestemmingsrekening</string>
     <string name="permission_access_sdcard">SD kaart benaderen</string>
-    <string name="title_share_ofx_with">OFX data verzenden via&#8230;</string>
     <string name="toast_incompatible_currency">Transacties kunnen niet verplaatst worden.\nDe munteenheden van de rekeningen zijn niet compatibel</string>
     <string name="header_general_settings">Algemeen</string>
     <string name="header_about_gnucash">Over</string>
@@ -400,4 +399,5 @@
     </string-array>
     <string name="menu_scheduled_transactions">Vaste journaalposten</string>
     <string name="title_scheduled_transactions">Vaste journaalposten</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-pt-rBR/strings.xml b/app/res/values-pt-rBR/strings.xml
index a4e73d03..54b9a1ef 100644
--- a/app/res/values-pt-rBR/strings.xml
+++ b/app/res/values-pt-rBR/strings.xml
@@ -65,7 +65,6 @@
 	  <string name="title_move_transactions">Mover %1$d transao(es)</string>
 	  <string name="label_move_destination">Conta de destino</string>
 	  <string name="permission_access_sdcard">Acessar carto SD</string>
-	  <string name="title_share_ofx_with">Compartilhar OFX exportado com&#8230;</string>
 	  <string name="toast_incompatible_currency">No  possvel mover as transaes. \nA conta de destino usa uma moeda padro diferente da moeda usada pela conta de origem.</string>
 	  <string name="header_general_settings">Geral</string>
 	  <string name="header_about_gnucash">Sobre</string>
@@ -398,4 +397,5 @@
     </string-array>
     <string name="menu_scheduled_transactions">Scheduled Transactions</string>
     <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-ru/strings.xml b/app/res/values-ru/strings.xml
index 531eab1a..023d9fc6 100644
--- a/app/res/values-ru/strings.xml
+++ b/app/res/values-ru/strings.xml
@@ -66,7 +66,6 @@
     <string name="title_move_transactions"> %1$d (,,)</string>
     <string name="label_move_destination">-</string>
     <string name="permission_access_sdcard">   </string>
-    <string name="title_share_ofx_with"> OFX&#8230;</string>
     <string name="toast_incompatible_currency">  .\n-   .</string>
     <string name="header_general_settings"></string>
     <string name="header_about_gnucash"> </string>
@@ -399,4 +398,5 @@
     </string-array>
     <string name="menu_scheduled_transactions">Scheduled Transactions</string>
     <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values-zh/strings.xml b/app/res/values-zh/strings.xml
index b70d4f7f..e1ec099f 100644
--- a/app/res/values-zh/strings.xml
+++ b/app/res/values-zh/strings.xml
@@ -65,7 +65,6 @@
     <string name="title_move_transactions"> %1$d </string>
     <string name="label_move_destination"></string>
     <string name="permission_access_sdcard"> SD Card</string>
-    <string name="title_share_ofx_with">OFX</string>
     <string name="toast_incompatible_currency">\n</string>
     <string name="header_general_settings"></string>
     <string name="header_about_gnucash"></string>
@@ -394,4 +393,5 @@
         <item></item>
     </string-array>
     <string name="title_scheduled_transactions"></string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/res/values/strings.xml b/app/res/values/strings.xml
index a75ee62c..704ef103 100644
--- a/app/res/values/strings.xml
+++ b/app/res/values/strings.xml
@@ -66,7 +66,6 @@
     <string name="title_move_transactions">Move %1$d transaction(s)</string>
     <string name="label_move_destination">Destination Account</string>
     <string name="permission_access_sdcard">Access SD Card</string>
-    <string name="title_share_ofx_with">Share OFX export with&#8230;</string>
     <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">Cannot move transactions.\nThe destination account uses a different currency from origin account</string>
     <string name="header_general_settings">General</string>
@@ -629,4 +628,5 @@
         available in app Settings so you can decide later.
     </string>
     <string name="title_scheduled_transactions">Scheduled Transactions</string>
+    <string name="title_select_export_destination">Select destination for export</string>
 </resources>
diff --git a/app/src/org/gnucash/android/export/ExporterTask.java b/app/src/org/gnucash/android/export/ExporterTask.java
index b322ee67..dcd1b32f 100644
--- a/app/src/org/gnucash/android/export/ExporterTask.java
+++ b/app/src/org/gnucash/android/export/ExporterTask.java
@@ -268,7 +268,8 @@ private void shareFile(String path){
 
         shareIntent.putExtra(Intent.EXTRA_TEXT, mContext.getString(R.string.description_export_email)
                 + " " + formatter.format(new Date(System.currentTimeMillis())));
-        mContext.startActivity(Intent.createChooser(shareIntent, mContext.getString(R.string.title_share_ofx_with)));
+
+        mContext.startActivity(Intent.createChooser(shareIntent, mContext.getString(R.string.title_select_export_destination)));
     }
 
     /**

From 8c95f3b764d406fe79b4f7d89fcf336e73f1913a Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Sat, 10 May 2014 23:42:17 +0200
Subject: [PATCH 14/16] Updated version numbers for next minor release
 (1.3.2-beta2)

---
 CHANGELOG.md            | 3 ++-
 app/AndroidManifest.xml | 2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index a2850321..d00a7e33 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,11 +1,12 @@
 Change Log
 ===============================================================================
-Version 1.3.2 *(2014-03-28)*
+Version 1.3.2 *(2014-05-15)*
 ----------------------------
 * Fixed: Editing account modifies the transaction type of transfer transactions
 * Fixed: Bug causing double entry transactions not to be considered equal
 * Fixed: Computation of account balance did not properly consider double entries
 * Improved: Double-entry accounting is now activated by default
+* Improved: Reliability of account structure import
 * Improved: Restricted parent/child account hierarchies relationships to those defined by GnuCash accounting
 * Improved: Dutch translation
 * Improved: German translation
diff --git a/app/AndroidManifest.xml b/app/AndroidManifest.xml
index 5dbebd33..45184fdb 100644
--- a/app/AndroidManifest.xml
+++ b/app/AndroidManifest.xml
@@ -17,7 +17,7 @@
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="org.gnucash.android"
-    android:versionCode="27"
+    android:versionCode="28"
     android:versionName="@string/app_version_name" >
 
     <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15"/>

From 5827d61e7b13babf0ea39cf3095aa7fecf25e675 Mon Sep 17 00:00:00 2001
From: Yongxin Wang <fefe.wyx@gmail.com>
Date: Sun, 11 May 2014 22:35:58 +0800
Subject: [PATCH 15/16] Refresh after transactions are exported and deleted.

---
 app/src/org/gnucash/android/export/ExporterTask.java                 | 3 +--
 app/src/org/gnucash/android/ui/account/AccountFormFragment.java      | 3 +++
 app/src/org/gnucash/android/ui/account/AccountsActivity.java         | 5 +++++
 .../dialog/TransactionsDeleteConfirmationDialogFragment.java         | 1 +
 4 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/app/src/org/gnucash/android/export/ExporterTask.java b/app/src/org/gnucash/android/export/ExporterTask.java
index 7a60466c..3008e603 100644
--- a/app/src/org/gnucash/android/export/ExporterTask.java
+++ b/app/src/org/gnucash/android/export/ExporterTask.java
@@ -167,8 +167,7 @@ protected void onPostExecute(Boolean exportResult) {
 
         if (mExportParams.shouldDeleteTransactionsAfterExport()){
             android.support.v4.app.FragmentManager fragmentManager = ((FragmentActivity)mContext).getSupportFragmentManager();
-            Fragment currentFragment = fragmentManager
-                    .findFragmentByTag(AccountsActivity.FRAGMENT_ACCOUNTS_LIST);
+            Fragment currentFragment = ((AccountsActivity)mContext).getCurrentAccountListFragment();
 
             TransactionsDeleteConfirmationDialogFragment alertFragment =
                     TransactionsDeleteConfirmationDialogFragment.newInstance(R.string.title_confirm_delete, 0);
diff --git a/app/src/org/gnucash/android/ui/account/AccountFormFragment.java b/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
index 736ac0f5..ea2accc9 100644
--- a/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
+++ b/app/src/org/gnucash/android/ui/account/AccountFormFragment.java
@@ -673,6 +673,9 @@ public void onDestroy() {
 		if (mReleaseDbAdapter == true && mAccountsDbAdapter != null) {
             mAccountsDbAdapter.close();
         }
+        if (mDefaultTransferAccountCursorAdapter != null) {
+            mDefaultTransferAccountCursorAdapter.getCursor().close();
+        }
 	}
 	
 	private void saveAccount() {
diff --git a/app/src/org/gnucash/android/ui/account/AccountsActivity.java b/app/src/org/gnucash/android/ui/account/AccountsActivity.java
index c83147fc..471dcbb2 100644
--- a/app/src/org/gnucash/android/ui/account/AccountsActivity.java
+++ b/app/src/org/gnucash/android/ui/account/AccountsActivity.java
@@ -205,6 +205,11 @@ public int getCount() {
         }
     }
 
+    public AccountsListFragment getCurrentAccountListFragment(){
+        int index = mPager.getCurrentItem();
+        return (AccountsListFragment)(mFragmentPageReferenceMap.get(index));
+    }
+
 
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
diff --git a/app/src/org/gnucash/android/ui/transaction/dialog/TransactionsDeleteConfirmationDialogFragment.java b/app/src/org/gnucash/android/ui/transaction/dialog/TransactionsDeleteConfirmationDialogFragment.java
index e80b184a..4c1d154e 100644
--- a/app/src/org/gnucash/android/ui/transaction/dialog/TransactionsDeleteConfirmationDialogFragment.java
+++ b/app/src/org/gnucash/android/ui/transaction/dialog/TransactionsDeleteConfirmationDialogFragment.java
@@ -62,6 +62,7 @@ public void onClick(DialogInterface dialog, int whichButton) {
                             } else {
                             	adapter.deleteRecord(rowId);
                             }
+                            adapter.close();
                             if (getTargetFragment() instanceof AccountsListFragment){                            	
                             	((AccountsListFragment)getTargetFragment()).refresh();
                             }

From b24e520f55e1469cc6f3d520eff638b225f5f72f Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 23 May 2014 22:58:43 +0200
Subject: [PATCH 16/16] Updated release date in CHANGELOG

---
 CHANGELOG.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index d00a7e33..40122bae 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,6 +1,6 @@
 Change Log
 ===============================================================================
-Version 1.3.2 *(2014-05-15)*
+Version 1.3.2 *(2014-05-23)*
 ----------------------------
 * Fixed: Editing account modifies the transaction type of transfer transactions
 * Fixed: Bug causing double entry transactions not to be considered equal
