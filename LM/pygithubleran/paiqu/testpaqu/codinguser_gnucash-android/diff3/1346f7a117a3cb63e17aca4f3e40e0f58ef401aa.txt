From 1346f7a117a3cb63e17aca4f3e40e0f58ef401aa Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 2 Dec 2015 17:09:56 +0100
Subject: [PATCH] Add progress bar to all activities

Fix breaking tests
TODO: Actually use progress bar to indicate busy
---
 app/build.gradle                                   |  5 +-
 .../gnucash/android/app/GnuCashApplication.java    |  5 +-
 .../org/gnucash/android/db/MigrationHelper.java    |  2 +-
 .../android/db/adapter/SplitsDbAdapter.java        |  2 +-
 .../gnucash/android/importer/GncXmlImporter.java   |  2 +-
 .../android/ui/account/AccountsActivity.java       | 22 +++---
 .../gnucash/android/ui/budget/BudgetsActivity.java | 21 +++---
 .../android/ui/common/BaseDrawerActivity.java      | 80 ++++++++++++++++------
 .../android/ui/report/BaseReportFragment.java      |  6 +-
 .../gnucash/android/ui/report/ReportsActivity.java | 24 +++----
 .../ui/transaction/ScheduledActionsActivity.java   | 16 +++--
 .../ui/transaction/TransactionsActivity.java       | 26 ++++---
 app/src/main/res/layout/activity_accounts.xml      | 10 +--
 app/src/main/res/layout/activity_reports.xml       |  2 +-
 .../main/res/layout/activity_scheduled_events.xml  | 11 +--
 .../res/layout/activity_transaction_detail.xml     |  2 +-
 app/src/main/res/layout/activity_transactions.xml  |  2 +-
 app/src/main/res/layout/toolbar.xml                |  4 +-
 .../res/layout/toolbar_transactions_activity.xml   | 33 ---------
 ...eports_toolbar.xml => toolbar_with_spinner.xml} | 11 ++-
 app/src/main/res/values-af-rZA/strings.xml         |  2 +
 app/src/main/res/values-ar-rSA/strings.xml         |  1 +
 app/src/main/res/values-ca-rES/strings.xml         |  1 +
 app/src/main/res/values-cs-rCZ/strings.xml         |  1 +
 app/src/main/res/values-de/strings.xml             |  1 +
 app/src/main/res/values-el-rGR/strings.xml         |  1 +
 app/src/main/res/values-en-rGB/strings.xml         |  1 +
 app/src/main/res/values-es-rMX/strings.xml         |  1 +
 app/src/main/res/values-es/strings.xml             |  1 +
 app/src/main/res/values-fi-rFI/strings.xml         |  1 +
 app/src/main/res/values-fr/strings.xml             |  1 +
 app/src/main/res/values-hu-rHU/strings.xml         |  1 +
 app/src/main/res/values-it-rIT/strings.xml         |  1 +
 app/src/main/res/values-iw-rIL/strings.xml         |  1 +
 app/src/main/res/values-ja-rJP/strings.xml         |  1 +
 app/src/main/res/values-ko-rKR/strings.xml         |  1 +
 app/src/main/res/values-nb/strings.xml             |  1 +
 app/src/main/res/values-nl-rNL/strings.xml         |  1 +
 app/src/main/res/values-no-rNO/strings.xml         |  1 +
 app/src/main/res/values-pl-rPL/strings.xml         |  1 +
 app/src/main/res/values-pt-rBR/strings.xml         |  1 +
 app/src/main/res/values-pt-rPT/strings.xml         |  1 +
 app/src/main/res/values-pt/strings.xml             |  5 +-
 app/src/main/res/values-ro-rRO/strings.xml         |  1 +
 app/src/main/res/values-ru/strings.xml             |  1 +
 app/src/main/res/values-sr-rSP/strings.xml         |  1 +
 app/src/main/res/values-sv-rSE/strings.xml         |  1 +
 app/src/main/res/values-tr-rTR/strings.xml         |  1 +
 app/src/main/res/values-uk-rUA/strings.xml         |  1 +
 app/src/main/res/values-vi-rVN/strings.xml         |  1 +
 app/src/main/res/values-zh-rCN/strings.xml         |  1 +
 app/src/main/res/values-zh-rTW/strings.xml         |  1 +
 app/src/main/res/values/dimens.xml                 |  1 +
 app/src/main/res/values/strings.xml                |  3 +-
 build.gradle                                       |  2 +-
 55 files changed, 179 insertions(+), 150 deletions(-)
 delete mode 100644 app/src/main/res/layout/toolbar_transactions_activity.xml
 rename app/src/main/res/layout/{reports_toolbar.xml => toolbar_with_spinner.xml} (85%)

diff --git a/app/build.gradle b/app/build.gradle
index ddb9e6e5..3e469977 100644
--- a/app/build.gradle
+++ b/app/build.gradle
@@ -80,7 +80,8 @@ android {
 
     buildTypes {
         release {
-            minifyEnabled false
+            minifyEnabled true
+            shrinkResources true
             proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
             if (project.hasProperty("RELEASE_STORE_FILE")){
                 signingConfig signingConfigs.release
@@ -90,7 +91,7 @@ android {
         }
         debug {
             debuggable true
-//            testCoverageEnabled true
+            testCoverageEnabled true
             signingConfig signingConfigs.debug
         }
     }
diff --git a/app/src/main/java/org/gnucash/android/app/GnuCashApplication.java b/app/src/main/java/org/gnucash/android/app/GnuCashApplication.java
index de297b71..bc04f7f4 100644
--- a/app/src/main/java/org/gnucash/android/app/GnuCashApplication.java
+++ b/app/src/main/java/org/gnucash/android/app/GnuCashApplication.java
@@ -112,8 +112,9 @@ public void onCreate(){
         super.onCreate();
         GnuCashApplication.context = getApplicationContext();
 
-        if (isCrashlyticsEnabled())
-            Fabric.with(this, new Crashlytics());
+        Fabric.with(this, new Crashlytics.Builder().core(
+                new CrashlyticsCore.Builder().disabled(!isCrashlyticsEnabled()).build())
+                .build());
 
         // Set this up once when your application launches
         Config config = new Config("gnucash.uservoice.com");
diff --git a/app/src/main/java/org/gnucash/android/db/MigrationHelper.java b/app/src/main/java/org/gnucash/android/db/MigrationHelper.java
index d9462664..9befedbc 100644
--- a/app/src/main/java/org/gnucash/android/db/MigrationHelper.java
+++ b/app/src/main/java/org/gnucash/android/db/MigrationHelper.java
@@ -1346,7 +1346,7 @@ static int upgradeDbToVersion12(SQLiteDatabase db){
             //// FIXME: 22.11.15 Cannot add a column with non-constant default. Create new structure and migrate whole table
             db.execSQL(" ALTER TABLE " + SplitEntry.TABLE_NAME
                     + " ADD COLUMN " + SplitEntry.COLUMN_RECONCILE_DATE + " timestamp not null default '' ");
-
+            //TODO Update just added reconcile column with the current date
             db.setTransactionSuccessful();
             oldVersion = 12;
         } finally {
diff --git a/app/src/main/java/org/gnucash/android/db/adapter/SplitsDbAdapter.java b/app/src/main/java/org/gnucash/android/db/adapter/SplitsDbAdapter.java
index 5a0f2b6c..55810b1d 100644
--- a/app/src/main/java/org/gnucash/android/db/adapter/SplitsDbAdapter.java
+++ b/app/src/main/java/org/gnucash/android/db/adapter/SplitsDbAdapter.java
@@ -150,7 +150,7 @@ public Split buildModelInstance(@NonNull final Cursor cursor){
         split.setType(TransactionType.valueOf(typeName));
         split.setMemo(memo);
         split.setReconcileState(reconcileState.charAt(0));
-        if (reconcileDate != null)
+        if (reconcileDate != null && !reconcileDate.isEmpty())
             split.setReconcileDate(Timestamp.valueOf(reconcileDate));
 
         return split;
diff --git a/app/src/main/java/org/gnucash/android/importer/GncXmlImporter.java b/app/src/main/java/org/gnucash/android/importer/GncXmlImporter.java
index eb9eea9a..12b4946e 100644
--- a/app/src/main/java/org/gnucash/android/importer/GncXmlImporter.java
+++ b/app/src/main/java/org/gnucash/android/importer/GncXmlImporter.java
@@ -21,7 +21,7 @@
 import android.util.Log;
 
 import org.gnucash.android.app.GnuCashApplication;
-import org.gnucash.android.db.TransactionsDbAdapter;
+import org.gnucash.android.db.adapter.TransactionsDbAdapter;
 import org.gnucash.android.export.Exporter;
 import org.xml.sax.InputSource;
 import org.xml.sax.SAXException;
diff --git a/app/src/main/java/org/gnucash/android/ui/account/AccountsActivity.java b/app/src/main/java/org/gnucash/android/ui/account/AccountsActivity.java
index 176d30fb..69d00d16 100644
--- a/app/src/main/java/org/gnucash/android/ui/account/AccountsActivity.java
+++ b/app/src/main/java/org/gnucash/android/ui/account/AccountsActivity.java
@@ -35,6 +35,7 @@
 import android.os.Build;
 import android.os.Bundle;
 import android.preference.PreferenceManager;
+import android.support.design.widget.AppBarLayout;
 import android.support.design.widget.CoordinatorLayout;
 import android.support.design.widget.FloatingActionButton;
 import android.support.design.widget.Snackbar;
@@ -213,16 +214,19 @@ public AccountsListFragment getCurrentAccountListFragment(){
         return (AccountsListFragment)(mFragmentPageReferenceMap.get(index));
     }
 
+    @Override
+    public int getContentView() {
+        return R.layout.activity_accounts;
+    }
 
-	@Override
+    @Override
+    public int getTitleRes() {
+        return R.string.title_accounts;
+    }
+
+    @Override
 	public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        setContentView(R.layout.activity_accounts);
-        setUpDrawer();
-        ButterKnife.bind(this);
-
-        Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);
-        setSupportActionBar(toolbar);
 
         final Intent intent = getIntent();
         handleOpenFileIntent(intent);
@@ -490,10 +494,10 @@ public void onTaskComplete() {
 
     /**
      * Starts Intent chooser for selecting a GnuCash accounts file to import.
-     * <p>The {@code activity} is responsible for the actual import of the file and can do so by calling {@link #importXmlFileFromIntent(Activity, Intent)}<br>
+     * <p>The {@code activity} is responsible for the actual import of the file and can do so by calling {@link #importXmlFileFromIntent(Activity, Intent, TaskDelegate)}<br>
      * The calling class should respond to the request code {@link AccountsActivity#REQUEST_PICK_ACCOUNTS_FILE} in its {@link #onActivityResult(int, int, Intent)} method</p>
      * @param activity Activity starting the request and will also handle the response
-     * @see #importXmlFileFromIntent(Activity, Intent)
+     * @see #importXmlFileFromIntent(Activity, Intent, TaskDelegate)
      */
     public static void startXmlFileChooser(Activity activity) {
         Intent pickIntent = new Intent(Intent.ACTION_GET_CONTENT);
diff --git a/app/src/main/java/org/gnucash/android/ui/budget/BudgetsActivity.java b/app/src/main/java/org/gnucash/android/ui/budget/BudgetsActivity.java
index 7edd4110..ca4fa4da 100644
--- a/app/src/main/java/org/gnucash/android/ui/budget/BudgetsActivity.java
+++ b/app/src/main/java/org/gnucash/android/ui/budget/BudgetsActivity.java
@@ -39,19 +39,18 @@
     public static final int REQUEST_CREATE_BUDGET = 0xA;
 
     @Override
-    protected void onCreate(Bundle savedInstanceState) {
-        super.onCreate(savedInstanceState);
-        setContentView(R.layout.activity_budgets);
-        setUpDrawer();
-        ButterKnife.bind(this);
+    public int getContentView() {
+        return R.layout.activity_budgets;
+    }
 
-        Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);
-        setSupportActionBar(toolbar);
+    @Override
+    public int getTitleRes() {
+        return R.string.title_budgets;
+    }
 
-        final ActionBar actionBar = getSupportActionBar();
-        assert actionBar != null;
-        actionBar.setTitle("Budgets");
-        actionBar.setDisplayHomeAsUpEnabled(true);
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
 
         if (savedInstanceState == null) {
             FragmentManager fragmentManager = getSupportFragmentManager();
diff --git a/app/src/main/java/org/gnucash/android/ui/common/BaseDrawerActivity.java b/app/src/main/java/org/gnucash/android/ui/common/BaseDrawerActivity.java
index 47d386bf..1e90f7f5 100644
--- a/app/src/main/java/org/gnucash/android/ui/common/BaseDrawerActivity.java
+++ b/app/src/main/java/org/gnucash/android/ui/common/BaseDrawerActivity.java
@@ -21,12 +21,17 @@
 import android.content.res.Configuration;
 import android.os.Bundle;
 import android.preference.PreferenceManager;
+import android.support.annotation.LayoutRes;
+import android.support.annotation.StringRes;
+import android.support.design.widget.AppBarLayout;
 import android.support.design.widget.NavigationView;
 import android.support.v4.widget.DrawerLayout;
 import android.support.v7.app.ActionBar;
 import android.support.v7.app.ActionBarDrawerToggle;
+import android.support.v7.widget.Toolbar;
 import android.view.MenuItem;
 import android.view.View;
+import android.widget.ProgressBar;
 
 import com.uservoice.uservoicesdk.UserVoice;
 
@@ -38,24 +43,37 @@
 import org.gnucash.android.ui.settings.SettingsActivity;
 import org.gnucash.android.ui.transaction.ScheduledActionsActivity;
 
+import butterknife.Bind;
+import butterknife.ButterKnife;
+
 
 /**
  * Base activity implementing the navigation drawer, to be extended by all activities requiring one.
+ * <p>
+ *     Each activity inheriting from this class has an indeterminate progress bar at the top,
+ *     (above the action bar) which can be used to display busy operations. See {@link #getProgressBar()}
+ * </p>
  *
- * All subclasses should call the {@link #setUpDrawer()} method in {@link #onCreate(Bundle)},
- * after the activity layout has been set.
- *
+ * <p>Sub-classes should simply provide their layout using {@link #getContentView()} and then annotate
+ * any variables they wish to use with {@link ButterKnife#bind(Activity)} annotations. The view
+ * binding will be done in this base abstract class.<br>
  * The activity layout of the subclass is expected to contain {@code DrawerLayout} and
- * a {@code NavigationView}.
- *
+ * a {@code NavigationView}.<br>
+ * Sub-class should also consider using the {@code toolbar.xml} or {@code toolbar_with_spinner.xml}
+ * for the action bar in their XML layout. Otherwise provide another which contains widgets for the
+ * toolbar and progress indicator with the IDs {@code R.id.toolbar} and {@code R.id.progress_indicator} respectively.
+ * </p>
  * @author Ngewi Fet <ngewif@gmail.com>
  */
-public class BaseDrawerActivity extends PasscodeLockActivity {
-    protected DrawerLayout  mDrawerLayout;
-    protected NavigationView mNavigationView;
+public abstract class BaseDrawerActivity extends PasscodeLockActivity {
+    @Bind(R.id.drawer_layout) DrawerLayout mDrawerLayout;
+    @Bind(R.id.nav_view) NavigationView mNavigationView;
+    @Bind(R.id.toolbar) Toolbar mToolbar;
+    @Bind(R.id.toolbar_progress) ProgressBar mToolbarProgress;
 
     protected ActionBarDrawerToggle mDrawerToggle;
 
+
     private class DrawerItemClickListener implements NavigationView.OnNavigationItemSelectedListener {
 
         @Override
@@ -69,26 +87,48 @@ public boolean onNavigationItemSelected(MenuItem menuItem) {
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-    }
+        setContentView(getContentView());
 
-    /**
-     * Sets up the navigation drawer for this activity.
-     *
-     * This should be called from the activity's
-     * {@link Activity#onCreate(Bundle)} method after calling
-     * {@link Activity#setContentView(int)}.
-     *
-     */
-    protected void setUpDrawer() {
+        ButterKnife.bind(this);
+        setSupportActionBar(mToolbar);
         final ActionBar actionBar = getSupportActionBar();
         if (actionBar != null){
             actionBar.setHomeButtonEnabled(true);
             actionBar.setDisplayHomeAsUpEnabled(true);
+            actionBar.setTitle(getTitleRes());
         }
 
-        mDrawerLayout   = (DrawerLayout) findViewById(R.id.drawer_layout);
-        mNavigationView = (NavigationView) findViewById(R.id.nav_view);
+        setUpNavigationDrawer();
+    }
+
+    /**
+     * Return the layout to inflate for this activity
+     * @return Layout resource identifier
+     */
+    public abstract @LayoutRes int getContentView();
+
+    /**
+     * Return the title for this activity.
+     * This will be displayed in the action bar
+     * @return String resource identifier
+     */
+    public abstract @StringRes int getTitleRes();
 
+    /**
+     * Returns the progress bar for the activity.
+     * <p>This progress bar is displayed above the toolbar and should be used to show busy status
+     * for long operations.<br/>
+     * The progress bar visibility is set to {@link View#GONE} by default. Make visible to use </p>
+     * @return Indeterminate progress bar.
+     */
+    public ProgressBar getProgressBar(){
+        return mToolbarProgress;
+    }
+
+    /**
+     * Sets up the navigation drawer for this activity.
+     */
+    private void setUpNavigationDrawer() {
         mNavigationView.setNavigationItemSelectedListener(new DrawerItemClickListener());
 
         mDrawerToggle = new ActionBarDrawerToggle(
diff --git a/app/src/main/java/org/gnucash/android/ui/report/BaseReportFragment.java b/app/src/main/java/org/gnucash/android/ui/report/BaseReportFragment.java
index 9399e325..5eae669b 100644
--- a/app/src/main/java/org/gnucash/android/ui/report/BaseReportFragment.java
+++ b/app/src/main/java/org/gnucash/android/ui/report/BaseReportFragment.java
@@ -276,12 +276,10 @@ public void refresh() {
             mReportGenerator.cancel(true);
 
         mReportGenerator = new AsyncTask<Void, Void, Void>() {
-            ProgressBar progressBar;
 
             @Override
             protected void onPreExecute() {
-                progressBar = (ProgressBar) getActivity().findViewById(R.id.progress_indicator);
-                progressBar.setVisibility(View.VISIBLE);
+                mReportsActivity.getProgressBar().setVisibility(View.VISIBLE);
             }
 
             @Override
@@ -293,7 +291,7 @@ protected Void doInBackground(Void... params) {
             @Override
             protected void onPostExecute(Void aVoid) {
                 displayReport();
-                progressBar.setVisibility(View.GONE);
+                mReportsActivity.getProgressBar().setVisibility(View.GONE);
             }
         };
         mReportGenerator.execute();
diff --git a/app/src/main/java/org/gnucash/android/ui/report/ReportsActivity.java b/app/src/main/java/org/gnucash/android/ui/report/ReportsActivity.java
index 61ce3228..90212622 100644
--- a/app/src/main/java/org/gnucash/android/ui/report/ReportsActivity.java
+++ b/app/src/main/java/org/gnucash/android/ui/report/ReportsActivity.java
@@ -77,7 +77,7 @@
 
     @Bind(R.id.time_range_spinner) Spinner mTimeRangeSpinner;
     @Bind(R.id.report_account_type_spinner) Spinner mAccountTypeSpinner;
-    @Bind(R.id.report_type_spinner) Spinner mReportTypeSpinner;
+    @Bind(R.id.toolbar_spinner) Spinner mReportTypeSpinner;
 
     private TransactionsDbAdapter mTransactionsDbAdapter;
     private AccountType mAccountType = AccountType.EXPENSE;
@@ -112,23 +112,21 @@ public void onNothingSelected(AdapterView<?> parent) {
     };
 
     @Override
-    protected void onCreate(Bundle savedInstanceState) {
-        super.onCreate(savedInstanceState);
-        setContentView(R.layout.activity_reports);
-        setUpDrawer();
-        ButterKnife.bind(this);
+    public int getContentView() {
+        return R.layout.activity_reports;
+    }
 
-        Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);
-        setSupportActionBar(toolbar);
+    @Override
+    public int getTitleRes() {
+        return R.string.title_reports;
+    }
 
-        ActionBar actionBar = getSupportActionBar();
-        assert actionBar != null;
-        actionBar.setTitle(R.string.title_reports);
-        actionBar.setDisplayHomeAsUpEnabled(true);
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
 
         mTransactionsDbAdapter = TransactionsDbAdapter.getInstance();
 
-
         ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this, R.array.report_time_range,
                 android.R.layout.simple_spinner_item);
         adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
diff --git a/app/src/main/java/org/gnucash/android/ui/transaction/ScheduledActionsActivity.java b/app/src/main/java/org/gnucash/android/ui/transaction/ScheduledActionsActivity.java
index 594228dc..87af8636 100644
--- a/app/src/main/java/org/gnucash/android/ui/transaction/ScheduledActionsActivity.java
+++ b/app/src/main/java/org/gnucash/android/ui/transaction/ScheduledActionsActivity.java
@@ -40,14 +40,18 @@
     ViewPager mViewPager;
 
     @Override
+    public int getContentView() {
+        return R.layout.activity_scheduled_events;
+    }
+
+    @Override
+    public int getTitleRes() {
+        return R.string.nav_menu_scheduled_actions;
+    }
+
+    @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        setContentView(R.layout.activity_scheduled_events);
-        setUpDrawer();
-
-        Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);
-        setSupportActionBar(toolbar);
-        getSupportActionBar().setTitle(R.string.nav_menu_scheduled_actions);
 
         TabLayout tabLayout = (TabLayout) findViewById(R.id.tab_layout);
         tabLayout.addTab(tabLayout.newTab().setText(R.string.title_scheduled_transactions));
diff --git a/app/src/main/java/org/gnucash/android/ui/transaction/TransactionsActivity.java b/app/src/main/java/org/gnucash/android/ui/transaction/TransactionsActivity.java
index c5dd7ab3..fa353fb3 100644
--- a/app/src/main/java/org/gnucash/android/ui/transaction/TransactionsActivity.java
+++ b/app/src/main/java/org/gnucash/android/ui/transaction/TransactionsActivity.java
@@ -25,6 +25,7 @@
 import android.os.Build;
 import android.os.Bundle;
 import android.support.annotation.NonNull;
+import android.support.design.widget.AppBarLayout;
 import android.support.design.widget.FloatingActionButton;
 import android.support.design.widget.TabLayout;
 import android.support.v4.app.Fragment;
@@ -64,7 +65,6 @@
 import org.joda.time.LocalDate;
 
 import java.math.BigDecimal;
-import java.text.DateFormat;
 import java.text.SimpleDateFormat;
 import java.util.Date;
 
@@ -114,9 +114,9 @@
      */
     private Cursor mAccountsCursor = null;
 
-    @Bind(R.id.pager) ViewPager mViewPager;
-    @Bind(R.id.spinner_toolbar) Spinner mToolbarSpinner;
-    @Bind(R.id.tab_layout) TabLayout mTabLayout;
+    @Bind(R.id.pager)            ViewPager mViewPager;
+    @Bind(R.id.toolbar_spinner)  Spinner mToolbarSpinner;
+    @Bind(R.id.tab_layout)       TabLayout mTabLayout;
     @Bind(R.id.transactions_sum) TextView mSumTextView;
     @Bind(R.id.fab_create_transaction) FloatingActionButton mCreateFloatingButton;
 
@@ -273,18 +273,22 @@ public void refresh(){
         setTitleIndicatorColor();
     }
 
-	@Override
+    @Override
+    public int getContentView() {
+        return R.layout.activity_transactions;
+    }
+
+    @Override
+    public int getTitleRes() {
+        return R.string.title_transactions;
+    }
+
+    @Override
 	protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        setContentView(R.layout.activity_transactions);
-        setUpDrawer();
 
-        Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);
-        setSupportActionBar(toolbar);
         getSupportActionBar().setDisplayShowTitleEnabled(false);
 
-        ButterKnife.bind(this);
-
 		mAccountUID = getIntent().getStringExtra(UxArgument.SELECTED_ACCOUNT_UID);
         mAccountsDbAdapter = AccountsDbAdapter.getInstance();
 
diff --git a/app/src/main/res/layout/activity_accounts.xml b/app/src/main/res/layout/activity_accounts.xml
index 96bd30ba..20ea2521 100644
--- a/app/src/main/res/layout/activity_accounts.xml
+++ b/app/src/main/res/layout/activity_accounts.xml
@@ -32,15 +32,7 @@
                   android:layout_width="match_parent"
                   android:layout_height="wrap_content">
 
-        <android.support.v7.widget.Toolbar
-            android:id="@+id/toolbar"
-            android:background="?attr/colorPrimary"
-            android:layout_width="match_parent"
-            android:layout_height="?attr/actionBarSize"
-            app:elevation="0dp"
-            app:layout_scrollFlags="scroll|enterAlways"
-            android:theme="@style/ThemeOverlay.AppCompat.Dark.ActionBar"
-            app:popupTheme="@style/ThemeOverlay.AppCompat.Light" />
+        <include layout="@layout/toolbar" />
 
         <android.support.design.widget.TabLayout
             android:id="@+id/tab_layout"
diff --git a/app/src/main/res/layout/activity_reports.xml b/app/src/main/res/layout/activity_reports.xml
index 32cb53d5..628c334f 100644
--- a/app/src/main/res/layout/activity_reports.xml
+++ b/app/src/main/res/layout/activity_reports.xml
@@ -37,7 +37,7 @@
                 android:gravity="center_vertical">
 
                 <include android:id="@+id/toolbar_layout"
-                    layout="@layout/reports_toolbar" />
+                    layout="@layout/toolbar_with_spinner" />
 
                 <FrameLayout android:id="@+id/fragment_container"
                     android:orientation="vertical"
diff --git a/app/src/main/res/layout/activity_scheduled_events.xml b/app/src/main/res/layout/activity_scheduled_events.xml
index 6c7c3db6..5e202e52 100644
--- a/app/src/main/res/layout/activity_scheduled_events.xml
+++ b/app/src/main/res/layout/activity_scheduled_events.xml
@@ -32,16 +32,7 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content">
 
-            <android.support.v7.widget.Toolbar
-                android:id="@+id/toolbar"
-                android:background="?attr/colorPrimary"
-                android:layout_width="match_parent"
-                android:layout_height="?attr/actionBarSize"
-                app:elevation="0dp"
-                app:layout_scrollFlags="scroll|enterAlways"
-                android:theme="@style/ThemeOverlay.AppCompat.Dark.ActionBar"
-                app:popupTheme="@style/ThemeOverlay.AppCompat.Light" />
-
+            <include layout="@layout/toolbar" />
             <android.support.design.widget.TabLayout
                 android:id="@+id/tab_layout"
                 android:layout_width="match_parent"
diff --git a/app/src/main/res/layout/activity_transaction_detail.xml b/app/src/main/res/layout/activity_transaction_detail.xml
index f04f239a..9a8f3b8f 100644
--- a/app/src/main/res/layout/activity_transaction_detail.xml
+++ b/app/src/main/res/layout/activity_transaction_detail.xml
@@ -26,7 +26,7 @@
         android:id="@+id/fab_edit_transaction"
         android:layout_height="40dp"
         android:layout_width="40dp"
-        app:layout_anchor="@id/toolbar"
+        app:layout_anchor="@+id/toolbar"
         app:layout_anchorGravity="bottom|left|start"
         android:layout_marginLeft="8dp"
         android:scaleType="center"
diff --git a/app/src/main/res/layout/activity_transactions.xml b/app/src/main/res/layout/activity_transactions.xml
index 4893f3a8..9127d481 100644
--- a/app/src/main/res/layout/activity_transactions.xml
+++ b/app/src/main/res/layout/activity_transactions.xml
@@ -33,7 +33,7 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content">
 
-            <include layout="@layout/toolbar_transactions_activity" />
+            <include layout="@layout/toolbar_with_spinner" />
 
             <android.support.design.widget.TabLayout
                 android:id="@+id/tab_layout"
diff --git a/app/src/main/res/layout/toolbar.xml b/app/src/main/res/layout/toolbar.xml
index e755d5cc..35aa3610 100644
--- a/app/src/main/res/layout/toolbar.xml
+++ b/app/src/main/res/layout/toolbar.xml
@@ -21,9 +21,9 @@
     android:layout_width="match_parent"
     android:layout_height="wrap_content">
 
-    <ProgressBar android:id="@+id/progress_indicator"
+    <ProgressBar android:id="@+id/toolbar_progress"
         android:layout_width="match_parent"
-        android:layout_height="5dp"
+        android:layout_height="@dimen/toolbar_progress_height"
         style="?android:attr/progressBarStyleHorizontal"
         android:indeterminate="true"
         android:visibility="visible"/>
diff --git a/app/src/main/res/layout/toolbar_transactions_activity.xml b/app/src/main/res/layout/toolbar_transactions_activity.xml
deleted file mode 100644
index 2f6d7745..00000000
--- a/app/src/main/res/layout/toolbar_transactions_activity.xml
+++ /dev/null
@@ -1,33 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
- Copyright (c) 2015 Ngewi Fet <ngewif@gmail.com>
-
- Licensed under the Apache License, Version 2.0 (the "License");
- you may not use this file except in compliance with the License.
- You may obtain a copy of the License at
-
-    http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-<android.support.v7.widget.Toolbar
-    xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:app="http://schemas.android.com/apk/res-auto"
-    android:id="@+id/toolbar"
-    android:background="?attr/colorPrimary"
-    android:layout_width="match_parent"
-    app:elevation="10dp"
-    app:layout_scrollFlags="scroll|enterAlways"
-    android:theme="@style/ThemeOverlay.AppCompat.Dark.ActionBar"
-    app:popupTheme="@style/ThemeOverlay.AppCompat.Light"
-    android:layout_height="?attr/actionBarSize">
-    <Spinner
-        android:id="@+id/spinner_toolbar"
-        android:layout_width="wrap_content"
-        android:layout_height="wrap_content"
-        app:popupTheme="@style/ThemeOverlay.AppCompat.Light"/>
-</android.support.v7.widget.Toolbar>
\ No newline at end of file
diff --git a/app/src/main/res/layout/reports_toolbar.xml b/app/src/main/res/layout/toolbar_with_spinner.xml
similarity index 85%
rename from app/src/main/res/layout/reports_toolbar.xml
rename to app/src/main/res/layout/toolbar_with_spinner.xml
index 594e0007..3911fed8 100644
--- a/app/src/main/res/layout/reports_toolbar.xml
+++ b/app/src/main/res/layout/toolbar_with_spinner.xml
@@ -20,12 +20,12 @@
     android:layout_width="match_parent"
     android:layout_height="wrap_content">
 
-    <ProgressBar android:id="@+id/progress_indicator"
+    <ProgressBar android:id="@+id/toolbar_progress"
         android:layout_width="match_parent"
-        android:layout_height="5dp"
+        android:layout_height="@dimen/toolbar_progress_height"
         style="?android:attr/progressBarStyleHorizontal"
         android:indeterminate="true"
-        android:visibility="visible"/>
+        android:visibility="gone"/>
 
     <android.support.v7.widget.Toolbar
         android:id="@+id/toolbar"
@@ -33,14 +33,13 @@
         android:layout_width="match_parent"
         android:layout_height="?attr/actionBarSize"
         app:elevation="10dp"
-        app:layout_scrollFlags="enterAlways"
+        app:layout_scrollFlags="scroll|enterAlways"
         android:theme="@style/ThemeOverlay.AppCompat.Dark.ActionBar"
         app:popupTheme="@style/ThemeOverlay.AppCompat.Light"
         tools:showIn="@layout/activity_form">
-        <Spinner android:id="@+id/report_type_spinner"
+        <Spinner android:id="@+id/toolbar_spinner"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
-            android:visibility="gone"
             app:popupTheme="@style/ThemeOverlay.AppCompat.Light"/>
     </android.support.v7.widget.Toolbar>
 </FrameLayout>
\ No newline at end of file
diff --git a/app/src/main/res/values-af-rZA/strings.xml b/app/src/main/res/values-af-rZA/strings.xml
index fb29721c..9e5deb39 100644
--- a/app/src/main/res/values-af-rZA/strings.xml
+++ b/app/src/main/res/values-af-rZA/strings.xml
@@ -64,6 +64,7 @@
     <item>SD Card</item>
     <item>DropBox</item>
     <item>Google Drive</item>
+    <item>Owncloud</item>
     <item>Send to&#8230;</item>
   </string-array>
   <string name="btn_move">Move</string>
@@ -387,6 +388,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-ar-rSA/strings.xml b/app/src/main/res/values-ar-rSA/strings.xml
index 83c0b643..3289e894 100644
--- a/app/src/main/res/values-ar-rSA/strings.xml
+++ b/app/src/main/res/values-ar-rSA/strings.xml
@@ -407,6 +407,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-ca-rES/strings.xml b/app/src/main/res/values-ca-rES/strings.xml
index f0bf139e..4e1034c6 100644
--- a/app/src/main/res/values-ca-rES/strings.xml
+++ b/app/src/main/res/values-ca-rES/strings.xml
@@ -387,6 +387,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Mes actual</item>
     <item>ltims 3 mesos</item>
diff --git a/app/src/main/res/values-cs-rCZ/strings.xml b/app/src/main/res/values-cs-rCZ/strings.xml
index 628d40d9..25849555 100644
--- a/app/src/main/res/values-cs-rCZ/strings.xml
+++ b/app/src/main/res/values-cs-rCZ/strings.xml
@@ -392,6 +392,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-de/strings.xml b/app/src/main/res/values-de/strings.xml
index d2a8e8de..77782e97 100644
--- a/app/src/main/res/values-de/strings.xml
+++ b/app/src/main/res/values-de/strings.xml
@@ -384,6 +384,7 @@ No user-identifiable information will be collected as part of this process!</str
   <string name="menu_duplicate_transaction">Kopieren</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Aktueller Monat</item>
     <item>Letzte 3 Monate</item>
diff --git a/app/src/main/res/values-el-rGR/strings.xml b/app/src/main/res/values-el-rGR/strings.xml
index bcc1fac1..4722dc37 100644
--- a/app/src/main/res/values-el-rGR/strings.xml
+++ b/app/src/main/res/values-el-rGR/strings.xml
@@ -398,6 +398,7 @@ No user-identifiable information will be collected as part of this process!
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-en-rGB/strings.xml b/app/src/main/res/values-en-rGB/strings.xml
index 4a500736..833100e2 100644
--- a/app/src/main/res/values-en-rGB/strings.xml
+++ b/app/src/main/res/values-en-rGB/strings.xml
@@ -387,6 +387,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-es-rMX/strings.xml b/app/src/main/res/values-es-rMX/strings.xml
index 7f2430b6..4f872564 100644
--- a/app/src/main/res/values-es-rMX/strings.xml
+++ b/app/src/main/res/values-es-rMX/strings.xml
@@ -384,6 +384,7 @@ Este proceso solo recoge informacin que no permite identificar al usuario</str
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Mes actual</item>
     <item>ltimos 3 meses</item>
diff --git a/app/src/main/res/values-es/strings.xml b/app/src/main/res/values-es/strings.xml
index e62f74b4..a7d83913 100644
--- a/app/src/main/res/values-es/strings.xml
+++ b/app/src/main/res/values-es/strings.xml
@@ -384,6 +384,7 @@ Este proceso solo recoge informacin que no permite identificar al usuario</str
   <string name="menu_duplicate_transaction">Duplicar</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Mes actual</item>
     <item>ltimos 3 meses</item>
diff --git a/app/src/main/res/values-fi-rFI/strings.xml b/app/src/main/res/values-fi-rFI/strings.xml
index fb29721c..be04b6ec 100644
--- a/app/src/main/res/values-fi-rFI/strings.xml
+++ b/app/src/main/res/values-fi-rFI/strings.xml
@@ -387,6 +387,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-fr/strings.xml b/app/src/main/res/values-fr/strings.xml
index 186a9e0d..0fa6d660 100644
--- a/app/src/main/res/values-fr/strings.xml
+++ b/app/src/main/res/values-fr/strings.xml
@@ -384,6 +384,7 @@ Aucune information permettant d\'identifier l\'utilisateur ne sera recueillis da
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Mois actuel</item>
     <item>3 derniers mois</item>
diff --git a/app/src/main/res/values-hu-rHU/strings.xml b/app/src/main/res/values-hu-rHU/strings.xml
index a0432fba..85d26ee6 100644
--- a/app/src/main/res/values-hu-rHU/strings.xml
+++ b/app/src/main/res/values-hu-rHU/strings.xml
@@ -389,6 +389,7 @@ No user-identifiable information will be collected as part of this process!
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-it-rIT/strings.xml b/app/src/main/res/values-it-rIT/strings.xml
index 8c1b1f07..9bab2381 100644
--- a/app/src/main/res/values-it-rIT/strings.xml
+++ b/app/src/main/res/values-it-rIT/strings.xml
@@ -388,6 +388,7 @@ No user-identifiable information will be collected as part of this process!
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Mese corrente</item>
     <item>Ultimi 3 mesi</item>
diff --git a/app/src/main/res/values-iw-rIL/strings.xml b/app/src/main/res/values-iw-rIL/strings.xml
index fb29721c..be04b6ec 100644
--- a/app/src/main/res/values-iw-rIL/strings.xml
+++ b/app/src/main/res/values-iw-rIL/strings.xml
@@ -387,6 +387,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-ja-rJP/strings.xml b/app/src/main/res/values-ja-rJP/strings.xml
index fc5c2b74..2c4d6809 100644
--- a/app/src/main/res/values-ja-rJP/strings.xml
+++ b/app/src/main/res/values-ja-rJP/strings.xml
@@ -382,6 +382,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-ko-rKR/strings.xml b/app/src/main/res/values-ko-rKR/strings.xml
index b60fa85a..3e5caf59 100644
--- a/app/src/main/res/values-ko-rKR/strings.xml
+++ b/app/src/main/res/values-ko-rKR/strings.xml
@@ -382,6 +382,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-nb/strings.xml b/app/src/main/res/values-nb/strings.xml
index b32573bd..056fdddd 100644
--- a/app/src/main/res/values-nb/strings.xml
+++ b/app/src/main/res/values-nb/strings.xml
@@ -377,6 +377,7 @@
   <string name="menu_move_transaction">Move...</string>
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Gjeldende mned</item>
     <item>Siste 3 mneder</item>
diff --git a/app/src/main/res/values-nl-rNL/strings.xml b/app/src/main/res/values-nl-rNL/strings.xml
index 0e54fdec..f5cc4a3f 100644
--- a/app/src/main/res/values-nl-rNL/strings.xml
+++ b/app/src/main/res/values-nl-rNL/strings.xml
@@ -388,6 +388,7 @@ No user-identifiable information will be collected as part of this process!
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Huidige maand</item>
     <item>Afgelopen 3 maanden</item>
diff --git a/app/src/main/res/values-no-rNO/strings.xml b/app/src/main/res/values-no-rNO/strings.xml
index e8842bdf..f04c288e 100644
--- a/app/src/main/res/values-no-rNO/strings.xml
+++ b/app/src/main/res/values-no-rNO/strings.xml
@@ -378,6 +378,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Gjeldende mned</item>
     <item>Siste 3 mneder</item>
diff --git a/app/src/main/res/values-pl-rPL/strings.xml b/app/src/main/res/values-pl-rPL/strings.xml
index 3b1a0e77..64236ed2 100644
--- a/app/src/main/res/values-pl-rPL/strings.xml
+++ b/app/src/main/res/values-pl-rPL/strings.xml
@@ -385,6 +385,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Biecy miesic</item>
     <item>Ostatnie 3 miesice</item>
diff --git a/app/src/main/res/values-pt-rBR/strings.xml b/app/src/main/res/values-pt-rBR/strings.xml
index 121db8ac..d315f02a 100644
--- a/app/src/main/res/values-pt-rBR/strings.xml
+++ b/app/src/main/res/values-pt-rBR/strings.xml
@@ -382,6 +382,7 @@ Neste processo no sero recolhidas informaes do utilizador!</string>
   <string name="menu_duplicate_transaction">Duplicar</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Ms atual</item>
     <item>Last 3 meses</item>
diff --git a/app/src/main/res/values-pt-rPT/strings.xml b/app/src/main/res/values-pt-rPT/strings.xml
index ee7cd6f1..27fbf395 100644
--- a/app/src/main/res/values-pt-rPT/strings.xml
+++ b/app/src/main/res/values-pt-rPT/strings.xml
@@ -382,6 +382,7 @@ Neste processo no sero recolhidas informaes do utilizador!</string>
   <string name="menu_duplicate_transaction">Duplicar</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Ms actual</item>
     <item>ltimos 3 meses</item>
diff --git a/app/src/main/res/values-pt/strings.xml b/app/src/main/res/values-pt/strings.xml
index c2d382bf..1cf82dba 100644
--- a/app/src/main/res/values-pt/strings.xml
+++ b/app/src/main/res/values-pt/strings.xml
@@ -376,10 +376,6 @@
     </string-array>
     <!-- Default title for color picker dialog [CHAR LIMIT=30] -->
     <string name="color_picker_default_title">Escolha uma c&#244;r</string>
-    <!-- Content description for a color square. -->
-    <string name="color_swatch_description" translatable="false">C&#244;r <xliff:g id="color_index" example="14">%1$d</xliff:g></string>
-    <!-- Content description for a selected color square. -->
-    <string name="color_swatch_description_selected" translatable="false">C&#244;r <xliff:g id="color_index" example="14">%1$d</xliff:g> selected</string>
     <string name="label_account_color_and_type">C&#244;r da Conta &amp; Tipo</string>
     <string name="label_delete_sub_accounts">Apagar sub-contas</string>
     <string name="title_recent_accounts">Recentes</string>
@@ -503,4 +499,5 @@ Neste processo n&#227;o ser&#227;o recolhidas informa&#231;&#245;es do utilizado
     <string name="title_create_export_schedule">Criar uma exporta&#231;&#227;o agendada</string>
     <string name="toast_exported_to">Exportado para : %1$s</string>
     <string name="title_cash_flow_report">Cash Flow</string>
+    <string name="title_budgets">Budgets</string>
 </resources>
diff --git a/app/src/main/res/values-ro-rRO/strings.xml b/app/src/main/res/values-ro-rRO/strings.xml
index e0ba9542..537511d1 100644
--- a/app/src/main/res/values-ro-rRO/strings.xml
+++ b/app/src/main/res/values-ro-rRO/strings.xml
@@ -392,6 +392,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-ru/strings.xml b/app/src/main/res/values-ru/strings.xml
index e55a0c18..027b2282 100644
--- a/app/src/main/res/values-ru/strings.xml
+++ b/app/src/main/res/values-ru/strings.xml
@@ -390,6 +390,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item> </item>
     <item> </item>
diff --git a/app/src/main/res/values-sr-rSP/strings.xml b/app/src/main/res/values-sr-rSP/strings.xml
index 314cb68f..bb3fd51e 100644
--- a/app/src/main/res/values-sr-rSP/strings.xml
+++ b/app/src/main/res/values-sr-rSP/strings.xml
@@ -392,6 +392,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-sv-rSE/strings.xml b/app/src/main/res/values-sv-rSE/strings.xml
index fb29721c..be04b6ec 100644
--- a/app/src/main/res/values-sv-rSE/strings.xml
+++ b/app/src/main/res/values-sv-rSE/strings.xml
@@ -387,6 +387,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-tr-rTR/strings.xml b/app/src/main/res/values-tr-rTR/strings.xml
index 01abdf06..46745ae1 100644
--- a/app/src/main/res/values-tr-rTR/strings.xml
+++ b/app/src/main/res/values-tr-rTR/strings.xml
@@ -387,6 +387,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-uk-rUA/strings.xml b/app/src/main/res/values-uk-rUA/strings.xml
index 1cd55814..eb875888 100644
--- a/app/src/main/res/values-uk-rUA/strings.xml
+++ b/app/src/main/res/values-uk-rUA/strings.xml
@@ -388,6 +388,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item> </item>
     <item> </item>
diff --git a/app/src/main/res/values-vi-rVN/strings.xml b/app/src/main/res/values-vi-rVN/strings.xml
index b60fa85a..3e5caf59 100644
--- a/app/src/main/res/values-vi-rVN/strings.xml
+++ b/app/src/main/res/values-vi-rVN/strings.xml
@@ -382,6 +382,7 @@
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values-zh-rCN/strings.xml b/app/src/main/res/values-zh-rCN/strings.xml
index 3d9283af..ca94540b 100644
--- a/app/src/main/res/values-zh-rCN/strings.xml
+++ b/app/src/main/res/values-zh-rCN/strings.xml
@@ -377,6 +377,7 @@
   <string name="menu_duplicate_transaction"></string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item></item>
     <item>3</item>
diff --git a/app/src/main/res/values-zh-rTW/strings.xml b/app/src/main/res/values-zh-rTW/strings.xml
index e44bdd5e..c8ec5e87 100644
--- a/app/src/main/res/values-zh-rTW/strings.xml
+++ b/app/src/main/res/values-zh-rTW/strings.xml
@@ -379,6 +379,7 @@ No user-identifiable information will be collected as part of this process!
   <string name="menu_duplicate_transaction">Duplicate</string>
   <string name="nav_menu_budgets">Budgets</string>
   <string name="title_cash_flow_report">Cash Flow</string>
+  <string name="title_budgets">Budgets</string>
   <string-array name="report_time_range">
     <item>Current month</item>
     <item>Last 3 months</item>
diff --git a/app/src/main/res/values/dimens.xml b/app/src/main/res/values/dimens.xml
index f3d43379..ec96a25c 100644
--- a/app/src/main/res/values/dimens.xml
+++ b/app/src/main/res/values/dimens.xml
@@ -32,4 +32,5 @@
     <dimen name="color_swatch_margins_large">8dip</dimen>
     <dimen name="color_swatch_margins_small">4dip</dimen>
     <dimen name="card_min_height">80dp</dimen>
+    <dimen name="toolbar_progress_height">2dp</dimen>
 </resources>
\ No newline at end of file
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
index c4e84e74..4e08ecc1 100644
--- a/app/src/main/res/values/strings.xml
+++ b/app/src/main/res/values/strings.xml
@@ -65,7 +65,7 @@
         <item>SD Card</item>
         <item>DropBox</item>
         <item>Google Drive</item>
-        <item>Owncloud</item>
+        <item>OwnCloud</item>
         <item>Send to&#8230;</item>
     </string-array>
     <string name="btn_move">Move</string>
@@ -407,6 +407,7 @@
     <string name="menu_duplicate_transaction">Duplicate</string>
     <string name="nav_menu_budgets">Budgets</string>
     <string name="title_cash_flow_report">Cash Flow</string>
+    <string name="title_budgets">Budgets</string>
     <string-array name="report_time_range">
         <item>Current month</item>
         <item>Last 3 months</item>
diff --git a/build.gradle b/build.gradle
index 87976eb1..e9299274 100644
--- a/build.gradle
+++ b/build.gradle
@@ -4,7 +4,7 @@ buildscript {
 		jcenter()
 	}
 	dependencies {
-		classpath 'com.android.tools.build:gradle:2.0.0-alpha1'
+		classpath 'com.android.tools.build:gradle:2.0.0-alpha2'
 		classpath 'io.fabric.tools:gradle:1.+'
 	}
 }
