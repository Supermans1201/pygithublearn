From 5518b8a0c903685bec0423280eb7b50bf603257a Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 7 Nov 2012 00:51:13 +0100
Subject: [PATCH 01/12] Fixed: Potential data loss after exporting (closes #25)
 Now a confirmation dialog is shown before deleting all transactions

---
 GnucashMobile/res/values-de/strings.xml            | 549 ++++++++++++++++++---
 GnucashMobile/res/values-el/strings.xml            |   6 +-
 GnucashMobile/res/values-es-rMX/strings.xml        |   4 +-
 GnucashMobile/res/values-es/strings.xml            |   4 +-
 GnucashMobile/res/values-fr/strings.xml            |   4 +-
 GnucashMobile/res/values-it/strings.xml            |   4 +-
 GnucashMobile/res/values-nb/strings.xml            |   4 +-
 GnucashMobile/res/values-nl/strings.xml            |   4 +-
 GnucashMobile/res/values-pt-rBR/strings.xml        |   4 +-
 GnucashMobile/res/values-ru/strings.xml            |   4 +-
 GnucashMobile/res/values/strings.xml               |   4 +-
 .../android/ui/accounts/AccountsListFragment.java  |   2 +-
 .../android/ui/accounts/ExportDialogFragment.java  |  15 +-
 .../TransactionsDeleteConfirmationDialog.java      |  64 +++
 .../org/gnucash/android/test/ui/OfxExportTest.java |   1 +
 .../android/test/ui/TransactionsActivityTest.java  |   2 -
 16 files changed, 581 insertions(+), 94 deletions(-)
 create mode 100644 GnucashMobile/src/org/gnucash/android/ui/transactions/TransactionsDeleteConfirmationDialog.java

diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index 47fd1e36..adcc83e3 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -1,71 +1,478 @@
-<?xml version="1.0" encoding="utf-8"?><!-- Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com> Copyright (c) 2012 Christian Stimming <christian@stimming.de>  Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at     http://www.apache.org/licenses/LICENSE-2.0  Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.-->
-<resources>    <string name="app_name">GnuCash</string>
-    <string name="title_add_account">Neues Konto</string>
-    <string name="title_edit_account">Konto bearbeiten</string>
-    <string name="info_details">Info</string>
-    <string name="title_settings">Einstellungen</string>
-    <string name="menu_export_ofx">OFX-Datei exportieren</string>
-    <string name="description_add_transaction_icon">Neue Buchung in ein Konto</string>
-    <string name="label_no_accounts">Keine Konten vorhanden</string>
-    <string name="label_account_name">Kontoname</string>
-    <string name="btn_cancel">Abbrechen</string>
-    <string name="btn_save">Speichern</string>
-    <string name="no_transactions_to_display">Keine Buchungen vorhanden</string>
-    <string name="label_transaction_name">Beschreibung</string>
-    <string name="label_transaction_amount">Betrag </string>
-    <string name="title_add_transaction">Neue Buchung</string>
-    <string name="label_no_transactions">Keine Buchungen vorhanden</string>
-    <string name="label_timeanddate">Datum &amp; Zeit</string>
-    <string name="label_account">Konto</string>
-    <string name="label_debit">Soll</string>
-    <string name="label_credit">Haben</string>
-    <string name="title_accounts">Konten</string>
-    <string name="title_transactions">Buchungen</string>
-    <string name="menu_delete">L&#246;schen</string>
-    <string name="alert_dialog_ok_delete">L&#246;schen</string>
-    <string name="alert_dialog_cancel">Abbrechen</string>
-    <string name="toast_account_deleted">Das Konto wurde gel&#246;scht</string>
-    <string name="title_confirm_delete">L&#246;schen best&#228;tigen</string>
-    <string name="delete_confirmation_message">Alle Buchungen dieses Kontos werden gel&#246;scht</string>
-    <string name="title_edit_transaction">Buchung bearbeiten</string>
-    <string name="label_transaction_description">Notizen</string>
-    <string name="menu_move">Verschieben</string>
-    <string name="title_selected">%1$d ausgew&#228;hlt</string>
-    <string name="label_transactions_total">Summe:</string>
-    <string name="label_export_destination">Exportziel</string>
-    <string name="title_export_dialog">Export OFX</string>
-    <string name="option_export_all_transactions">Alle Buchungen exportieren</string>
-    <string name="hint_export_choice">Auswhlen, um alle Buchungen zu exportieren. Andernfalls werden nur die neuen Buchungen seit letztem Export exportiert.</string>
-    <string name="error_exporting">Fehler beim Exportieren der OFX-Datei</string>    
-    <string name="btn_export">Export</string>
-    <string name="option_delete_after_export">L&#246;schen nach dem exportieren</string>
-    <string name="hint_delete_after_export">Alle exportierten Buchungen werden nach dem Export gelscht.</string>
-    <string name="title_settings">Einstellungen</string>
-    <string-array name="export_destinations">
-        <item>Senden&#8230;</item>
-        <item>SD-Kartenspeicher</item>
-    </string-array>
-    <string name="btn_move">Verschieben</string>
-    <string name="title_move_transactions">%1$d Buchung(en) verschieben</string>
-    <string name="label_move_destination">Zielkonto</string>
-    <string name="permission_access_sdcard">Zugriff auf SD-Kartenspeicher</string>
-    <string name="title_share_ofx_with">OFX-Datei senden mit</string>
-    <string name="key_default_currency">default_currency</string>
-    <string name="toast_incompatible_currency">Buchungen k&#246;nnten nicht verschoben werden.\Die W&#228;hrung des Zielkontos ist inkompatibel</string>
-    <string name="header_general_settings">Allgemein</string>
-    <string name="header_about_gnucash">&#220;ber Gnucash</string>
-    <string name="title_choose_currency">Standard W&#228;hrung ausw&#228;hlen</string>
-    <string name="title_default_currency">Standard W&#228;hrung</string>
-    <string name="summary_default_currency">Standard W&#228;hrung f&#252;r neuen Konten</string>
-    <string name="label_permission_record_transactions">Erm&#246;glicht das Speichern von Buchungen in Gnucash</string>
-    <string name="label_permission_create_accounts">Erm&#246;glicht das Erstellen von Konten in Gnucash</string>
-    <string name="label_permission_group">Ihre Gnucash Daten</string>
-    <string name="description_permission_group">Lesen und Bearbeiten von Gnucash Daten</string>
-    <string name="label_permission_record_transaction">Buchungen speichern</string>
-    <string name="label_permission_create_account">Konten erstellen</string>
-    <string name="label_display_account">Konto Anzeigen</string>
-    <string name="btn_create_accounts">Konten erstellen</string>
-    <string name="title_default_accounts">Zu erstellende Konten ausw&#228;hlen</string>
-    <string name="key_first_run">key_first_run</string>
-    <string-array name="currency_names">
-        <item>Afghani</item>		<item>Algerian Dinar</item>		<item>Argentine Peso</item>		<item>Armenian Dram</item>		<item>Aruban Florin</item>		<item>Australian Dollar</item>		<item>Azerbaijanian Manat</item>		<item>Bahamian Dollar</item>		<item>Bahraini Dinar</item>		<item>Baht</item>		<item>Balboa</item>		<item>Barbados Dollar</item>		<item>Belarussian Ruble</item>		<item>Belize Dollar</item>		<item>Bermudian Dollar</item>		<item>Bolivar Fuerte</item>		<item>Boliviano</item>		<item>Brazilian Real</item>		<item>Brunei Dollar</item>		<item>Bulgarian Lev</item>		<item>Burundi Franc</item>		<item>Canadian Dollar</item>		<item>Cape Verde Escudo</item>		<item>Cayman Islands Dollar</item>		<item>CFA Franc BCEAO</item>		<item>CFA Franc BEAC</item>		<item>CFP Franc</item>		<item>Chilean Peso</item>		<item>Testing currency</item>		<item>Colombian Peso</item>		<item>Comoro Franc</item>		<item>Congolese Franc</item>		<item>Convertible Mark</item>		<item>Cordoba Oro</item>		<item>Costa Rican Colon</item>		<item>Croatian Kuna</item>		<item>Cuban Peso</item>		<item>Czech Koruna</item>		<item>Dalasi</item>		<item>Danish Krone</item>		<item>Denar</item>		<item>Djibouti Franc</item>		<item>Dobra</item>		<item>Dominican Peso</item>		<item>Dong</item>		<item>East Caribbean Dollar</item>		<item>Egyptian Pound</item>		<item>El Salvador Colon</item>		<item>Ethiopian Birr</item>		<item>Euro</item>		<item>Falkland Islands Pound</item>		<item>Fiji Dollar</item>		<item>Forint</item>		<item>Ghana Cedi</item>		<item>Gibraltar Pound</item>		<item>Gold</item>		<item>Gourde</item>		<item>Guarani</item>		<item>Guinea Franc</item>		<item>Guyana Dollar</item>		<item>Hong Kong Dollar</item>		<item>Hryvnia</item>		<item>Iceland Krona</item>		<item>Indian Rupee</item>		<item>Iranian Rial</item>		<item>Iraqi Dinar</item>		<item>Jamaican Dollar</item>		<item>Jordanian Dinar</item>		<item>Kenyan Shilling</item>		<item>Kina</item>		<item>Kip</item>		<item>Kuwaiti Dinar</item>		<item>Kwacha</item>		<item>Kwanza</item>		<item>Kyat</item>		<item>Lari</item>		<item>Latvian Lats</item>		<item>Lebanese Pound</item>		<item>Lek</item>		<item>Lempira</item>		<item>Leone</item>		<item>Liberian Dollar</item>		<item>Libyan Dinar</item>		<item>Lilangeni</item>		<item>Lithuanian Litas</item>		<item>Loti</item>		<item>Malagasy Ariary</item>		<item>Malaysian Ringgit</item>		<item>Mauritius Rupee</item>		<item>Mexican Peso</item>		<item>Mexican Unidad de Inversion (UDI)</item>		<item>Moldovan Leu</item>		<item>Moroccan Dirham</item>		<item>Mozambique Metical</item>		<item>Mvdol</item>		<item>Naira</item>		<item>Nakfa</item>		<item>Namibia Dollar</item>		<item>Nepalese Rupee</item>		<item>Netherlands Antillean Guilder</item>		<item>New Israeli Sheqel</item>		<item>New Romanian Leu</item>		<item>New Taiwan Dollar</item>		<item>New Zealand Dollar</item>		<item>Ngultrum</item>		<item>North Korean Won</item>		<item>Norwegian Krone</item>		<item>Nuevo Sol</item>		<item>Ouguiya</item>		<item>Paanga</item>		<item>Pakistan Rupee</item>		<item>Palladium</item>		<item>Pataca</item>		<item>Peso Convertible</item>		<item>Peso Uruguayo</item>		<item>Philippine Peso</item>		<item>Platinum</item>		<item>Pound Sterling</item>		<item>Pula</item>		<item>Qatari Rial</item>		<item>Quetzal</item>		<item>Rand</item>		<item>Rial Omani</item>		<item>Riel</item>		<item>Rufiyaa</item>		<item>Rupiah</item>		<item>Russian Ruble</item>		<item>Rwanda Franc</item>		<item>Saint Helena Pound</item>		<item>Saudi Riyal</item>		<item>SDR (Special Drawing Right)</item>		<item>Serbian Dinar</item>		<item>Seychelles Rupee</item>		<item>Silver</item>		<item>Singapore Dollar</item>		<item>Solomon Islands Dollar</item>		<item>Som</item>		<item>Somali Shilling</item>		<item>Somoni</item>		<item>South Sudanese Pound</item>		<item>Sri Lanka Rupee</item>		<item>Sucre</item>		<item>Sudanese Pound</item>		<item>Surinam Dollar</item>		<item>Swedish Krona</item>		<item>Swiss Franc</item>		<item>Syrian Pound</item>		<item>Taka</item>		<item>Tala</item>		<item>Tanzanian Shilling</item>		<item>Tenge</item>		<item>No currency</item>		<item>Trinidad and Tobago Dollar</item>		<item>Tugrik</item>		<item>Tunisian Dinar</item>		<item>Turkish Lira</item>		<item>Turkmenistan New Manat</item>		<item>UAE Dirham</item>		<item>Uganda Shilling</item>		<item>UIC-Franc</item>		<item>Unidad de Valor Real</item>		<item>Unidades de fomento</item>		<item>Uruguay Peso en Unidades Indexadas (URUIURUI)</item>		<item>US Dollar</item>		<item>Uzbekistan Sum</item>		<item>Vatu</item>		<item>WIR Euro</item>		<item>WIR Franc</item>		<item>Won</item>		<item>Yemeni Rial</item>		<item>Yen</item>		<item>Yuan Renminbi</item>		<item>Zambian Kwacha</item>		<item>Zimbabwe Dollar</item>		<item>Zloty</item>    </string-array>	<string-array name="currency_codes">        <item>AFN</item>		<item>DZD</item>		<item>ARS</item>		<item>AMD</item>		<item>AWG</item>		<item>AUD</item>		<item>AZN</item>		<item>BSD</item>		<item>BHD</item>		<item>THB</item>		<item>PAB</item>		<item>BBD</item>		<item>BYR</item>		<item>BZD</item>		<item>BMD</item>		<item>VEF</item>		<item>BOB</item>		<item>BRL</item>		<item>BND</item>		<item>BGN</item>		<item>BIF</item>		<item>CAD</item>		<item>CVE</item>		<item>KYD</item>		<item>XOF</item>		<item>XAF</item>		<item>XPF</item>		<item>CLP</item>		<item>XTS</item>		<item>COP</item>		<item>KMF</item>		<item>CDF</item>		<item>BAM</item>		<item>NIO</item>		<item>CRC</item>		<item>HRK</item>		<item>CUP</item>		<item>CZK</item>		<item>GMD</item>		<item>DKK</item>		<item>MKD</item>		<item>DJF</item>		<item>STD</item>		<item>DOP</item>		<item>VND</item>		<item>XCD</item>		<item>EGP</item>		<item>SVC</item>		<item>ETB</item>		<item>EUR</item>		<item>FKP</item>		<item>FJD</item>		<item>HUF</item>		<item>GHS</item>		<item>GIP</item>		<item>XAU</item>		<item>HTG</item>		<item>PYG</item>		<item>GNF</item>		<item>GYD</item>		<item>HKD</item>		<item>UAH</item>		<item>ISK</item>		<item>INR</item>		<item>IRR</item>		<item>IQD</item>		<item>JMD</item>		<item>JOD</item>		<item>KES</item>		<item>PGK</item>		<item>LAK</item>		<item>KWD</item>		<item>MWK</item>		<item>AOA</item>		<item>MMK</item>		<item>GEL</item>		<item>LVL</item>		<item>LBP</item>		<item>ALL</item>		<item>HNL</item>		<item>SLL</item>		<item>LRD</item>		<item>LYD</item>		<item>SZL</item>		<item>LTL</item>		<item>LSL</item>		<item>MGA</item>		<item>MYR</item>		<item>MUR</item>		<item>MXN</item>		<item>MXV</item>		<item>MDL</item>		<item>MAD</item>		<item>MZN</item>		<item>BOV</item>		<item>NGN</item>		<item>ERN</item>		<item>NAD</item>		<item>NPR</item>		<item>ANG</item>		<item>ILS</item>		<item>RON</item>		<item>TWD</item>		<item>NZD</item>		<item>BTN</item>		<item>KPW</item>		<item>NOK</item>		<item>PEN</item>		<item>MRO</item>		<item>TOP</item>		<item>PKR</item>		<item>XPD</item>		<item>MOP</item>		<item>CUC</item>		<item>UYU</item>		<item>PHP</item>		<item>XPT</item>		<item>GBP</item>		<item>BWP</item>		<item>QAR</item>		<item>GTQ</item>		<item>ZAR</item>		<item>OMR</item>		<item>KHR</item>		<item>MVR</item>		<item>IDR</item>		<item>RUB</item>		<item>RWF</item>		<item>SHP</item>		<item>SAR</item>		<item>XDR</item>		<item>RSD</item>		<item>SCR</item>		<item>XAG</item>		<item>SGD</item>		<item>SBD</item>		<item>KGS</item>		<item>SOS</item>		<item>TJS</item>		<item>SSP</item>		<item>LKR</item>		<item>XSU</item>		<item>SDG</item>		<item>SRD</item>		<item>SEK</item>		<item>CHF</item>		<item>SYP</item>		<item>BDT</item>		<item>WST</item>		<item>TZS</item>		<item>KZT</item>		<item>XXX</item>		<item>TTD</item>		<item>MNT</item>		<item>TND</item>		<item>TRY</item>		<item>TMT</item>		<item>AED</item>		<item>UGX</item>		<item>XFU</item>		<item>COU</item>		<item>CLF</item>		<item>UYI</item>		<item>USD</item>		<item>UZS</item>		<item>VUV</item>		<item>CHE</item>		<item>CHW</item>		<item>KRW</item>		<item>YER</item>		<item>JPY</item>		<item>CNY</item>		<item>ZMK</item>		<item>ZWL</item>		<item>PLN</item>    </string-array>	<string-array name="default_accounts">	    <item>Ausgaben</item>	    <item>Einkommen</item>	    <item>Aktiva</item>	    	    <item>Unterhaltung</item>	    <item>Versicherung</item>	</string-array>	<string name="error_no_accounts">Keine Konten vorhanden.\nSie m&#252;ssen einen Konto erstellen um Widgets zu anzuf&#252;gen</string>	<string name="key_build_version">build_version</string>	<string name="title_build_version">Version</string>	<string name="title_license">Lizenz</string>	<string name="summary_licence_details">Apache License v2.0. Klicken f&#252;r Details</string>	<string name="title_general_prefs">Allgemein</string>	<string name="key_license">app_license</string>	<string name="label_widget_configuration">Konto ausw&#228;hlen</string>	<string name="toast_no_transactions_to_export">Keine Buchungen zum exportieren</string>	<string name="key_about">about_gnucash</string>	<string name="title_about_gnucash">&#220;ber Gnucash</string>	<string name="summary_about_gnucash">GnucashMobile ist eine mobile Datenaufzeichungs-App f&#252;r Android. \nEs erm&#246;glicht die schnelle und flexible Registrierung von Zahlungsvorg&#228;ngen unterwegs, die dann als Datei im OFX-Format exportiert und von der GnuCash-Anwendung an einem Desktop-PC importiert werden k&#246;nnen.</string>	<string name="title_about">&#220;ber</string>	<string name="ofx_file_exported_to">OFX-Datei exportiert nach:</string>	<string name="toast_error_exporting_ofx">Fehler beim Exportieren der OFX-Datei:\n</string>	<string name="toast_ofx_exported_to">OFX-Datei erfolgreich exportiert nach:\n</string>	<string name="title_export_email">Gnucash exportierte OFX-Datei</string>	<string name="description_export_email">Gnucash accounts export from </string>	<string name="header_transaction_settings">Buchungen</string>	<string name="title_transaction_preferences">Einstellungen Buchungen</string>	<string name="title_account_preferences">Einstellungen Konten</string>	<string name="key_default_transaction_type">default_transaction_type</string>	<string name="title_default_transaction_type">Voreinstellung Buchungsart</string>	<string name="summary_default_transaction_type">Die voreingestellte Buchungsart: Soll oder Haben</string>	<string-array name="transaction_types">		<item>Haben</item>		<item>Soll</item>	</string-array></resources>
\ No newline at end of file
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+ Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
+ Copyright (c) 2012 Christian Stimming <christian@stimming.de>
+ 
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+ 
+    http://www.apache.org/licenses/LICENSE-2.0
+ 
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+<resources>
+    <string name="app_name">GnuCash</string>
+    <string name="title_add_account">Neues Konto</string>
+    <string name="title_edit_account">Konto bearbeiten</string>
+    <string name="info_details">Info</string>
+    <string name="title_settings">Einstellungen</string>
+    <string name="menu_export_ofx">OFX-Datei exportieren</string>
+    <string name="description_add_transaction_icon">Neue Buchung in ein Konto</string>
+    <string name="label_no_accounts">Keine Konten vorhanden</string>
+    <string name="label_account_name">Kontoname</string>
+    <string name="btn_cancel">Abbrechen</string>
+    <string name="btn_save">Speichern</string>
+    <string name="no_transactions_to_display">Keine Buchungen vorhanden</string>
+    <string name="label_transaction_name">Beschreibung</string>
+    <string name="label_transaction_amount">Betrag </string>
+    <string name="title_add_transaction">Neue Buchung</string>
+    <string name="label_no_transactions">Keine Buchungen vorhanden</string>
+    <string name="label_timeanddate">Datum &amp; Zeit</string>
+    <string name="label_account">Konto</string>
+    <string name="label_debit">Soll</string>
+    <string name="label_credit">Haben</string>
+    <string name="title_accounts">Konten</string>
+    <string name="title_transactions">Buchungen</string>
+    <string name="menu_delete">L&#246;schen</string>
+    <string name="alert_dialog_ok_delete">L&#246;schen</string>
+    <string name="alert_dialog_cancel">Abbrechen</string>
+    <string name="toast_account_deleted">Das Konto wurde gel&#246;scht</string>
+    <string name="title_confirm_delete">L&#246;schen best&#228;tigen</string>
+    <string name="delete_account_confirmation_message">Alle Buchungen dieses Kontos werden gel&#246;scht</string>
+    <string name="title_edit_transaction">Buchung bearbeiten</string>
+    <string name="label_transaction_description">Notizen</string>
+    <string name="menu_move">Verschieben</string>
+    <string name="title_selected">%1$d ausgew&#228;hlt</string>
+    <string name="label_transactions_total">Summe:</string>
+    <string name="label_export_destination">Exportziel</string>
+    <string name="title_export_dialog">Export OFX</string>
+    <string name="option_export_all_transactions">Alle Buchungen exportieren</string>
+    <string name="hint_export_choice">Auswhlen, um alle Buchungen zu exportieren. Andernfalls werden nur die neuen Buchungen seit letztem Export exportiert.</string>
+    <string name="error_exporting">Fehler beim Exportieren der OFX-Datei</string>    
+    <string name="btn_export">Export</string>
+    <string name="option_delete_after_export">L&#246;schen nach dem exportieren</string>
+    <string name="hint_delete_after_export">Alle exportierten Buchungen werden nach dem Export gelscht.</string>
+    <string name="title_settings">Einstellungen</string>
+    <string-array name="export_destinations">
+        <item>Senden&#8230;</item>
+        <item>SD-Kartenspeicher</item>
+    </string-array>
+    <string name="btn_move">Verschieben</string>
+    <string name="title_move_transactions">%1$d Buchung(en) verschieben</string>
+    <string name="label_move_destination">Zielkonto</string>
+    <string name="permission_access_sdcard">Zugriff auf SD-Kartenspeicher</string>
+    <string name="title_share_ofx_with">OFX-Datei senden mit</string>
+    <string name="key_default_currency">default_currency</string>
+    <string name="toast_incompatible_currency">Buchungen k&#246;nnten nicht verschoben werden.\Die W&#228;hrung des Zielkontos ist inkompatibel</string>
+    <string name="header_general_settings">Allgemein</string>
+    <string name="header_about_gnucash">&#220;ber Gnucash</string>
+    <string name="title_choose_currency">Standard W&#228;hrung ausw&#228;hlen</string>
+    <string name="title_default_currency">Standard W&#228;hrung</string>
+    <string name="summary_default_currency">Standard W&#228;hrung f&#252;r neuen Konten</string>
+    <string name="label_permission_record_transactions">Erm&#246;glicht das Speichern von Buchungen in Gnucash</string>
+    <string name="label_permission_create_accounts">Erm&#246;glicht das Erstellen von Konten in Gnucash</string>
+    <string name="label_permission_group">Ihre Gnucash Daten</string>
+    <string name="description_permission_group">Lesen und Bearbeiten von Gnucash Daten</string>
+    <string name="label_permission_record_transaction">Buchungen speichern</string>
+    <string name="label_permission_create_account">Konten erstellen</string>
+    <string name="label_display_account">Konto Anzeigen</string>
+    <string name="btn_create_accounts">Konten erstellen</string>
+    <string name="title_default_accounts">Zu erstellende Konten ausw&#228;hlen</string>
+    <string name="key_first_run">key_first_run</string>
+    <string-array name="currency_names">
+        <item>Afghani</item>
+		<item>Algerian Dinar</item>
+		<item>Argentine Peso</item>
+		<item>Armenian Dram</item>
+		<item>Aruban Florin</item>
+		<item>Australian Dollar</item>
+		<item>Azerbaijanian Manat</item>
+		<item>Bahamian Dollar</item>
+		<item>Bahraini Dinar</item>
+		<item>Baht</item>
+		<item>Balboa</item>
+		<item>Barbados Dollar</item>
+		<item>Belarussian Ruble</item>
+		<item>Belize Dollar</item>
+		<item>Bermudian Dollar</item>
+		<item>Bolivar Fuerte</item>
+		<item>Boliviano</item>
+		<item>Brazilian Real</item>
+		<item>Brunei Dollar</item>
+		<item>Bulgarian Lev</item>
+		<item>Burundi Franc</item>
+		<item>Canadian Dollar</item>
+		<item>Cape Verde Escudo</item>
+		<item>Cayman Islands Dollar</item>
+		<item>CFA Franc BCEAO</item>
+		<item>CFA Franc BEAC</item>
+		<item>CFP Franc</item>
+		<item>Chilean Peso</item>
+		<item>Testing currency</item>
+		<item>Colombian Peso</item>
+		<item>Comoro Franc</item>
+		<item>Congolese Franc</item>
+		<item>Convertible Mark</item>
+		<item>Cordoba Oro</item>
+		<item>Costa Rican Colon</item>
+		<item>Croatian Kuna</item>
+		<item>Cuban Peso</item>
+		<item>Czech Koruna</item>
+		<item>Dalasi</item>
+		<item>Danish Krone</item>
+		<item>Denar</item>
+		<item>Djibouti Franc</item>
+		<item>Dobra</item>
+		<item>Dominican Peso</item>
+		<item>Dong</item>
+		<item>East Caribbean Dollar</item>
+		<item>Egyptian Pound</item>
+		<item>El Salvador Colon</item>
+		<item>Ethiopian Birr</item>
+		<item>Euro</item>
+		<item>Falkland Islands Pound</item>
+		<item>Fiji Dollar</item>
+		<item>Forint</item>
+		<item>Ghana Cedi</item>
+		<item>Gibraltar Pound</item>
+		<item>Gold</item>
+		<item>Gourde</item>
+		<item>Guarani</item>
+		<item>Guinea Franc</item>
+		<item>Guyana Dollar</item>
+		<item>Hong Kong Dollar</item>
+		<item>Hryvnia</item>
+		<item>Iceland Krona</item>
+		<item>Indian Rupee</item>
+		<item>Iranian Rial</item>
+		<item>Iraqi Dinar</item>
+		<item>Jamaican Dollar</item>
+		<item>Jordanian Dinar</item>
+		<item>Kenyan Shilling</item>
+		<item>Kina</item>
+		<item>Kip</item>
+		<item>Kuwaiti Dinar</item>
+		<item>Kwacha</item>
+		<item>Kwanza</item>
+		<item>Kyat</item>
+		<item>Lari</item>
+		<item>Latvian Lats</item>
+		<item>Lebanese Pound</item>
+		<item>Lek</item>
+		<item>Lempira</item>
+		<item>Leone</item>
+		<item>Liberian Dollar</item>
+		<item>Libyan Dinar</item>
+		<item>Lilangeni</item>
+		<item>Lithuanian Litas</item>
+		<item>Loti</item>
+		<item>Malagasy Ariary</item>
+		<item>Malaysian Ringgit</item>
+		<item>Mauritius Rupee</item>
+		<item>Mexican Peso</item>
+		<item>Mexican Unidad de Inversion (UDI)</item>
+		<item>Moldovan Leu</item>
+		<item>Moroccan Dirham</item>
+		<item>Mozambique Metical</item>
+		<item>Mvdol</item>
+		<item>Naira</item>
+		<item>Nakfa</item>
+		<item>Namibia Dollar</item>
+		<item>Nepalese Rupee</item>
+		<item>Netherlands Antillean Guilder</item>
+		<item>New Israeli Sheqel</item>
+		<item>New Romanian Leu</item>
+		<item>New Taiwan Dollar</item>
+		<item>New Zealand Dollar</item>
+		<item>Ngultrum</item>
+		<item>North Korean Won</item>
+		<item>Norwegian Krone</item>
+		<item>Nuevo Sol</item>
+		<item>Ouguiya</item>
+		<item>Paanga</item>
+		<item>Pakistan Rupee</item>
+		<item>Palladium</item>
+		<item>Pataca</item>
+		<item>Peso Convertible</item>
+		<item>Peso Uruguayo</item>
+		<item>Philippine Peso</item>
+		<item>Platinum</item>
+		<item>Pound Sterling</item>
+		<item>Pula</item>
+		<item>Qatari Rial</item>
+		<item>Quetzal</item>
+		<item>Rand</item>
+		<item>Rial Omani</item>
+		<item>Riel</item>
+		<item>Rufiyaa</item>
+		<item>Rupiah</item>
+		<item>Russian Ruble</item>
+		<item>Rwanda Franc</item>
+		<item>Saint Helena Pound</item>
+		<item>Saudi Riyal</item>
+		<item>SDR (Special Drawing Right)</item>
+		<item>Serbian Dinar</item>
+		<item>Seychelles Rupee</item>
+		<item>Silver</item>
+		<item>Singapore Dollar</item>
+		<item>Solomon Islands Dollar</item>
+		<item>Som</item>
+		<item>Somali Shilling</item>
+		<item>Somoni</item>
+		<item>South Sudanese Pound</item>
+		<item>Sri Lanka Rupee</item>
+		<item>Sucre</item>
+		<item>Sudanese Pound</item>
+		<item>Surinam Dollar</item>
+		<item>Swedish Krona</item>
+		<item>Swiss Franc</item>
+		<item>Syrian Pound</item>
+		<item>Taka</item>
+		<item>Tala</item>
+		<item>Tanzanian Shilling</item>
+		<item>Tenge</item>
+		<item>No currency</item>
+		<item>Trinidad and Tobago Dollar</item>
+		<item>Tugrik</item>
+		<item>Tunisian Dinar</item>
+		<item>Turkish Lira</item>
+		<item>Turkmenistan New Manat</item>
+		<item>UAE Dirham</item>
+		<item>Uganda Shilling</item>
+		<item>UIC-Franc</item>
+		<item>Unidad de Valor Real</item>
+		<item>Unidades de fomento</item>
+		<item>Uruguay Peso en Unidades Indexadas (URUIURUI)</item>
+		<item>US Dollar</item>
+		<item>Uzbekistan Sum</item>
+		<item>Vatu</item>
+		<item>WIR Euro</item>
+		<item>WIR Franc</item>
+		<item>Won</item>
+		<item>Yemeni Rial</item>
+		<item>Yen</item>
+		<item>Yuan Renminbi</item>
+		<item>Zambian Kwacha</item>
+		<item>Zimbabwe Dollar</item>
+		<item>Zloty</item>
+    </string-array>
+	<string-array name="currency_codes">
+        <item>AFN</item>
+		<item>DZD</item>
+		<item>ARS</item>
+		<item>AMD</item>
+		<item>AWG</item>
+		<item>AUD</item>
+		<item>AZN</item>
+		<item>BSD</item>
+		<item>BHD</item>
+		<item>THB</item>
+		<item>PAB</item>
+		<item>BBD</item>
+		<item>BYR</item>
+		<item>BZD</item>
+		<item>BMD</item>
+		<item>VEF</item>
+		<item>BOB</item>
+		<item>BRL</item>
+		<item>BND</item>
+		<item>BGN</item>
+		<item>BIF</item>
+		<item>CAD</item>
+		<item>CVE</item>
+		<item>KYD</item>
+		<item>XOF</item>
+		<item>XAF</item>
+		<item>XPF</item>
+		<item>CLP</item>
+		<item>XTS</item>
+		<item>COP</item>
+		<item>KMF</item>
+		<item>CDF</item>
+		<item>BAM</item>
+		<item>NIO</item>
+		<item>CRC</item>
+		<item>HRK</item>
+		<item>CUP</item>
+		<item>CZK</item>
+		<item>GMD</item>
+		<item>DKK</item>
+		<item>MKD</item>
+		<item>DJF</item>
+		<item>STD</item>
+		<item>DOP</item>
+		<item>VND</item>
+		<item>XCD</item>
+		<item>EGP</item>
+		<item>SVC</item>
+		<item>ETB</item>
+		<item>EUR</item>
+		<item>FKP</item>
+		<item>FJD</item>
+		<item>HUF</item>
+		<item>GHS</item>
+		<item>GIP</item>
+		<item>XAU</item>
+		<item>HTG</item>
+		<item>PYG</item>
+		<item>GNF</item>
+		<item>GYD</item>
+		<item>HKD</item>
+		<item>UAH</item>
+		<item>ISK</item>
+		<item>INR</item>
+		<item>IRR</item>
+		<item>IQD</item>
+		<item>JMD</item>
+		<item>JOD</item>
+		<item>KES</item>
+		<item>PGK</item>
+		<item>LAK</item>
+		<item>KWD</item>
+		<item>MWK</item>
+		<item>AOA</item>
+		<item>MMK</item>
+		<item>GEL</item>
+		<item>LVL</item>
+		<item>LBP</item>
+		<item>ALL</item>
+		<item>HNL</item>
+		<item>SLL</item>
+		<item>LRD</item>
+		<item>LYD</item>
+		<item>SZL</item>
+		<item>LTL</item>
+		<item>LSL</item>
+		<item>MGA</item>
+		<item>MYR</item>
+		<item>MUR</item>
+		<item>MXN</item>
+		<item>MXV</item>
+		<item>MDL</item>
+		<item>MAD</item>
+		<item>MZN</item>
+		<item>BOV</item>
+		<item>NGN</item>
+		<item>ERN</item>
+		<item>NAD</item>
+		<item>NPR</item>
+		<item>ANG</item>
+		<item>ILS</item>
+		<item>RON</item>
+		<item>TWD</item>
+		<item>NZD</item>
+		<item>BTN</item>
+		<item>KPW</item>
+		<item>NOK</item>
+		<item>PEN</item>
+		<item>MRO</item>
+		<item>TOP</item>
+		<item>PKR</item>
+		<item>XPD</item>
+		<item>MOP</item>
+		<item>CUC</item>
+		<item>UYU</item>
+		<item>PHP</item>
+		<item>XPT</item>
+		<item>GBP</item>
+		<item>BWP</item>
+		<item>QAR</item>
+		<item>GTQ</item>
+		<item>ZAR</item>
+		<item>OMR</item>
+		<item>KHR</item>
+		<item>MVR</item>
+		<item>IDR</item>
+		<item>RUB</item>
+		<item>RWF</item>
+		<item>SHP</item>
+		<item>SAR</item>
+		<item>XDR</item>
+		<item>RSD</item>
+		<item>SCR</item>
+		<item>XAG</item>
+		<item>SGD</item>
+		<item>SBD</item>
+		<item>KGS</item>
+		<item>SOS</item>
+		<item>TJS</item>
+		<item>SSP</item>
+		<item>LKR</item>
+		<item>XSU</item>
+		<item>SDG</item>
+		<item>SRD</item>
+		<item>SEK</item>
+		<item>CHF</item>
+		<item>SYP</item>
+		<item>BDT</item>
+		<item>WST</item>
+		<item>TZS</item>
+		<item>KZT</item>
+		<item>XXX</item>
+		<item>TTD</item>
+		<item>MNT</item>
+		<item>TND</item>
+		<item>TRY</item>
+		<item>TMT</item>
+		<item>AED</item>
+		<item>UGX</item>
+		<item>XFU</item>
+		<item>COU</item>
+		<item>CLF</item>
+		<item>UYI</item>
+		<item>USD</item>
+		<item>UZS</item>
+		<item>VUV</item>
+		<item>CHE</item>
+		<item>CHW</item>
+		<item>KRW</item>
+		<item>YER</item>
+		<item>JPY</item>
+		<item>CNY</item>
+		<item>ZMK</item>
+		<item>ZWL</item>
+		<item>PLN</item>
+    </string-array>
+	<string-array name="default_accounts">
+	    <item>Ausgaben</item>
+	    <item>Einkommen</item>
+	    <item>Aktiva</item>	    
+	    <item>Unterhaltung</item>
+	    <item>Versicherung</item>
+	</string-array>
+	<string name="error_no_accounts">Keine Konten vorhanden.\nSie m&#252;ssen einen Konto erstellen um Widgets zu anzuf&#252;gen</string>
+	<string name="key_build_version">build_version</string>
+	<string name="title_build_version">Version</string>
+	<string name="title_license">Lizenz</string>
+	<string name="summary_licence_details">Apache License v2.0. Klicken f&#252;r Details</string>
+	<string name="title_general_prefs">Allgemein</string>
+	<string name="key_license">app_license</string>
+	<string name="label_widget_configuration">Konto ausw&#228;hlen</string>
+	<string name="toast_no_transactions_to_export">Keine Buchungen zum exportieren</string>
+	<string name="key_about">about_gnucash</string>
+	<string name="title_about_gnucash">&#220;ber Gnucash</string>
+	<string name="summary_about_gnucash">GnucashMobile ist eine mobile Datenaufzeichungs-App f&#252;r Android. \nEs erm&#246;glicht die schnelle und flexible Registrierung von Zahlungsvorg&#228;ngen unterwegs, die dann als Datei im OFX-Format exportiert und von der GnuCash-Anwendung an einem Desktop-PC importiert werden k&#246;nnen.</string>
+	<string name="title_about">&#220;ber</string>
+	<string name="ofx_file_exported_to">OFX-Datei exportiert nach:</string>
+	<string name="toast_error_exporting_ofx">Fehler beim Exportieren der OFX-Datei:\n</string>
+	<string name="toast_ofx_exported_to">OFX-Datei erfolgreich exportiert nach:\n</string>
+	<string name="title_export_email">Gnucash exportierte OFX-Datei</string>
+	<string name="description_export_email">Gnucash accounts export from </string>
+	<string name="header_transaction_settings">Buchungen</string>
+	<string name="title_transaction_preferences">Einstellungen Buchungen</string>
+	<string name="title_account_preferences">Einstellungen Konten</string>
+	<string name="key_default_transaction_type">default_transaction_type</string>
+	<string name="title_default_transaction_type">Voreinstellung Buchungsart</string>
+	<string name="summary_default_transaction_type">Die voreingestellte Buchungsart: Soll oder Haben</string>
+	<string-array name="transaction_types">
+		<item>Haben</item>
+		<item>Soll</item>
+	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+</resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index be8eb136..f245d2a9 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -44,7 +44,7 @@
     <string name="alert_dialog_cancel"></string>
     <string name="toast_account_deleted">  </string>
     <string name="title_confirm_delete"> </string>
-    <string name="delete_confirmation_message">       .</string>
+    <string name="delete_account_confirmation_message">       .</string>
     <string name="title_edit_transaction"> </string>
     <string name="label_transaction_description"></string>
     <string name="menu_move"></string>
@@ -479,5 +479,7 @@
 	<string-array name="transaction_types">
 		<item></item>
 		<item></item>
-	</string-array>	
+	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>	
 </resources>
diff --git a/GnucashMobile/res/values-es-rMX/strings.xml b/GnucashMobile/res/values-es-rMX/strings.xml
index 0bb41731..a7ab6979 100644
--- a/GnucashMobile/res/values-es-rMX/strings.xml
+++ b/GnucashMobile/res/values-es-rMX/strings.xml
@@ -43,7 +43,7 @@
     <string name="alert_dialog_cancel">Cancelar</string>
     <string name="toast_account_deleted">Cuenta borrada</string>
     <string name="title_confirm_delete">Confirmar borrado</string>
-    <string name="delete_confirmation_message">Todas las transacciones en esta cuenta tambi&#233;n ser&#225;n borradas</string>
+    <string name="delete_account_confirmation_message">Todas las transacciones en esta cuenta tambi&#233;n ser&#225;n borradas</string>
     <string name="title_edit_transaction">Editar transacci&#243;n</string>
     <string name="label_transaction_description">Descripci&#243;n</string>
     <string name="menu_move">Mover</string>
@@ -472,4 +472,6 @@
 		<item>CREDIT</item>
 		<item>DEBIT</item>
 	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 0a42c0a6..28c6d6d5 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -44,7 +44,7 @@
     <string name="alert_dialog_cancel">Cancelar</string>
     <string name="toast_account_deleted">Cuenta borrada</string>
     <string name="title_confirm_delete">Confirmar borrado</string>
-    <string name="delete_confirmation_message">Todas las transacciones en esta cuenta ser&#225;n tambi&#233;n borradas</string>
+    <string name="delete_account_confirmation_message">Todas las transacciones en esta cuenta ser&#225;n tambi&#233;n borradas</string>
     <string name="title_edit_transaction">Editar Transacci&#243;n</string>
     <string name="label_transaction_description">Nota</string>
     <string name="menu_move">MOVER</string>
@@ -473,4 +473,6 @@
 		<item>ABONO</item>
 		<item>CARGO</item>
 	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index 15499288..d4312df3 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -44,7 +44,7 @@
     <string name="alert_dialog_cancel">Annuler</string>
     <string name="toast_account_deleted">Compte supprim&#233;</string>
     <string name="title_confirm_delete">Confirmer la suppression</string>
-    <string name="delete_confirmation_message">Toute les transactions dans ce compte seront supprimer</string>
+    <string name="delete_account_confirmation_message">Toute les transactions dans ce compte seront supprimer</string>
     <string name="title_edit_transaction">Editer la transaction</string>
     <string name="label_transaction_description">Note</string>
     <string name="menu_move">DEPLACER</string>
@@ -474,4 +474,6 @@
 		<item>CREDIT</item>
 		<item>DEBIT</item>
 	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index 31233fb3..73d5ca11 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -44,7 +44,7 @@
     <string name="alert_dialog_cancel">Annulla</string>
     <string name="toast_account_deleted">Conto eliminato</string>
     <string name="title_confirm_delete">Conferma eliminazione</string>
-    <string name="delete_confirmation_message">Verranno eliminate anche tutte le transazioni in questo conto</string>
+    <string name="delete_account_confirmation_message">Verranno eliminate anche tutte le transazioni in questo conto</string>
     <string name="title_edit_transaction">Modifica transazione</string>
     <string name="label_transaction_description">Nota</string>
     <string name="menu_move">SPOSTA</string>
@@ -474,5 +474,7 @@
 		<item>CREDIT</item>
 		<item>DEBIT</item>
 	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
 
diff --git a/GnucashMobile/res/values-nb/strings.xml b/GnucashMobile/res/values-nb/strings.xml
index dae54883..932db9cd 100644
--- a/GnucashMobile/res/values-nb/strings.xml
+++ b/GnucashMobile/res/values-nb/strings.xml
@@ -45,7 +45,7 @@
     <string name="alert_dialog_cancel">Avbryt</string>
     <string name="toast_account_deleted">Konto slettet</string>
     <string name="title_confirm_delete">Bekreft sletting</string>
-    <string name="delete_confirmation_message">Alle transaksjoner tilhrende denne kontoen vil ogs bli slettet</string>
+    <string name="delete_account_confirmation_message">Alle transaksjoner tilhrende denne kontoen vil ogs bli slettet</string>
     <string name="title_edit_transaction">Rediger transaksjon</string>
     <string name="label_transaction_description">Notat</string>
     <string name="menu_move">FLYTT</string>
@@ -477,4 +477,6 @@ format og importeres i regnskapsprogrammet GnuCash for PC.</string>
 		<item>KREDIT</item>
 		<item>DEBET</item>
 	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
diff --git a/GnucashMobile/res/values-nl/strings.xml b/GnucashMobile/res/values-nl/strings.xml
index e730b72c..641ad40a 100644
--- a/GnucashMobile/res/values-nl/strings.xml
+++ b/GnucashMobile/res/values-nl/strings.xml
@@ -44,7 +44,7 @@
     <string name="alert_dialog_cancel">Annuleren</string>
     <string name="toast_account_deleted">Het dagboek werd verwijderd</string>
     <string name="title_confirm_delete">Verwijderen bevestigen</string>
-    <string name="delete_confirmation_message">Alle transacties in dit dagboek zullen ook verwijderd worden</string>
+    <string name="delete_account_confirmation_message">Alle transacties in dit dagboek zullen ook verwijderd worden</string>
     <string name="title_edit_transaction">Transactie bewerken</string>
     <string name="label_transaction_description">Opmerking</string>
     <string name="menu_move">Verplaatsen</string>
@@ -474,4 +474,6 @@
 		<item>CREDIT</item>
 		<item>DEBIT</item>
 	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index f0317e08..f2ab9a96 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -43,7 +43,7 @@
   <string name="alert_dialog_cancel">Cancelar</string>
   <string name="toast_account_deleted">Conta deletada</string>
   <string name="title_confirm_delete">Confirmao excluso</string>
-  <string name="delete_confirmation_message">Todas as transaes nesta conta tambm sero deletadas</string>
+  <string name="delete_account_confirmation_message">Todas as transaes nesta conta tambm sero deletadas</string>
   <string name="title_edit_transaction">Editar Transao</string>
   <string name="label_transaction_description">Nota</string>
   <string name="menu_move">MOVER</string>
@@ -472,4 +472,6 @@
     <item>CRDITO</item>
     <item>DBITO</item>
   </string-array>
+  <string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+  <string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index 5735d7c6..6cbf1fd3 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -44,7 +44,7 @@
     <string name="alert_dialog_cancel"></string>
     <string name="toast_account_deleted"> </string>
     <string name="title_confirm_delete"> </string>
-    <string name="delete_confirmation_message">     </string>
+    <string name="delete_account_confirmation_message">     </string>
     <string name="title_edit_transaction"> </string>
     <string name="label_transaction_description"></string>
     <string name="menu_move"></string>
@@ -474,4 +474,6 @@
 	    <item></item>
 	    <item></item>
 	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 861502e9..bf45056f 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -43,7 +43,7 @@
     <string name="alert_dialog_cancel">Cancel</string>
     <string name="toast_account_deleted">Account deleted</string>
     <string name="title_confirm_delete">Confirm delete</string>
-    <string name="delete_confirmation_message">All transactions in this account will also be deleted</string>
+    <string name="delete_account_confirmation_message">All transactions in this account will also be deleted</string>
     <string name="title_edit_transaction">Edit Transaction</string>
     <string name="label_transaction_description">Note</string>
     <string name="menu_move">MOVE</string>
@@ -473,4 +473,6 @@
 		<item>CREDIT</item>
 		<item>DEBIT</item>
 	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
index 0e4f6834..8e8c94ed 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
@@ -198,7 +198,7 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
             
             return new AlertDialog.Builder(getActivity())
                     .setIcon(android.R.drawable.ic_delete)
-                    .setTitle(title).setMessage(R.string.delete_confirmation_message)
+                    .setTitle(title).setMessage(R.string.delete_account_confirmation_message)
                     .setPositiveButton(R.string.alert_dialog_ok_delete,
                         new DialogInterface.OnClickListener() {
                             public void onClick(DialogInterface dialog, int whichButton) {
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
index 50112ded..8561d895 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
@@ -38,7 +38,7 @@
 import javax.xml.transform.stream.StreamResult;
 
 import org.gnucash.android.R;
-import org.gnucash.android.db.TransactionsDbAdapter;
+import org.gnucash.android.ui.transactions.TransactionsDeleteConfirmationDialog;
 import org.gnucash.android.util.OfxFormatter;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
@@ -153,16 +153,13 @@ public void onClick(View v) {
 			}
 			
 			if (mDeleteAllCheckBox.isChecked()){
-				TransactionsDbAdapter trxnAdapter = new TransactionsDbAdapter(getActivity());
-				trxnAdapter.deleteAllTransactions();
-				trxnAdapter.close();
+				Fragment currentFragment = getActivity().getSupportFragmentManager()
+						.findFragmentByTag(AccountsActivity.FRAGMENT_ACCOUNTS_LIST);
+				TransactionsDeleteConfirmationDialog alertFragment = TransactionsDeleteConfirmationDialog.newInstance(R.string.title_confirm_delete, 0);
+				alertFragment.setTargetFragment(currentFragment, 0);
+				alertFragment.show(getActivity().getSupportFragmentManager(), "transactions_delete_confirmation_dialog");
 			}
 			
-			Fragment f = getActivity()
-			.getSupportFragmentManager()
-			.findFragmentByTag(AccountsActivity.FRAGMENT_ACCOUNTS_LIST);
-		
-			((AccountsListFragment)f).refreshList();
 			dismiss();
 		}
 		
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/TransactionsDeleteConfirmationDialog.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/TransactionsDeleteConfirmationDialog.java
new file mode 100644
index 00000000..20dff644
--- /dev/null
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/TransactionsDeleteConfirmationDialog.java
@@ -0,0 +1,64 @@
+package org.gnucash.android.ui.transactions;
+
+import org.gnucash.android.R;
+import org.gnucash.android.db.TransactionsDbAdapter;
+import org.gnucash.android.ui.accounts.AccountsListFragment;
+
+import android.app.AlertDialog;
+import android.app.Dialog;
+import android.content.DialogInterface;
+import android.os.Bundle;
+
+import com.actionbarsherlock.app.SherlockDialogFragment;
+
+/**
+ * Displays a delete confirmation dialog for transactions
+ * If the transaction ID parameter is 0, then all transactions will be deleted
+ * @author Ngewi Fet <ngewif@gmail.com>
+ *
+ */
+public class TransactionsDeleteConfirmationDialog extends SherlockDialogFragment {
+
+    public static TransactionsDeleteConfirmationDialog newInstance(int title, long id) {
+        TransactionsDeleteConfirmationDialog frag = new TransactionsDeleteConfirmationDialog();
+        Bundle args = new Bundle();
+        args.putInt("title", title);
+        args.putLong(TransactionsListFragment.SELECTED_TRANSACTION_IDS, id);
+        frag.setArguments(args);
+        return frag;
+    }
+
+    @Override
+    public Dialog onCreateDialog(Bundle savedInstanceState) {
+        int title = getArguments().getInt("title");
+        final long rowId = getArguments().getLong(TransactionsListFragment.SELECTED_TRANSACTION_IDS);
+        int message = rowId == 0 ? R.string.delete_all_transactions_confirmation_message : R.string.delete_transaction_confirmation_message;
+        return new AlertDialog.Builder(getActivity())
+                .setIcon(android.R.drawable.ic_delete)
+                .setTitle(title).setMessage(message)
+                .setPositiveButton(R.string.alert_dialog_ok_delete,
+                    new DialogInterface.OnClickListener() {
+                        public void onClick(DialogInterface dialog, int whichButton) {
+                        	TransactionsDbAdapter adapter = new TransactionsDbAdapter(getSherlockActivity());                            
+                            if (rowId == 0){
+	                        	adapter.deleteAllTransactions();	                            
+                            } else {
+                            	adapter.deleteTransaction(rowId);
+                            }
+                            adapter.close();
+                            if (getTargetFragment() instanceof AccountsListFragment){                            	
+                            	((AccountsListFragment)getTargetFragment()).refreshList();
+                            }                                                        
+                        }
+                    }
+                )
+                .setNegativeButton(R.string.alert_dialog_cancel,
+                    new DialogInterface.OnClickListener() {
+                        public void onClick(DialogInterface dialog, int whichButton) {
+                        	dismiss();
+                        }
+                    }
+                )
+                .create();
+    }
+}
diff --git a/GnucashMobileTest/src/org/gnucash/android/test/ui/OfxExportTest.java b/GnucashMobileTest/src/org/gnucash/android/test/ui/OfxExportTest.java
index 5eefa04f..4445de11 100644
--- a/GnucashMobileTest/src/org/gnucash/android/test/ui/OfxExportTest.java
+++ b/GnucashMobileTest/src/org/gnucash/android/test/ui/OfxExportTest.java
@@ -105,6 +105,7 @@ public void testDeleteTransactionsAfterExport(){
 		mSolo.clickOnButton(3);
 		mSolo.waitForDialogToClose(10000);
 		
+		mSolo.clickOnText(getActivity().getString(R.string.alert_dialog_ok_delete));
 		TransactionsDbAdapter transAdapter = new TransactionsDbAdapter(getActivity());
 		assertEquals(0, transAdapter.getAllTransactionsCount());
 		
diff --git a/GnucashMobileTest/src/org/gnucash/android/test/ui/TransactionsActivityTest.java b/GnucashMobileTest/src/org/gnucash/android/test/ui/TransactionsActivityTest.java
index f345ce9a..970a436d 100644
--- a/GnucashMobileTest/src/org/gnucash/android/test/ui/TransactionsActivityTest.java
+++ b/GnucashMobileTest/src/org/gnucash/android/test/ui/TransactionsActivityTest.java
@@ -28,7 +28,6 @@
 import org.gnucash.android.data.Money;
 import org.gnucash.android.data.Transaction;
 import org.gnucash.android.db.AccountsDbAdapter;
-import org.gnucash.android.db.DatabaseAdapter;
 import org.gnucash.android.db.TransactionsDbAdapter;
 import org.gnucash.android.ui.transactions.NewTransactionFragment;
 import org.gnucash.android.ui.transactions.TransactionsActivity;
@@ -36,7 +35,6 @@
 
 import android.content.Context;
 import android.content.Intent;
-import android.database.Cursor;
 import android.support.v4.app.Fragment;
 import android.test.ActivityInstrumentationTestCase2;
 import android.widget.Spinner;

From be59010e7875c5208d74946421c6a2af3cf3b880 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jorge=20Mart=C3=ADnez=20L=C3=B3pez?= <jorgeml@gmail.com>
Date: Wed, 7 Nov 2012 08:17:50 +0000
Subject: [PATCH 02/12] Add translation for new message in commit
 5518b8a0c903685bec0423280eb7b50bf603257a

---
 GnucashMobile/res/values-es/strings.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 28c6d6d5..71b4247e 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -473,6 +473,6 @@
 		<item>ABONO</item>
 		<item>CARGO</item>
 	</string-array>
-	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="delete_all_transactions_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar TODAS las transacciones?</string>
+	<string name="delete_transaction_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar esta transacci&#243;n?</string>
 </resources>

From 04aa9413f3d85451c2f3405bf703a3d47b06c8f6 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 9 Nov 2012 14:51:08 +0100
Subject: [PATCH 03/12] Fixed: Default transaction type setting not working for
 non-English locales Improved French and German translations Improved and
 added tests (tests only really work reliably for Android 4.0) due to
 Robotium/ActionBarSherlock compatibility issues fixes #34, closes #36

---
 GnucashMobile/res/values-de/strings.xml            |   4 +-
 GnucashMobile/res/values-fr/strings.xml            |   8 +-
 GnucashMobile/res/values/strings.xml               |   4 +
 .../res/xml/fragment_transaction_preferences.xml   |   2 +-
 .../android/ui/accounts/AccountsListFragment.java  |   2 +-
 .../settings/TransactionsPreferenceFragment.java   |  11 +-
 .../android/test/ui/AccountsActivityTest.java      |  87 +++++-----
 .../org/gnucash/android/test/ui/OfxExportTest.java |  17 +-
 .../android/test/ui/TransactionsActivityTest.java  | 191 +++++++++++++--------
 9 files changed, 194 insertions(+), 132 deletions(-)

diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index adcc83e3..9b09d279 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -473,6 +473,6 @@
 		<item>Haben</item>
 		<item>Soll</item>
 	</string-array>
-	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="delete_all_transactions_confirmation_message">Wollen Sie wirklich ALLE Buchungen l&#246;schen?</string>
+	<string name="delete_transaction_confirmation_message">Wollen Sie wirklich diese Buchung l&#246;schen?</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index d4312df3..e2883c83 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -465,11 +465,11 @@
 	<string name="title_export_email">Gnucash OFX export</string>
 	<string name="description_export_email">Gnucash OFX Export von </string>
 	<string name="header_transaction_settings">Transactions</string>
-	<string name="title_transaction_preferences">Transaction Preferences</string>
-	<string name="title_account_preferences">Account Preferences</string>
+	<string name="title_transaction_preferences">Prfrences des transactions</string>
+	<string name="title_account_preferences">Prfrences du compte</string>
 	<string name="key_default_transaction_type">default_transaction_type</string>
-	<string name="title_default_transaction_type">Default Transaction Type</string>
-	<string name="summary_default_transaction_type">The type of transaction to use by default, CREDIT or DEBIT</string>
+	<string name="title_default_transaction_type">Type de transaction par dfaut</string>
+	<string name="summary_default_transaction_type">Le type de transaction  utiliser par dfaut, CREDIT ou DEBIT</string>
 	<string-array name="transaction_types">
 		<item>CREDIT</item>
 		<item>DEBIT</item>
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index bf45056f..0a3b6a3e 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -473,6 +473,10 @@
 		<item>CREDIT</item>
 		<item>DEBIT</item>
 	</string-array>
+	<string-array name="key_transaction_type_values">
+		<item>CREDIT</item>
+		<item>DEBIT</item>
+	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/xml/fragment_transaction_preferences.xml b/GnucashMobile/res/xml/fragment_transaction_preferences.xml
index 28c86a51..4c81f2a0 100644
--- a/GnucashMobile/res/xml/fragment_transaction_preferences.xml
+++ b/GnucashMobile/res/xml/fragment_transaction_preferences.xml
@@ -15,5 +15,5 @@
  limitations under the License.
 -->
 <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
-    <ListPreference android:title="@string/title_default_transaction_type" android:entryValues="@array/transaction_types" android:entries="@array/transaction_types" android:key="@string/key_default_transaction_type" android:summary="@string/summary_default_transaction_type"/>
+    <ListPreference android:title="@string/title_default_transaction_type" android:entryValues="@array/key_transaction_type_values" android:entries="@array/transaction_types" android:key="@string/key_default_transaction_type" android:summary="@string/summary_default_transaction_type"/>
 </PreferenceScreen>
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
index 8e8c94ed..caf36827 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
@@ -140,7 +140,7 @@
 		public boolean onCreateActionMode(ActionMode mode, Menu menu) {
 			MenuInflater inflater = mode.getMenuInflater();
 	        inflater.inflate(R.menu.account_context_menu, menu);
-	        mode.setTitle("1 selected");
+	        mode.setTitle(getString(R.string.title_selected, 1));
 	        return true;
 		}
 
diff --git a/GnucashMobile/src/org/gnucash/android/ui/settings/TransactionsPreferenceFragment.java b/GnucashMobile/src/org/gnucash/android/ui/settings/TransactionsPreferenceFragment.java
index db84e912..fa5b58e0 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/settings/TransactionsPreferenceFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/settings/TransactionsPreferenceFragment.java
@@ -53,17 +53,22 @@ public void onResume() {
 		
 		SharedPreferences manager = PreferenceManager.getDefaultSharedPreferences(getActivity());
 		String defaultTransactionType = manager.getString(getString(R.string.key_default_transaction_type), "DEBIT");
-		Preference pref = findPreference(getString(R.string.key_default_transaction_type));
-		pref.setSummary(defaultTransactionType);
+		Preference pref = findPreference(getString(R.string.key_default_transaction_type));		
+		setLocalizedSummary(pref, defaultTransactionType);
 		pref.setOnPreferenceChangeListener(this);
 	}
 
 
 	@Override
 	public boolean onPreferenceChange(Preference preference, Object newValue) {
-		preference.setSummary(newValue.toString());		
+		setLocalizedSummary(preference, newValue.toString());
 		return true;
 	}
 	
+	private void setLocalizedSummary(Preference preference, String value){
+		String localizedLabel = value.equals("DEBIT") ? getString(R.string.label_debit) : getActivity().getString(R.string.label_credit);
+		Preference pref = findPreference(getString(R.string.key_default_transaction_type));
+		pref.setSummary(localizedLabel);
+	}
 	
 }
diff --git a/GnucashMobileTest/src/org/gnucash/android/test/ui/AccountsActivityTest.java b/GnucashMobileTest/src/org/gnucash/android/test/ui/AccountsActivityTest.java
index 9f2290a7..d5826812 100644
--- a/GnucashMobileTest/src/org/gnucash/android/test/ui/AccountsActivityTest.java
+++ b/GnucashMobileTest/src/org/gnucash/android/test/ui/AccountsActivityTest.java
@@ -36,6 +36,7 @@
 import android.preference.PreferenceManager;
 import android.support.v4.app.Fragment;
 import android.test.ActivityInstrumentationTestCase2;
+import android.widget.Button;
 import android.widget.ListView;
 import android.widget.TextView;
 
@@ -81,7 +82,7 @@ public void testCreateAccount(){
 		else
 			mSolo.clickOnImage(1);
 		
-		mSolo.waitForText("Create");
+		mSolo.waitForText(getActivity().getString(R.string.title_add_account));
 		mSolo.enterText(0, "New Account");
 		
 		mSolo.clickOnText(getActivity().getString(R.string.btn_save));
@@ -139,6 +140,49 @@ public void testEditAccount(){
 		accAdapter.close();
 	}
 	
+	public void testDeleteAccount(){		
+			Account acc = new Account("TO BE DELETED");
+			acc.setUID("to-be-deleted");
+			
+			Transaction transaction = new Transaction("5.99", "hats");
+			transaction.setAccountUID("to-be-deleted");
+			acc.addTransaction(transaction);
+			AccountsDbAdapter accDbAdapter = new AccountsDbAdapter(getActivity());
+			accDbAdapter.addAccount(acc);		
+			
+			Fragment fragment = getActivity()
+					.getSupportFragmentManager()
+					.findFragmentByTag(AccountsActivity.FRAGMENT_ACCOUNTS_LIST);
+			assertNotNull(fragment);
+			
+			((AccountsListFragment) fragment).refreshList();
+			
+			mSolo.clickLongOnText("TO BE DELETED");
+							
+			mSolo.clickOnImage(2);
+			//robotium and Sherloock context actionbar don't play nice
+	//		mSolo.clickOnActionBarItem(R.id.context_menu_delete);
+						
+			String deleteConfirm = getActivity().getString(R.string.alert_dialog_ok_delete);
+			Button b = mSolo.getButton(deleteConfirm);
+			mSolo.clickOnView(b);
+			//FIXME: deletion fails often because the confirmation dialog cannot be confirmed
+			//we could also click on the button position, but it is different pre and post 4.0
+			
+			mSolo.waitForDialogToClose(1000);
+			
+			long id = accDbAdapter.getAccountID("to-be-deleted");
+			assertEquals(-1, id);
+			
+			TransactionsDbAdapter transDbAdapter = new TransactionsDbAdapter(getActivity());
+			List<Transaction> transactions = transDbAdapter.getAllTransactionsForAccount("to-be-deleted");
+			
+			assertEquals(0, transactions.size());
+			
+			accDbAdapter.close();
+			transDbAdapter.close();
+		}
+
 	public void testDisplayTransactionsList(){	
 		Fragment fragment = getActivity()
 				.getSupportFragmentManager()
@@ -162,47 +206,6 @@ public void testDisplayTransactionsList(){
 		
 	}
 		
-	public void testDeleteAccount(){		
-		Account acc = new Account("TO BE DELETED");
-		acc.setUID("to-be-deleted");
-		
-		Transaction transaction = new Transaction("5.99", "hats");
-		transaction.setAccountUID("to-be-deleted");
-		acc.addTransaction(transaction);
-		AccountsDbAdapter accDbAdapter = new AccountsDbAdapter(getActivity());
-		accDbAdapter.addAccount(acc);		
-		
-		Fragment fragment = getActivity()
-				.getSupportFragmentManager()
-				.findFragmentByTag(AccountsActivity.FRAGMENT_ACCOUNTS_LIST);
-		assertNotNull(fragment);
-		
-		((AccountsListFragment) fragment).refreshList();
-		
-		mSolo.clickLongOnText("TO BE DELETED");
-		
-		mSolo.waitForText(getActivity().getString(R.string.title_edit_account));
-		
-		mSolo.clickOnImage(2);
-		
-		mSolo.clickOnText(getActivity().getString(R.string.alert_dialog_ok_delete));
-		//FIXME: deletion fails often because the confirmation dialog cannot be confirmed
-		//we could also click on the button position, but it is different pre and post 4.0
-		
-		mSolo.waitForDialogToClose(1000);
-		
-		long id = accDbAdapter.getAccountID("to-be-deleted");
-		assertEquals(-1, id);
-		
-		TransactionsDbAdapter transDbAdapter = new TransactionsDbAdapter(getActivity());
-		List<Transaction> transactions = transDbAdapter.getAllTransactionsForAccount("to-be-deleted");
-		
-		assertEquals(0, transactions.size());
-		
-		accDbAdapter.close();
-		transDbAdapter.close();
-	}
-	
 	public void testIntentAccountCreation(){
 		Intent intent = new Intent(Intent.ACTION_INSERT);
 		intent.putExtra(Intent.EXTRA_TITLE, "Intent Account");
diff --git a/GnucashMobileTest/src/org/gnucash/android/test/ui/OfxExportTest.java b/GnucashMobileTest/src/org/gnucash/android/test/ui/OfxExportTest.java
index 4445de11..ca7744a2 100644
--- a/GnucashMobileTest/src/org/gnucash/android/test/ui/OfxExportTest.java
+++ b/GnucashMobileTest/src/org/gnucash/android/test/ui/OfxExportTest.java
@@ -28,6 +28,7 @@
 
 import android.os.Environment;
 import android.test.ActivityInstrumentationTestCase2;
+import android.widget.Button;
 import android.widget.Spinner;
 
 import com.jayway.android.robotium.solo.Solo;
@@ -91,8 +92,10 @@ public void testOfxExport(){
 	}	
 	
 	public void testDeleteTransactionsAfterExport(){
-		mSolo.clickOnActionBarItem(R.id.menu_export);
+		TransactionsDbAdapter transAdapter = new TransactionsDbAdapter(getActivity());
+		assertTrue(transAdapter.getAllTransactionsCount() != 0);
 		
+		mSolo.clickOnActionBarItem(R.id.menu_export);		
 		mSolo.waitForText("Export OFX");
 		Spinner spinner = mSolo.getCurrentSpinners().get(0);
 		mSolo.clickOnView(spinner);
@@ -102,11 +105,15 @@ public void testDeleteTransactionsAfterExport(){
 		//check to delete after export
 		mSolo.clickOnCheckBox(1);
 		
-		mSolo.clickOnButton(3);
-		mSolo.waitForDialogToClose(10000);
+		Button b = (Button) mSolo.getView(R.id.btn_save);
+		mSolo.clickOnView(b);
+		mSolo.waitForDialogToClose(2000);
+		
+		//confirm delete
+		Button deleteButton = (Button) mSolo.getView(android.R.id.button1);
+		mSolo.clickOnView(deleteButton);
+		mSolo.waitForDialogToClose(1000);
 		
-		mSolo.clickOnText(getActivity().getString(R.string.alert_dialog_ok_delete));
-		TransactionsDbAdapter transAdapter = new TransactionsDbAdapter(getActivity());
 		assertEquals(0, transAdapter.getAllTransactionsCount());
 		
 		transAdapter.close();
diff --git a/GnucashMobileTest/src/org/gnucash/android/test/ui/TransactionsActivityTest.java b/GnucashMobileTest/src/org/gnucash/android/test/ui/TransactionsActivityTest.java
index 970a436d..38479569 100644
--- a/GnucashMobileTest/src/org/gnucash/android/test/ui/TransactionsActivityTest.java
+++ b/GnucashMobileTest/src/org/gnucash/android/test/ui/TransactionsActivityTest.java
@@ -35,9 +35,15 @@
 
 import android.content.Context;
 import android.content.Intent;
+import android.content.SharedPreferences;
+import android.content.SharedPreferences.Editor;
+import android.preference.PreferenceManager;
 import android.support.v4.app.Fragment;
 import android.test.ActivityInstrumentationTestCase2;
+import android.view.View;
 import android.widget.Spinner;
+import android.widget.TextView;
+import android.widget.ToggleButton;
 
 import com.jayway.android.robotium.solo.Solo;
 
@@ -98,55 +104,30 @@ private int getTranscationCount(){
 	
 	private void validateNewTransactionFields(){
 		String expectedValue = NewTransactionFragment.DATE_FORMATTER.format(new Date(mTransactionTimeMillis));
-		String actualValue = mSolo.getText(6).getText().toString();
+		TextView dateView = (TextView) mSolo.getView(R.id.input_date);//(TextView) getActivity().findViewById(R.id.input_date);
+		String actualValue = dateView.getText().toString();
 		assertEquals(expectedValue, actualValue);
 		
 		expectedValue = NewTransactionFragment.TIME_FORMATTER.format(new Date(mTransactionTimeMillis));
-		actualValue = mSolo.getText(7).getText().toString();
+		TextView timeView = (TextView) mSolo.getView(R.id.input_time); //(TextView) getActivity().findViewById(R.id.input_time);
+		actualValue = timeView.getText().toString();
 		assertEquals(expectedValue, actualValue);
 		
 	}
 	
-	public void testAddTransaction(){	
-		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
-		validateTransactionListDisplayed();
-		
-		//Android 2.2 cannot handle this for some reason, use image instead
-//		mSolo.clickOnActionBarItem(R.id.menu_add_transaction);
-		mSolo.clickOnImage(2);
-		mSolo.waitForText("Description");
-		
-		validateNewTransactionFields();
-		
-		//validate creation of transaction
-		mSolo.enterText(0, "Lunch");
-		mSolo.enterText(1, "899");
-		//check that the amount is correctly converted in the input field
-		String value = mSolo.getEditText(1).getText().toString();
-		String expectedValue = NumberFormat.getInstance().format(-8.99); 
-		assertEquals(expectedValue, value);
-		
-		int transactionsCount = getTranscationCount();
-		
-		//Android 2.2 cannot handle this for some reason
-//		mSolo.clickOnActionBarItem(R.id.menu_save);	
-		mSolo.clickOnImage(3);
-		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
-		validateTransactionListDisplayed();
-		
-		assertEquals(transactionsCount + 1, getTranscationCount());
-	}
-	
 	public void testAddTransactionShouldRequireAmount(){
 		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
 		validateTransactionListDisplayed();
 		
 		TransactionsDbAdapter adapter = new TransactionsDbAdapter(getActivity());
 		int beforeCount = adapter.getTransactionsCount(adapter.getAccountID(DUMMY_ACCOUNT_UID));
-		mSolo.clickOnImage(2);
+		mSolo.clickOnActionBarItem(R.id.menu_add_transaction);
 		mSolo.waitForText("Description");
 		mSolo.enterText(0, "Lunch");
-		assertEquals(false, mSolo.getImage(3).isEnabled());
+		
+		//verify that only text does not enable save button
+		View saveButtonView = mSolo.getView(R.id.menu_save);				
+		assertFalse(saveButtonView.isEnabled());//mSolo.getImage(3).isEnabled());
 		mSolo.clickOnActionBarItem(R.id.btn_save);
 		
 		int afterCount = adapter.getTransactionsCount(adapter.getAccountID(DUMMY_ACCOUNT_UID));
@@ -172,49 +153,46 @@ private void validateEditTransactionFields(Transaction transaction){
 		assertEquals(transaction.getDescription(), description);
 		
 		String expectedValue = NewTransactionFragment.DATE_FORMATTER.format(transaction.getTimeMillis());
-		String actualValue = mSolo.getText(6).getText().toString();
+		TextView dateView = (TextView) mSolo.getView(R.id.input_date);
+		String actualValue = dateView.getText().toString(); //mSolo.getText(6).getText().toString();
 		assertEquals(expectedValue, actualValue);
 		
 		expectedValue = NewTransactionFragment.TIME_FORMATTER.format(transaction.getTimeMillis());
-		actualValue = mSolo.getText(7).getText().toString();
+		TextView timeView = (TextView) mSolo.getView(R.id.input_time);
+		actualValue = timeView.getText().toString();// mSolo.getText(7).getText().toString();
 		assertEquals(expectedValue, actualValue);
 	}
 	
-	public void testOpenTransactionEditShouldNotModifyTransaction(){
-		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
-		
-		validateTransactionListDisplayed();
-		
-		mSolo.clickOnText(TRANSACTION_NAME);
-		mSolo.waitForText("Note");
-		
-		validateNewTransactionFields();
-		
-		mSolo.clickOnActionBarItem(R.id.menu_save);
-		
-		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
-		
-		TransactionsDbAdapter adapter = new TransactionsDbAdapter(getActivity());
-		List<Transaction> transactions = adapter.getAllTransactionsForAccount(DUMMY_ACCOUNT_UID);
-		
-		assertEquals(1, transactions.size());
-		Transaction trx = transactions.get(0);
-		assertEquals(TRANSACTION_NAME, trx.getName());
-		assertEquals(trx.getAccountUID(), DUMMY_ACCOUNT_UID);
-		Date expectedDate = new Date(mTransactionTimeMillis);
-		Date trxDate = new Date(trx.getTimeMillis());
-		assertEquals(NewTransactionFragment.DATE_FORMATTER.format(expectedDate), 
-				NewTransactionFragment.DATE_FORMATTER.format(trxDate));
-		assertEquals(NewTransactionFragment.TIME_FORMATTER.format(expectedDate), 
-				NewTransactionFragment.TIME_FORMATTER.format(trxDate));
-		
-		//FIXME: for some reason, the expected time is higher (in the future) than the actual time
-		//this should not be the case since the transaction was created with the expected time
-		//I guess it has to do with the time precision and the fact that the time is repeatedly 
-		//converted to Date objects and back. But just validating the printable date and time should be ok
-//		assertEquals(mTransactionTimeMillis, trx.getTimeMillis());
-	}
-	
+	public void testAddTransaction(){	
+			mSolo.waitForText(DUMMY_ACCOUNT_NAME);
+			validateTransactionListDisplayed();
+			
+			//Android 2.2 cannot handle this for some reason, use image instead
+			mSolo.clickOnActionBarItem(R.id.menu_add_transaction);
+//			mSolo.clickOnImage(2);
+			mSolo.waitForText("Description");
+			
+			validateNewTransactionFields();
+			
+			//validate creation of transaction
+			mSolo.enterText(0, "Lunch");
+			mSolo.enterText(1, "899");
+			//check that the amount is correctly converted in the input field
+			String value = mSolo.getEditText(1).getText().toString();
+			String expectedValue = NumberFormat.getInstance().format(-8.99); 
+			assertEquals(expectedValue, value);
+			
+			int transactionsCount = getTranscationCount();
+			
+			//Android 2.2 cannot handle this for some reason
+			mSolo.clickOnActionBarItem(R.id.menu_save);	
+//			mSolo.clickOnImage(3);
+			mSolo.waitForText(DUMMY_ACCOUNT_NAME);
+			validateTransactionListDisplayed();
+			
+			assertEquals(transactionsCount + 1, getTranscationCount());
+		}
+
 	public void testEditTransaction(){		
 		//open transactions
 		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
@@ -233,6 +211,33 @@ public void testEditTransaction(){
 		mSolo.waitForText("Pasta");
 	}
 	
+	public void testDefaultTransactionType(){
+		SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getActivity());
+		Editor editor = prefs.edit();
+		editor.putString(getActivity().getString(R.string.key_default_transaction_type), "CREDIT");
+		editor.commit();
+		
+		mSolo.clickOnActionBarItem(R.id.menu_add_transaction);
+		mSolo.waitForText(getActivity().getString(R.string.label_transaction_name));
+		
+//		ToggleButton transactionTypeButton = (ToggleButton) mSolo.getView(R.id.input_transaction_type); 
+		ToggleButton transactionTypeButton = (ToggleButton) mSolo.getButton(0);
+		assertTrue(transactionTypeButton.isChecked() == false);
+		
+		mSolo.clickOnActionBarItem(R.id.menu_cancel);
+		
+		//now validate the other case 
+		editor = prefs.edit();
+		editor.putString(getActivity().getString(R.string.key_default_transaction_type), "DEBIT");
+		editor.commit();
+		
+		mSolo.clickOnActionBarItem(R.id.menu_add_transaction);
+		mSolo.waitForText(getActivity().getString(R.string.label_transaction_name));
+		
+		transactionTypeButton = (ToggleButton) mSolo.getButton(0);
+		assertTrue(transactionTypeButton.isChecked());
+	}
+
 	public void testToggleTransactionType(){
 		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
 		
@@ -254,7 +259,8 @@ public void testToggleTransactionType(){
 		assertEquals("-9.99", amount.toPlainString());
 		
 		//save the transaction, should now be a debit
-		mSolo.clickOnImage(3);
+//		mSolo.clickOnImage(3);
+		mSolo.clickOnActionBarItem(R.id.menu_save);
 		
 		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
 		
@@ -266,10 +272,45 @@ public void testToggleTransactionType(){
 		assertTrue(trx.getAmount().isNegative());
 	}
 	
+	public void testOpenTransactionEditShouldNotModifyTransaction(){
+			mSolo.waitForText(DUMMY_ACCOUNT_NAME);
+			
+			validateTransactionListDisplayed();
+			
+			mSolo.clickOnText(TRANSACTION_NAME);
+			mSolo.waitForText("Note");
+			
+			validateNewTransactionFields();
+			
+			mSolo.clickOnActionBarItem(R.id.menu_save);
+			
+			mSolo.waitForText(DUMMY_ACCOUNT_NAME);
+			
+			TransactionsDbAdapter adapter = new TransactionsDbAdapter(getActivity());
+			List<Transaction> transactions = adapter.getAllTransactionsForAccount(DUMMY_ACCOUNT_UID);
+			
+			assertEquals(1, transactions.size());
+			Transaction trx = transactions.get(0);
+			assertEquals(TRANSACTION_NAME, trx.getName());
+			assertEquals(trx.getAccountUID(), DUMMY_ACCOUNT_UID);
+			Date expectedDate = new Date(mTransactionTimeMillis);
+			Date trxDate = new Date(trx.getTimeMillis());
+			assertEquals(NewTransactionFragment.DATE_FORMATTER.format(expectedDate), 
+					NewTransactionFragment.DATE_FORMATTER.format(trxDate));
+			assertEquals(NewTransactionFragment.TIME_FORMATTER.format(expectedDate), 
+					NewTransactionFragment.TIME_FORMATTER.format(trxDate));
+			
+			//FIXME: for some reason, the expected time is higher (in the future) than the actual time
+			//this should not be the case since the transaction was created with the expected time
+			//I guess it has to do with the time precision and the fact that the time is repeatedly 
+			//converted to Date objects and back. But just validating the printable date and time should be ok
+	//		assertEquals(mTransactionTimeMillis, trx.getTimeMillis());
+		}
+
 	public void testDeleteTransaction(){
 		mSolo.waitForText(DUMMY_ACCOUNT_NAME);
 		
-		mSolo.clickOnCheckBox(0);
+		mSolo.clickOnCheckBox(0);		
 		mSolo.clickOnImage(2);
 		
 		AccountsDbAdapter accAdapter = new AccountsDbAdapter(getActivity());
@@ -295,7 +336,9 @@ public void testBulkMoveTransactions(){
 		validateTransactionListDisplayed();
 		
 		mSolo.clickOnCheckBox(0);
-		mSolo.clickOnImage(1);
+		mSolo.waitForText(getActivity().getString(R.string.title_selected, 1));
+		//initiate bulk move
+		mSolo.clickOnImage(1);		
 		
 		mSolo.waitForDialogToClose(2000);
 		

From a55d395d71b08986208a61c8582701fbd6135987 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 9 Nov 2012 15:50:54 +0100
Subject: [PATCH 04/12] Added default export settings (closes #17)

---
 GnucashMobile/res/values-de/strings.xml                   | 11 ++++++++++-
 GnucashMobile/res/values-el/strings.xml                   | 10 +++++++++-
 GnucashMobile/res/values-es-rMX/strings.xml               |  8 ++++++++
 GnucashMobile/res/values-es/strings.xml                   |  8 ++++++++
 GnucashMobile/res/values-fr/strings.xml                   |  8 ++++++++
 GnucashMobile/res/values-it/strings.xml                   |  8 ++++++++
 GnucashMobile/res/values-nb/strings.xml                   |  8 ++++++++
 GnucashMobile/res/values-nl/strings.xml                   |  8 ++++++++
 GnucashMobile/res/values-pt-rBR/strings.xml               |  8 ++++++++
 GnucashMobile/res/values-ru/strings.xml                   |  8 ++++++++
 GnucashMobile/res/values/strings.xml                      |  8 ++++++++
 GnucashMobile/res/xml/fragment_general_preferences.xml    |  9 +++++++++
 .../gnucash/android/ui/accounts/ExportDialogFragment.java | 13 ++++++++++++-
 .../android/ui/settings/GeneralPreferenceFragment.java    | 15 +++++++++++++++
 14 files changed, 127 insertions(+), 3 deletions(-)

diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index 9b09d279..6f484d1c 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -474,5 +474,14 @@
 		<item>Soll</item>
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Wollen Sie wirklich ALLE Buchungen l&#246;schen?</string>
-	<string name="delete_transaction_confirmation_message">Wollen Sie wirklich diese Buchung l&#246;schen?</string>
+	<string name="delete_transaction_confirmation_message">Wollen Sie wirklich diese Buchung l&#246;schen?</string>	
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
+	
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index f245d2a9..1d8ab706 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -481,5 +481,13 @@
 		<item></item>
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>	
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>		
 </resources>
diff --git a/GnucashMobile/res/values-es-rMX/strings.xml b/GnucashMobile/res/values-es-rMX/strings.xml
index a7ab6979..c2521460 100644
--- a/GnucashMobile/res/values-es-rMX/strings.xml
+++ b/GnucashMobile/res/values-es-rMX/strings.xml
@@ -474,4 +474,12 @@
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 71b4247e..f98a476b 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -475,4 +475,12 @@
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar TODAS las transacciones?</string>
 	<string name="delete_transaction_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar esta transacci&#243;n?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
 </resources>
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index e2883c83..84113769 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -476,4 +476,12 @@
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index 73d5ca11..72511ea1 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -476,5 +476,13 @@
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
 
diff --git a/GnucashMobile/res/values-nb/strings.xml b/GnucashMobile/res/values-nb/strings.xml
index 932db9cd..01c3b002 100644
--- a/GnucashMobile/res/values-nb/strings.xml
+++ b/GnucashMobile/res/values-nb/strings.xml
@@ -479,4 +479,12 @@ format og importeres i regnskapsprogrammet GnuCash for PC.</string>
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
diff --git a/GnucashMobile/res/values-nl/strings.xml b/GnucashMobile/res/values-nl/strings.xml
index 641ad40a..62f59aaf 100644
--- a/GnucashMobile/res/values-nl/strings.xml
+++ b/GnucashMobile/res/values-nl/strings.xml
@@ -476,4 +476,12 @@
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index f2ab9a96..38f3781e 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -474,4 +474,12 @@
   </string-array>
   <string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
   <string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+  <string name="title_export_preference_category">Export</string>
+  <string name="key_export_all_transactions">export_all_transactions</string>
+  <string name="title_export_all_transactions">Always export all transactions</string>
+  <string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+  <string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+  <string name="key_default_export_email">export_email_target</string>
+  <string name="title_default_export_email">Default export email</string>
+  <string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>  
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index 6cbf1fd3..292b0599 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -476,4 +476,12 @@
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 0a3b6a3e..cbe54793 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -479,4 +479,12 @@
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="key_export_all_transactions">export_all_transactions</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="key_default_export_email">export_email_target</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/xml/fragment_general_preferences.xml b/GnucashMobile/res/xml/fragment_general_preferences.xml
index f3435d26..ff63cf99 100644
--- a/GnucashMobile/res/xml/fragment_general_preferences.xml
+++ b/GnucashMobile/res/xml/fragment_general_preferences.xml
@@ -22,6 +22,15 @@
         android:title="@string/title_default_currency" 
         android:entries="@array/currency_names" 
         android:entryValues="@array/currency_codes"/>
+    <PreferenceCategory android:title="@string/title_export_preference_category">
+        <EditTextPreference android:title="@string/title_default_export_email" 
+            android:key="@string/key_default_export_email" 
+            android:summary="@string/summary_default_export_email"
+            android:inputType="textEmailAddress"/>
+        <CheckBoxPreference android:summary="@string/hint_export_choice" android:key="@string/key_export_all_transactions" android:title="@string/title_export_all_transactions"/>
+        <CheckBoxPreference android:summary="@string/hint_delete_after_export" android:key="@string/key_delete_transactions_after_export" android:title="@string/title_always_delete_exported_transactions"/>
+        
+    </PreferenceCategory>
     
 
 </PreferenceScreen>
\ No newline at end of file
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
index 8561d895..cfc10092 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
@@ -46,9 +46,11 @@
 
 import android.app.Activity;
 import android.content.Intent;
+import android.content.SharedPreferences;
 import android.net.Uri;
 import android.os.Bundle;
 import android.os.Environment;
+import android.preference.PreferenceManager;
 import android.support.v4.app.DialogFragment;
 import android.support.v4.app.Fragment;
 import android.util.Log;
@@ -182,7 +184,7 @@ public void onActivityCreated(Bundle savedInstanceState) {
 	/**
 	 * Collects references to the UI elements and binds click listeners
 	 */
-	private void bindViews(){
+	private void bindViews(){		
 		View v = getView();
 		mDestinationSpinner = (Spinner) v.findViewById(R.id.spinner_export_destination);
 		ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(getActivity(),
@@ -190,8 +192,12 @@ private void bindViews(){
 		adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);		
 		mDestinationSpinner.setAdapter(adapter);
 		
+		SharedPreferences sharedPrefs = PreferenceManager.getDefaultSharedPreferences(getActivity());
 		mExportAllCheckBox = (CheckBox) v.findViewById(R.id.checkbox_export_all);
+		mExportAllCheckBox.setChecked(sharedPrefs.getBoolean(getString(R.string.key_export_all_transactions), false));
+		
 		mDeleteAllCheckBox = (CheckBox) v.findViewById(R.id.checkbox_post_export_delete);
+		mDeleteAllCheckBox.setChecked(sharedPrefs.getBoolean(getString(R.string.key_delete_transactions_after_export), false));
 		
 		mSaveButton = (Button) v.findViewById(R.id.btn_save);
 		mSaveButton.setText(R.string.btn_export);
@@ -240,10 +246,15 @@ public void onActivityResult(int requestCode, int resultCode, Intent data) {
 	 * @param path String path to the file on disk
 	 */
 	private void shareFile(String path){
+		String defaultEmail = PreferenceManager.getDefaultSharedPreferences(getActivity())
+												.getString(getString(R.string.key_default_export_email), null);
 		Intent shareIntent = new Intent(Intent.ACTION_SEND);
 		shareIntent.setType("application/xml");
 		shareIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://"+ path));
 		shareIntent.putExtra(Intent.EXTRA_SUBJECT, getString(R.string.title_export_email));
+		if (defaultEmail != null && defaultEmail.trim().length() > 0){
+			shareIntent.putExtra(Intent.EXTRA_EMAIL, new String[]{defaultEmail});
+		}			
 		SimpleDateFormat formatter = new SimpleDateFormat("yyyy.MM.dd HH:mm");
 		shareIntent.putExtra(Intent.EXTRA_TEXT, getString(R.string.description_export_email) 
 							+ formatter.format(new Date(System.currentTimeMillis())));
diff --git a/GnucashMobile/src/org/gnucash/android/ui/settings/GeneralPreferenceFragment.java b/GnucashMobile/src/org/gnucash/android/ui/settings/GeneralPreferenceFragment.java
index a99961ab..271b76b8 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/settings/GeneralPreferenceFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/settings/GeneralPreferenceFragment.java
@@ -57,6 +57,14 @@ public void onResume() {
 		Preference pref = findPreference(getString(R.string.key_default_currency));
 		pref.setSummary(defaultCurrency);
 		pref.setOnPreferenceChangeListener(this);
+		
+		String keyDefaultEmail = getString(R.string.key_default_export_email);		
+		pref = findPreference(keyDefaultEmail);
+		String defaultEmail = manager.getString(keyDefaultEmail, null);
+		if (defaultEmail != null && !defaultEmail.trim().isEmpty()){
+			pref.setSummary(defaultEmail);			
+		}
+		pref.setOnPreferenceChangeListener(this);
 	}
 
 	@Override
@@ -65,6 +73,13 @@ public boolean onPreferenceChange(Preference preference, Object newValue) {
 		if (preference.getKey().equals(getString(R.string.key_default_currency))){
 			Money.DEFAULT_CURRENCY_CODE = newValue.toString();
 		}
+		
+		if (preference.getKey().equals(getString(R.string.key_default_export_email))){
+			String emailSetting = newValue.toString();
+			if (emailSetting == null || emailSetting.trim().isEmpty()){
+				preference.setSummary(R.string.summary_default_export_email);
+			}					
+		}
 		return true;
 	}
 

From 15e261b410d5e2e1620db673c083148bff01a973 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 9 Nov 2012 16:33:01 +0100
Subject: [PATCH 05/12] Preparing for 1.0.2 release

---
 CHANGELOG.md                      | 6 ++++++
 GnucashMobile/AndroidManifest.xml | 4 ++--
 2 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 297e8af7..4de7aa36 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,5 +1,11 @@
 Change Log
 ===============================================================================
+Version 1.0.2 *(2012-11-09)*
+----------------------------
+Fixed: Default transaction type setting not working for non-English locales
+Added new default settings for exporting
+Improved French and German translations
+
 
 Version 1.0.1 *(2012-11-05)*
 ----------------------------
diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index ca2766d2..7b45c16a 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -17,8 +17,8 @@
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="org.gnucash.android"
-    android:versionCode="2"
-    android:versionName="1.0.1" >
+    android:versionCode="3"
+    android:versionName="1.0.2" >
 
     <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15"/>
     

From 5a0f3a7af193008dae0a7b229edd96488ecb48e0 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 9 Nov 2012 16:48:15 +0100
Subject: [PATCH 06/12] Updated changelog

---
 CHANGELOG.md | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 4de7aa36..b7524a94 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,10 +1,12 @@
 Change Log
 ===============================================================================
+
 Version 1.0.2 *(2012-11-09)*
 ----------------------------
-Fixed: Default transaction type setting not working for non-English locales
-Added new default settings for exporting
-Improved French and German translations
+
+* Fixed: Default transaction type setting not working for non-English locales
+* Added new default settings for exporting
+* Improved French and German translations
 
 
 Version 1.0.1 *(2012-11-05)*

From bc300d8caac312abe16220d4d2846e7ac568849c Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Sun, 11 Nov 2012 20:51:29 +0100
Subject: [PATCH 07/12] Fixed: Locale en_UK causing crashes when creating
 accounts

---
 .../src/org/gnucash/android/ui/accounts/AccountsActivity.java      | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
index 9c4453e3..d197657c 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
@@ -92,8 +92,13 @@ public void onCreate(Bundle savedInstanceState) {
 		setContentView(R.layout.activity_accounts);
 
 		SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
+		Locale locale = Locale.getDefault();
+		//sometimes the locale en_UK is returned which causes a crash with Currency
+		if (locale.getCountry().equals("UK")) {
+		    locale = new Locale(locale.getLanguage(), "GB");
+		}
 		String currencyCode = prefs.getString(getString(R.string.key_default_currency), 
-				Currency.getInstance(Locale.getDefault()).getCurrencyCode());		
+				Currency.getInstance(locale).getCurrencyCode());		
 		Money.DEFAULT_CURRENCY_CODE = currencyCode;		
 		
 		boolean firstRun = prefs.getBoolean(getString(R.string.key_first_run), true);

From eb71ddc5f596c4051583487fb2a32da3efb649d9 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jorge=20Mart=C3=ADnez=20L=C3=B3pez?= <jorgeml@gmail.com>
Date: Mon, 12 Nov 2012 12:05:21 +0000
Subject: [PATCH 08/12] Translated new strings to Spanish (ES).

---
 GnucashMobile/res/values-es/strings.xml | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index f98a476b..7225c8b1 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -475,12 +475,12 @@
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar TODAS las transacciones?</string>
 	<string name="delete_transaction_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar esta transacci&#243;n?</string>
-	<string name="title_export_preference_category">Export</string>
+	<string name="title_export_preference_category">Exportaci&#243;n</string>
 	<string name="key_export_all_transactions">export_all_transactions</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="title_export_all_transactions">Exportar siempre todas las transacciones</string>
 	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_always_delete_exported_transactions">Borrar siempre todas las transacciones exportadas</string>
 	<string name="key_default_export_email">export_email_target</string>
-	<string name="title_default_export_email">Default export email</string>
-	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
+	<string name="title_default_export_email">Correo electr&#243;nico por defecto para exportar</string>
+	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Puedes cambiarla en cada exportaci&#243;n.</string>
 </resources>

From 08077ce0a231b4ab6ce893e515d66af27f4cb03a Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Thu, 15 Nov 2012 00:15:51 +0100
Subject: [PATCH 09/12] Improved Italian translation

---
 GnucashMobile/res/values-it/strings.xml | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index 72511ea1..9a55bd05 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -464,15 +464,15 @@
 	<string name="toast_ofx_exported_to">File OFX esportato in:\n</string>
 	<string name="title_export_email">Esportazione file OFX di Gnucash</string>
 	<string name="description_export_email">Esportazione OFX di Gnucash con </string>
-	<string name="header_transaction_settings">Transazione</string>
-	<string name="title_transaction_preferences">Transaction Preferences</string>
-	<string name="title_account_preferences">Account Preferences</string>
+	<string name="header_transaction_settings">Transazioni</string>
+	<string name="title_transaction_preferences">Preferenza della transazione</string>
+	<string name="title_account_preferences">Preferenze del conto</string>
 	<string name="key_default_transaction_type">default_transaction_type</string>
-	<string name="title_default_transaction_type">Default Transaction Type</string>
-	<string name="summary_default_transaction_type">The type of transaction to use by default, CREDIT or DEBIT</string>
+	<string name="title_default_transaction_type">Tipo di transazione predefinita</string>
+	<string name="summary_default_transaction_type">Il tipo di transazione da usare come predefinita, CREDITO o DEBITO</string>
 	<string-array name="transaction_types">
-		<item>CREDIT</item>
-		<item>DEBIT</item>
+	 	<item>CREDITO</item>
+	 	<item>DEBITO</item>
 	</string-array>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>

From 107b23e50b1a3bcf1711bdfbd0f335b42aeb097b Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Sun, 18 Nov 2012 23:19:52 +0100
Subject: [PATCH 10/12] Fixed: crash when rotating device while creating an
 account Improved handling of default locale when selecting currency based on
 locale. Default to USD when in doubt Reuse transaction activity when rotating
 device (no activity restart)

---
 GnucashMobile/AndroidManifest.xml                            |  1 +
 .../src/org/gnucash/android/db/AccountsDbAdapter.java        |  2 +-
 .../org/gnucash/android/ui/accounts/AccountsActivity.java    | 12 ++++++++++--
 .../android/ui/accounts/NewAccountDialogFragment.java        |  3 +++
 .../android/ui/transactions/NewTransactionFragment.java      |  2 +-
 5 files changed, 16 insertions(+), 4 deletions(-)

diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index 7b45c16a..241cda80 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -59,6 +59,7 @@
         </activity>
         <activity android:name=".ui.settings.SettingsActivity"></activity>
         <activity android:name=".ui.transactions.TransactionsActivity" 
+            android:configChanges="orientation|screenSize"
             android:launchMode="singleTop"></activity>
         <activity android:name=".ui.widget.WidgetConfigurationActivity"
             android:label="@string/label_widget_configuration"
diff --git a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
index b3a83394..ad6a46a2 100644
--- a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -287,7 +287,7 @@ public long getId(String accountUID){
 	 * @param id Record ID of the account to be removed
 	 * @return Currency code of the account
 	 */
-	public String getCurrency(long id){
+	public String getCurrencyCode(long id){
 		return mTransactionsAdapter.getCurrencyCode(id);
 	}
 	
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
index d197657c..992319ae 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
@@ -97,8 +97,16 @@ public void onCreate(Bundle savedInstanceState) {
 		if (locale.getCountry().equals("UK")) {
 		    locale = new Locale(locale.getLanguage(), "GB");
 		}
-		String currencyCode = prefs.getString(getString(R.string.key_default_currency), 
-				Currency.getInstance(locale).getCurrencyCode());		
+		String currencyCode = null;
+		try { //there are some strange locales out there
+			currencyCode = prefs.getString(getString(R.string.key_default_currency), 
+					Currency.getInstance(locale).getCurrencyCode());
+		} catch (Exception e) {
+			Log.e(TAG, e.getMessage());
+			currencyCode = "USD"; //just use USD and let the user choose
+		}
+			
+		
 		Money.DEFAULT_CURRENCY_CODE = currencyCode;		
 		
 		boolean firstRun = prefs.getBoolean(getString(R.string.key_first_run), true);
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/NewAccountDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/NewAccountDialogFragment.java
index 98750d00..da1ebd57 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/NewAccountDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/NewAccountDialogFragment.java
@@ -150,6 +150,9 @@ public void onClick(View v) {
 								
 				String curCode = mCurrencyCodes.get(mCurrencySpinner.getSelectedItemPosition());
 				mAccount.setCurrency(Currency.getInstance(curCode));
+				
+				if (mDbAdapter == null)
+					mDbAdapter = new AccountsDbAdapter(getActivity());
 				mDbAdapter.addAccount(mAccount);
 				
 				((AccountsListFragment)getTargetFragment()).refreshList();
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
index 19171442..6a6c01f1 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
@@ -317,7 +317,7 @@ public void onClick(View v) {
 	
 	public void onAccountChanged(long newAccountId){
 		AccountsDbAdapter accountsDbAdapter = new AccountsDbAdapter(getActivity());
-		String currencyCode = accountsDbAdapter.getCurrency(newAccountId);
+		String currencyCode = accountsDbAdapter.getCurrencyCode(newAccountId);
 		Currency currency = Currency.getInstance(currencyCode);
 		mCurrencyTextView.setText(currency.getSymbol(Locale.getDefault()));
 		accountsDbAdapter.close();

From 38569943f6824fcd3434ec8807ffa22444f420a0 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Thu, 22 Nov 2012 23:15:20 +0100
Subject: [PATCH 11/12] Prepare for v1.0.3 release

---
 CHANGELOG.md                      | 7 +++++++
 GnucashMobile/AndroidManifest.xml | 4 ++--
 2 files changed, 9 insertions(+), 2 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index b7524a94..8d21be59 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,6 +1,13 @@
 Change Log
 ===============================================================================
 
+Version 1.0.3 *(2012-11-23)*
+----------------------------
+
+* Fixed: Crash when determining currency for en_UK which is not an ISO 3611 country
+* Improved: Better handle rotation when creating transactions
+* Improved: Spanish & Italian translations
+
 Version 1.0.2 *(2012-11-09)*
 ----------------------------
 
diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index 241cda80..739d4222 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -17,8 +17,8 @@
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="org.gnucash.android"
-    android:versionCode="3"
-    android:versionName="1.0.2" >
+    android:versionCode="4"
+    android:versionName="1.0.3" >
 
     <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15"/>
     

From acccf08991e95f1ff8750f67a326c6aad2423f9d Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Thu, 22 Nov 2012 23:45:09 +0100
Subject: [PATCH 12/12] Fixed: Crashes on Android 4.2 when editing transactions
 Fixes #42

---
 CHANGELOG.md                                                         | 1 +
 .../org/gnucash/android/ui/transactions/NewTransactionFragment.java  | 5 ++++-
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 8d21be59..744a4a85 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -5,6 +5,7 @@ Version 1.0.3 *(2012-11-23)*
 ----------------------------
 
 * Fixed: Crash when determining currency for en_UK which is not an ISO 3611 country
+* Fixed: Crashes on Android 4.2 when editing transactions
 * Improved: Better handle rotation when creating transactions
 * Improved: Spanish & Italian translations
 
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
index 6a6c01f1..45c6bb56 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
@@ -473,7 +473,10 @@ public BigDecimal parseInputToDecimal(String amountString){
 		@Override
 		public void afterTextChanged(Editable s) {
 			boolean valid = (mAmountEditText.getText().length() > 0);
-			mSaveMenuItem.setEnabled(valid);
+			
+			//JellyBean 4.2 calls onActivityCreated before creating the menu
+			if (mSaveMenuItem != null)
+				mSaveMenuItem.setEnabled(valid);
 		}
 
 		@Override
