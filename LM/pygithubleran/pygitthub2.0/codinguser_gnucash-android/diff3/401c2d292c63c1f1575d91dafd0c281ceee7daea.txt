From 4702ba5ba010e37f29bfb348e7f8635ada28f3dc Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Sun, 4 Nov 2012 14:58:59 +0100
Subject: [PATCH 01/27] Added support for double entry. A single transaction
 can now be reflected in two accounts

---
 .../res/layout/fragment_new_transaction.xml        | 19 +++++++-
 GnucashMobile/res/values/strings.xml               |  1 +
 .../src/org/gnucash/android/data/Account.java      |  1 +
 .../src/org/gnucash/android/data/Transaction.java  | 23 +++++++++
 .../org/gnucash/android/db/DatabaseAdapter.java    |  1 +
 .../src/org/gnucash/android/db/DatabaseHelper.java | 23 ++++++---
 .../gnucash/android/db/TransactionsDbAdapter.java  | 57 +++++++++++++++-------
 .../ui/transactions/NewTransactionFragment.java    | 47 +++++++++++++++---
 .../ui/transactions/TransactionsListFragment.java  |  7 +++
 9 files changed, 147 insertions(+), 32 deletions(-)

diff --git a/GnucashMobile/res/layout/fragment_new_transaction.xml b/GnucashMobile/res/layout/fragment_new_transaction.xml
index ee739db2..1df37199 100644
--- a/GnucashMobile/res/layout/fragment_new_transaction.xml
+++ b/GnucashMobile/res/layout/fragment_new_transaction.xml
@@ -136,6 +136,7 @@
 	   </LinearLayout>
 	    <LinearLayout android:layout_width="match_parent"
 	        android:layout_height="wrap_content"
+	        android:layout_marginBottom="@dimen/dialog_padding"
 	        android:orientation="vertical" >
 	        
 			<TextView
@@ -151,6 +152,22 @@
 		        android:layout_height="wrap_content" 
 		        android:minHeight="?android:attr/listPreferredItemHeight" />
 	    </LinearLayout>
-	
+		<LinearLayout android:layout_width="match_parent"
+	        android:layout_height="wrap_content"
+	        android:orientation="vertical" >
+	        
+			<TextView
+			    android:id="@+id/label_split_account"
+			    android:text="@string/label_split_account"
+			    android:layout_height="wrap_content"
+			    android:layout_width="wrap_content"
+			    android:layout_marginBottom="-8dip"
+			    style="@style/TextAppearance.EditTransaction_LabelSmall" />
+		    <Spinner
+		        android:id="@+id/input_split_accounts_spinner"        
+		        android:layout_width="match_parent"
+		        android:layout_height="wrap_content" 
+		        android:minHeight="?android:attr/listPreferredItemHeight" />
+	    </LinearLayout>
 	</LinearLayout>
 </ScrollView>
\ No newline at end of file
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 861502e9..5e16c9f1 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -473,4 +473,5 @@
 		<item>CREDIT</item>
 		<item>DEBIT</item>
 	</string-array>
+	<string name="label_split_account">Split with account</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index bbac1ed1..2c9a0cac 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -246,6 +246,7 @@ public boolean hasUnexportedTransactions(){
 	 * @return {@link Money} aggregate amount of all transactions in account.
 	 */
 	public Money getBalance(){
+		//TODO: Consider split transactions
 		Money balance = new Money(new BigDecimal(0), this.mCurrency);
 		for (Transaction transx : mTransactionsList) {
 			balance = balance.add(transx.getAmount());		
diff --git a/GnucashMobile/src/org/gnucash/android/data/Transaction.java b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
index e47eed29..cc8bad0d 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Transaction.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
@@ -83,6 +83,12 @@
 	private String mAccountUID = null;
 	
 	/**
+	 * Unique Identifier of the account with which this transaction is split.
+	 * This value is null by default for transactions which are not split
+	 */
+	private String mSplitAccountUID = null;
+	
+	/**
 	 * Flag indicating if this transaction has been exported before or not
 	 * The transactions are typically exported as bank statement in the OFX format
 	 */
@@ -300,6 +306,23 @@ public String getUID() {
 	}
 
 	/**
+	 * Returns the Unique Identifier of account with which this transaction is split
+	 * @return Unique Identifier of account with which this transaction is split
+	 */
+	public String getSplitAccountUID() {
+		return mSplitAccountUID;
+	}
+
+	/**
+	 * Sets the account UID with which to split this transaction
+	 * @param splitAccountUID Unique Identifier to set
+	 */
+	public void setSplitAccountUID(String splitAccountUID) {
+		this.mSplitAccountUID = splitAccountUID;
+	}
+	
+
+	/**
 	 * Returns UID of account to which this transaction belongs
 	 * @return the UID of the account to which this transaction belongs
 	 */
diff --git a/GnucashMobile/src/org/gnucash/android/db/DatabaseAdapter.java b/GnucashMobile/src/org/gnucash/android/db/DatabaseAdapter.java
index 430dec07..233373f1 100644
--- a/GnucashMobile/src/org/gnucash/android/db/DatabaseAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/DatabaseAdapter.java
@@ -48,6 +48,7 @@
 	public static final int COLUMN_TIMESTAMP 	= 6;
 	public static final int COLUMN_ACCOUNT_UID 	= 7;
 	public static final int COLUMN_EXPORTED 	= 8;
+	public static final int COLUMN_SPLIT_ACCOUNT_UID = 9;
 	
 	//columns specific to accounts
 	public static final int COLUMN_CURRENCY_CODE = 4;
diff --git a/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java b/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
index 04f0b13a..9b5ec691 100644
--- a/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
+++ b/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
@@ -43,7 +43,7 @@
 	 * Database version.
 	 * With any change to the database schema, this number must increase
 	 */
-	private static final int DATABASE_VERSION = 1;
+	private static final int DATABASE_VERSION = 2;
 	
 	/**
 	 * Name of accounts table
@@ -96,6 +96,11 @@
 	public static final String KEY_ACCOUNT_UID 	= "account_uid";
 	
 	/**
+	 * Account with which this transaction is split
+	 */
+	public static final String KEY_SPLIT_ACCOUNT_UID 	= "split_account_uid";
+	
+	/**
 	 * Transaction description database column
 	 */
 	public static final String KEY_DESCRIPTION 	= "description";
@@ -139,9 +144,11 @@
 			+ KEY_AMOUNT 		+ " varchar(255) not null, "
 			+ KEY_DESCRIPTION 	+ " text, "
 			+ KEY_TIMESTAMP 	+ " integer not null, "
-			+ KEY_ACCOUNT_UID 	+ " varchar(255) not null, "
+			+ KEY_ACCOUNT_UID 	+ " varchar(255) not null, "			
 			+ KEY_EXPORTED 		+ " tinyint default 0, "
+			+ KEY_SPLIT_ACCOUNT_UID 	+ " varchar(255), "
 			+ "FOREIGN KEY (" 	+ KEY_ACCOUNT_UID + ") REFERENCES " + ACCOUNTS_TABLE_NAME + " (" + KEY_UID + "), "
+			+ "FOREIGN KEY (" 	+ KEY_SPLIT_ACCOUNT_UID + ") REFERENCES " + ACCOUNTS_TABLE_NAME + " (" + KEY_UID + "), "
 			+ "UNIQUE (" 		+ KEY_UID + ") " 
 			+ ");";
 
@@ -166,15 +173,15 @@ public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
 				+ oldVersion + " to " + newVersion
 				+ " which will destroy all old data");
 		
-		if (oldVersion < newVersion){
-			/*
-			Log.i("DatabaseHelper", "Upgrading database to version " + newVersion);
-			if (oldVersion == 1 && newVersion == 2){				
+		if (oldVersion < newVersion){			
+			Log.i(TAG, "Upgrading database to version " + newVersion);
+			if (oldVersion == 1 && newVersion == 2){		
+				Log.i(TAG, "Adding column for splitting transactions");
 				String addColumnSql = "ALTER TABLE " + TRANSACTIONS_TABLE_NAME + 
-									" ADD COLUMN " + KEY_EXPORTED + " tinyint default 0";
+									" ADD COLUMN " + KEY_SPLIT_ACCOUNT_UID + " varchar(255) default 0";
 				db.execSQL(addColumnSql);
 			}
-			*/
+			
 		} else {
 			Log.i(TAG, "Cannot downgrade database.");
 			/*
diff --git a/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
index 28059ea6..267a6e72 100644
--- a/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
@@ -28,6 +28,7 @@
 import android.content.ContentValues;
 import android.content.Context;
 import android.database.Cursor;
+import android.database.sqlite.SQLiteStatement;
 import android.util.Log;
 
 /**
@@ -64,6 +65,7 @@ public long addTransaction(Transaction transaction){
 		contentValues.put(DatabaseHelper.KEY_TIMESTAMP, transaction.getTimeMillis());
 		contentValues.put(DatabaseHelper.KEY_DESCRIPTION, transaction.getDescription());
 		contentValues.put(DatabaseHelper.KEY_EXPORTED, transaction.isExported() ? 1 : 0);
+		contentValues.put(DatabaseHelper.KEY_SPLIT_ACCOUNT_UID, transaction.getSplitAccountUID());
 		
 		long rowId = -1;
 		if ((rowId = fetchTransactionWithUID(transaction.getUID())) > 0){
@@ -119,13 +121,15 @@ public Transaction getTransaction(long rowId){
 	
 	/**
 	 * Returns a cursor to a set of all transactions for the account with UID <code>accountUID</code>
+	 * or for which this account is the split account i.e <code>accountUID</code> is split account UID
 	 * @param accountUID UID of the account whose transactions are to be retrieved
 	 * @return Cursor holding set of transactions for particular account
 	 */
 	public Cursor fetchAllTransactionsForAccount(String accountUID){
 		Cursor cursor = mDb.query(DatabaseHelper.TRANSACTIONS_TABLE_NAME, 
 				null, 
-				DatabaseHelper.KEY_ACCOUNT_UID + " = '" + accountUID + "'", 
+				"(" + DatabaseHelper.KEY_ACCOUNT_UID + " = '" + accountUID + "') "
+				+ "OR (" + DatabaseHelper.KEY_SPLIT_ACCOUNT_UID + " = '" + accountUID + "' )", 
 				null, null, null, DatabaseHelper.KEY_TIMESTAMP + " DESC");
 		
 		return cursor;
@@ -133,6 +137,7 @@ public Cursor fetchAllTransactionsForAccount(String accountUID){
 	
 	/**
 	 * Returns a cursor to a set of all transactions for the account with ID <code>accountID</code>
+	 * * or for which this account is the split account in a double entry
 	 * @param accountUID ID of the account whose transactions are to be retrieved
 	 * @return Cursor holding set of transactions for particular account
 	 */
@@ -153,6 +158,12 @@ public Cursor fetchAllTransactionsForAccount(long accountID){
 			return transactionsList;
 		
 		while (c.moveToNext()) {
+			Transaction transaction = buildTransactionInstance(c);
+			String splitAccountUID = transaction.getSplitAccountUID();
+			//negate split transactions for the split account
+			if (splitAccountUID != null && splitAccountUID.equals(accountUID)){
+				transaction.setAmount(transaction.getAmount().negate());
+			}
 			transactionsList.add(buildTransactionInstance(c));
 		}
 		c.close();
@@ -178,7 +189,8 @@ public Transaction buildTransactionInstance(Cursor c){
 		transaction.setTime(c.getLong(DatabaseAdapter.COLUMN_TIMESTAMP));
 		transaction.setDescription(c.getString(DatabaseAdapter.COLUMN_DESCRIPTION));
 		transaction.setExported(c.getInt(DatabaseAdapter.COLUMN_EXPORTED) == 1);
-				
+		transaction.setSplitAccountUID(c.getString(DatabaseAdapter.COLUMN_SPLIT_ACCOUNT_UID));
+		
 		return transaction;
 	}
 
@@ -284,16 +296,11 @@ public int getTransactionsCount(long accountId){
 	 * regardless of what account they belong to
 	 * @return Number of transaction in the database
 	 */
-	public int getAllTransactionsCount(){
-		Cursor cursor = fetchAllRecords(DatabaseHelper.TRANSACTIONS_TABLE_NAME);
-		int count = 0;
-		if (cursor == null)
-			return count;
-		else {
-			count = cursor.getCount();
-			cursor.close();
-		}
-		return count;
+	public long getAllTransactionsCount(){
+		String sql = "SELECT COUNT(*) FROM " + DatabaseHelper.TRANSACTIONS_TABLE_NAME;		
+		SQLiteStatement statement = mDb.compileStatement(sql);
+	    long count = statement.simpleQueryForLong();
+	    return count;
 	}
 	
 	/**
@@ -302,10 +309,11 @@ public int getAllTransactionsCount(){
 	 * @return Sum of transactions belonging to the account
 	 */
 	public Money getTransactionsSum(long accountId){
-		Cursor c = mDb.query(DatabaseHelper.TRANSACTIONS_TABLE_NAME, 
-				new String[]{DatabaseHelper.KEY_AMOUNT}, 
-				DatabaseHelper.KEY_ACCOUNT_UID + "= '" + getAccountUID(accountId) + "'", 
-				null, null, null, null);
+		Cursor c = fetchAllTransactionsForAccount(accountId); 
+//		mDb.query(DatabaseHelper.TRANSACTIONS_TABLE_NAME, 
+//				new String[]{DatabaseHelper.KEY_AMOUNT}, 
+//				DatabaseHelper.KEY_ACCOUNT_UID + "= '" + getAccountUID(accountId) + "'", 
+//				null, null, null, null);
 
 		//transactions will have the currency of the account
 		String currencyCode = getCurrencyCode(accountId);
@@ -316,12 +324,27 @@ public Money getTransactionsSum(long accountId){
 		Money amountSum = new Money("0", currencyCode);
 		
 		while(c.moveToNext()){
-			amountSum = amountSum.add(new Money(c.getString(0), currencyCode));
+			Money money = new Money(c.getString(DatabaseAdapter.COLUMN_AMOUNT), currencyCode);
+			if (c.getString(DatabaseAdapter.COLUMN_SPLIT_ACCOUNT_UID) != null){
+				amountSum = amountSum.add(money.negate());
+			} else {
+				amountSum = amountSum.add(money);
+			}
 		}
 		c.close();
 		
 		return amountSum;
 	}
+	
+	/**
+	 * Returns true if <code>rowId</code> and <code>accountUID</code> belong to the same account
+	 * @param rowId Database record ID
+	 * @param accountUID Unique Identifier string of the account
+	 * @return <code>true</code> if both are properties of the same account, <code>false</code> otherwise
+	 */
+	public boolean isSameAccount(long rowId, String accountUID){
+		return getAccountID(accountUID) == rowId;
+	}
 		
 	/**
 	 * Marks an account record as exported
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
index af6154ed..fa908f08 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
@@ -66,6 +66,7 @@
 import android.widget.Spinner;
 import android.widget.TextView;
 import android.widget.TimePicker;
+import android.widget.Toast;
 import android.widget.ToggleButton;
 
 import com.actionbarsherlock.app.ActionBar;
@@ -164,6 +165,11 @@
 	private Spinner mAccountsSpinner;
 	
 	/**
+	 * Spinner for selecting the account to split the transaction with
+	 */
+	private Spinner mSplitAccountSpinner;
+	
+	/**
 	 * Accounts database adapter. 
 	 * Used for getting list of transactions to populate the {@link #mAccountsSpinner}
 	 */
@@ -200,6 +206,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container,
 		mAmountEditText = (EditText) v.findViewById(R.id.input_transaction_amount);		
 		mCurrencyTextView = (TextView) v.findViewById(R.id.currency_symbol);
 		mAccountsSpinner = (Spinner) v.findViewById(R.id.input_accounts_spinner);
+		mSplitAccountSpinner = (Spinner) v.findViewById(R.id.input_split_accounts_spinner);
 		mTransactionTypeButton = (ToggleButton) v.findViewById(R.id.input_transaction_type);
 		
 		return v;
@@ -226,7 +233,7 @@ public void onActivityCreated(Bundle savedInstanceState) {
 				to, 
 				0);
 		mCursorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
-		mAccountsSpinner.setAdapter(mCursorAdapter);
+		mAccountsSpinner.setAdapter(mCursorAdapter);		
 		mAccountsSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {
 
 			@Override
@@ -242,6 +249,9 @@ public void onNothingSelected(AdapterView<?> parent) {
 				// nothing to see here, move along				
 			}
 		});
+		
+		mSplitAccountSpinner.setAdapter(mCursorAdapter);
+		
 		mTransactionId = getArguments().getLong(SELECTED_TRANSACTION_ID);
 		mTransactionsDbAdapter = new TransactionsDbAdapter(getActivity());
 		mTransaction = mTransactionsDbAdapter.getTransaction(mTransactionId);
@@ -272,10 +282,14 @@ private void initializeViewsWithTransaction(){
 		mDate = mTime = cal;
 				
 		final long accountId = mAccountsDbAdapter.fetchAccountWithUID(mTransaction.getAccountUID());
-		final int count = mCursorAdapter.getCount();
-		for (int pos = 0; pos < count; pos++) {
-			if (mCursorAdapter.getItemId(pos) == accountId)
-				mAccountsSpinner.setSelection(pos);
+		refreshSelectedAccount(accountId);
+		
+		String splitAccountUID = mTransaction.getSplitAccountUID();		
+		if (splitAccountUID != null){
+			final long splitAccountId = mAccountsDbAdapter.fetchAccountWithUID(splitAccountUID);
+			refreshSelectedSplitAccount(splitAccountId);
+		} else {
+			refreshSelectedSplitAccount(accountId);
 		}
 		
 		String code = mTransactionsDbAdapter.getCurrencyCode(accountId);
@@ -304,6 +318,7 @@ private void initalizeViews() {
 				
 		final long accountId = getArguments().getLong(TransactionsListFragment.SELECTED_ACCOUNT_ID);
 		refreshSelectedAccount(accountId);
+		refreshSelectedSplitAccount(accountId);
 		
 		String code = Money.DEFAULT_CURRENCY_CODE;
 		if (accountId != 0)
@@ -315,12 +330,27 @@ private void initalizeViews() {
 	}
 	
 	public void refreshSelectedAccount(long accountId){
+		long previousAccountId = mAccountsSpinner.getSelectedItemId();
 		for (int pos = 0; pos < mCursorAdapter.getCount(); pos++) {
 			if (mCursorAdapter.getItemId(pos) == accountId){
 				mAccountsSpinner.setSelection(pos);				
 				break;
 			}
 		}
+		
+		//if accountId and split account Id were the same, then make them the same.
+		//this avoid users inadvertently creating split transactions
+		long splitAccountId = mSplitAccountSpinner.getSelectedItemId();
+		if (previousAccountId == splitAccountId){
+			refreshSelectedSplitAccount(accountId);
+		}
+	}
+	
+	public void refreshSelectedSplitAccount(long splitAccountId){
+		for (int pos = 0; pos < mCursorAdapter.getCount(); pos++) {
+			if (mCursorAdapter.getItemId(pos) == splitAccountId)
+				mSplitAccountSpinner.setSelection(pos);
+		}
 	}
 	
 	/**
@@ -408,8 +438,10 @@ private void saveNewTransaction() {
 		String name = mNameEditText.getText().toString();
 		String description = mDescriptionEditText.getText().toString();
 		BigDecimal amountBigd = parseInputToDecimal(mAmountEditText.getText().toString());
-		
+				
 		long accountID 	= mAccountsSpinner.getSelectedItemId();
+		long splitAccountId = mSplitAccountSpinner.getSelectedItemId();
+		
 		Currency currency = Currency.getInstance(mTransactionsDbAdapter.getCurrencyCode(accountID));
 		Money amount 	= new Money(amountBigd, currency);
 		TransactionType type = mTransactionTypeButton.isChecked() ? TransactionType.DEBIT : TransactionType.CREDIT;
@@ -421,6 +453,9 @@ private void saveNewTransaction() {
 			mTransaction = new Transaction(amount, name, type);
 		}
 		mTransaction.setAccountUID(mTransactionsDbAdapter.getAccountUID(accountID));
+		if(splitAccountId != accountID){
+			mTransaction.setSplitAccountUID(mTransactionsDbAdapter.getAccountUID(splitAccountId));
+		}
 		mTransaction.setTime(cal.getTimeInMillis());
 		mTransaction.setDescription(description);
 		
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/TransactionsListFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/TransactionsListFragment.java
index b8703507..a7cfc256 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/TransactionsListFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/TransactionsListFragment.java
@@ -456,6 +456,13 @@ public void bindView(View view, Context context, Cursor cursor) {
 					cursor.getString(DatabaseAdapter.COLUMN_AMOUNT), 
 					mTransactionsDbAdapter.getCurrencyCode(mAccountID));
 			
+			//negate any transactions if they only belong to this account as split
+			String splitAccountUID = cursor.getString(DatabaseAdapter.COLUMN_SPLIT_ACCOUNT_UID);
+			if (splitAccountUID != null 
+					&& mTransactionsDbAdapter.isSameAccount(mAccountID, splitAccountUID)){
+				amount = amount.negate();				
+			}
+				
 			TextView tramount = (TextView) view.findViewById(R.id.transaction_amount);
 			tramount.setText(amount.formattedString(Locale.getDefault()));
 						

From 1ec4481d584f44ac8ad1d2f920e572332f8a0f5d Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Thu, 29 Nov 2012 23:57:25 +0100
Subject: [PATCH 02/27] Added strings file for Hungarian locale Removed extra
 (non-translatable) strings from localization files (only translatable strings
 will be in the localization files to ease work of translators)

---
 GnucashMobile/res/values-de/strings.xml     |   9 -
 GnucashMobile/res/values-el/strings.xml     |   9 -
 GnucashMobile/res/values-es-rMX/strings.xml |   9 -
 GnucashMobile/res/values-es/strings.xml     |   9 -
 GnucashMobile/res/values-fr/strings.xml     |   9 -
 GnucashMobile/res/values-hu/strings.xml     | 477 ++++++++++++++++++++++++++++
 GnucashMobile/res/values-it/strings.xml     |   9 -
 GnucashMobile/res/values-nb/strings.xml     |   9 -
 GnucashMobile/res/values-nl/strings.xml     |   9 -
 GnucashMobile/res/values-pt-rBR/strings.xml |   9 -
 GnucashMobile/res/values-ru/strings.xml     |   9 -
 11 files changed, 477 insertions(+), 90 deletions(-)
 create mode 100644 GnucashMobile/res/values-hu/strings.xml

diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index 6f484d1c..07b92890 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -67,7 +67,6 @@
     <string name="label_move_destination">Zielkonto</string>
     <string name="permission_access_sdcard">Zugriff auf SD-Kartenspeicher</string>
     <string name="title_share_ofx_with">OFX-Datei senden mit</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">Buchungen k&#246;nnten nicht verschoben werden.\Die W&#228;hrung des Zielkontos ist inkompatibel</string>
     <string name="header_general_settings">Allgemein</string>
     <string name="header_about_gnucash">&#220;ber Gnucash</string>
@@ -83,7 +82,6 @@
     <string name="label_display_account">Konto Anzeigen</string>
     <string name="btn_create_accounts">Konten erstellen</string>
     <string name="title_default_accounts">Zu erstellende Konten ausw&#228;hlen</string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -446,15 +444,12 @@
 	    <item>Versicherung</item>
 	</string-array>
 	<string name="error_no_accounts">Keine Konten vorhanden.\nSie m&#252;ssen einen Konto erstellen um Widgets zu anzuf&#252;gen</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version">Version</string>
 	<string name="title_license">Lizenz</string>
 	<string name="summary_licence_details">Apache License v2.0. Klicken f&#252;r Details</string>
 	<string name="title_general_prefs">Allgemein</string>
-	<string name="key_license">app_license</string>
 	<string name="label_widget_configuration">Konto ausw&#228;hlen</string>
 	<string name="toast_no_transactions_to_export">Keine Buchungen zum exportieren</string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash">&#220;ber Gnucash</string>
 	<string name="summary_about_gnucash">GnucashMobile ist eine mobile Datenaufzeichungs-App f&#252;r Android. \nEs erm&#246;glicht die schnelle und flexible Registrierung von Zahlungsvorg&#228;ngen unterwegs, die dann als Datei im OFX-Format exportiert und von der GnuCash-Anwendung an einem Desktop-PC importiert werden k&#246;nnen.</string>
 	<string name="title_about">&#220;ber</string>
@@ -466,7 +461,6 @@
 	<string name="header_transaction_settings">Buchungen</string>
 	<string name="title_transaction_preferences">Einstellungen Buchungen</string>
 	<string name="title_account_preferences">Einstellungen Konten</string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">Voreinstellung Buchungsart</string>
 	<string name="summary_default_transaction_type">Die voreingestellte Buchungsart: Soll oder Haben</string>
 	<string-array name="transaction_types">
@@ -476,11 +470,8 @@
 	<string name="delete_all_transactions_confirmation_message">Wollen Sie wirklich ALLE Buchungen l&#246;schen?</string>
 	<string name="delete_transaction_confirmation_message">Wollen Sie wirklich diese Buchung l&#246;schen?</string>	
 	<string name="title_export_preference_category">Export</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
 	
diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index 1d8ab706..966bb0cb 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -68,7 +68,6 @@
     <string name="label_move_destination"> </string>
     <string name="permission_access_sdcard">  SD</string>
     <string name="title_share_ofx_with">  OFX &#8230;</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency"> 	.\n         </string>
     <string name="header_general_settings"></string>
     <string name="header_about_gnucash"></string>
@@ -84,7 +83,6 @@
     <string name="label_display_account"> </string>
     <string name="btn_create_accounts"> </string>
     <string name="title_default_accounts">   </string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -449,15 +447,12 @@
 	</string-array>
 	<string name="error_no_accounts">   
 	GnuCash.\n      widget</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version"></string>
 	<string name="title_license"> </string>
 	<string name="summary_licence_details">  Apache v2.0.   </string>
 	<string name="title_general_prefs"></string>
-	<string name="key_license">app_license</string>
 	<string name="label_widget_configuration"> </string>
 	<string name="toast_no_transactions_to_export">     </string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash">  GnuCash</string>
 	<string name="summary_about_gnucash"> GnuCash   
 	    Android.\n  
@@ -473,7 +468,6 @@
 	<string name="header_transaction_settings"></string>
 	<string name="title_transaction_preferences"> </string>
 	<string name="title_account_preferences"> </string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">  </string>
 	<string name="summary_default_transaction_type">   ,   </string>
 	<string-array name="transaction_types">
@@ -483,11 +477,8 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>		
 </resources>
diff --git a/GnucashMobile/res/values-es-rMX/strings.xml b/GnucashMobile/res/values-es-rMX/strings.xml
index c2521460..1de7591d 100644
--- a/GnucashMobile/res/values-es-rMX/strings.xml
+++ b/GnucashMobile/res/values-es-rMX/strings.xml
@@ -67,7 +67,6 @@
     <string name="label_move_destination">Cuenta destino</string>
     <string name="permission_access_sdcard">Acceder tarjeta SD</string>
     <string name="title_share_ofx_with">Share OFX export with&#8230;</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">No se pueden mover las transacciones.\nLa cuenta destino usa una moneda diferente a la cuenta de origen</string>
     <string name="header_general_settings">General</string>
     <string name="header_about_gnucash">Acerca de</string>
@@ -83,7 +82,6 @@
     <string name="label_display_account">Mostrar cuenta</string>
     <string name="btn_create_accounts">Crear cuentas</string>
     <string name="title_default_accounts">Seleccione la cuenta a crear</string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afgani</item>
 		<item>Dinar Argelino</item>
@@ -446,15 +444,12 @@
 	    <item>Seguro</item>
 	</string-array>
 	<string name="error_no_accounts">No hay cuentas en Gnucash.\nCree una cuenta antes de agregar un widget</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version">Versi&#243;n de compilaci&#243;n</string>
 	<string name="title_license">Licencia</string>
 	<string name="summary_licence_details">Licencia Apache v2.0. Clic para ver detalles</string>
 	<string name="title_general_prefs">General</string>
-	<string name="key_license">app_license</string>
 	<string name="label_widget_configuration">Seleccione cuenta</string>
 	<string name="toast_no_transactions_to_export">No hay transacciones disponibles para exportar</string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash">Acerca de Gnucash</string>
 	<string name="summary_about_gnucash">GnucashMobile es una aplicaci&#243;n de registro de finanzas para Android\nEsta permite un registro flexible de los gastos realizados, los cuales pueden ser exportados a formato Open Financial eXchange (OFX) e importados a Gnucash desde una computadora de escritorio.</string>
 	<string name="title_about">Acerca de</string>
@@ -465,7 +460,6 @@
 	<string name="header_transaction_settings">Transacciones</string>
 	<string name="title_transaction_preferences">Transaction Preferences</string>
 	<string name="title_account_preferences">Account Preferences</string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">Default Transaction Type</string>
 	<string name="summary_default_transaction_type">The type of transaction to use by default, CREDIT or DEBIT</string>
 	<string-array name="transaction_types">
@@ -475,11 +469,8 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 7225c8b1..974d0b5e 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -68,7 +68,6 @@
     <string name="label_move_destination">Cuenta Destino</string>
     <string name="permission_access_sdcard">Acceder a la tarjeta SD</string>
     <string name="title_share_ofx_with">Compartir exportaci&#243;n OFX con&#8230;</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">No se pueden mover las transacciones.\nLa cuenta destino utiliza una divisa distinta a la de la cuenta de origen</string>
     <string name="header_general_settings">General</string>
     <string name="header_about_gnucash">Acerca de</string>
@@ -84,7 +83,6 @@
     <string name="label_display_account">Mostrar cuentas</string>
     <string name="btn_create_accounts">Crear Cuentas</string>
     <string name="title_default_accounts">Seleccionar cuentas a crear</string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afgani</item>
 		<item>Dinar Argelino</item>
@@ -447,15 +445,12 @@
 	    <item>Seguros</item>
 	</string-array>
 	<string name="error_no_accounts">No hay cuentas en Gnucash.\nCrea una cuenta antes de a&#241;adir un widget</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version">Versi&#243;n de compilaci&#243;n</string>
 	<string name="title_license">Licencia</string>
 	<string name="summary_licence_details">Apache License v2.0. Clic para m&#225;s detalles</string>
 	<string name="title_general_prefs">General</string>
-	<string name="key_license">app_license</string>
 	<string name="label_widget_configuration">Seleccionar Cuenta</string>
 	<string name="toast_no_transactions_to_export">No hay transacciones disponibles para exportar</string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash">Acerca de Gnucash</string>
 	<string name="summary_about_gnucash">GnucashMobile es una aplicaci&#243;n de registro de gastos financieros para Android.\nPermite un registro flexible de gastos en cualquier lugar que luego pueden ser exportados al formato Open Financial eXchange (OFX) e importados en la aplicaci&#243;n Gnucash para el escritorio.</string>
 	<string name="title_about">About</string>
@@ -466,7 +461,6 @@
 	<string name="header_transaction_settings">Transacciones</string>
 	<string name="title_transaction_preferences">Preferencias de transacciones</string>
 	<string name="title_account_preferences">Preferencias de cuentas</string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">Tipo de transacci&#243;n por defecto</string>
 	<string name="summary_default_transaction_type">El tipo de transacci&#243;n a utilizar por defecto: ABONO o CARGO</string>
 	<string-array name="transaction_types">
@@ -476,11 +470,8 @@
 	<string name="delete_all_transactions_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar TODAS las transacciones?</string>
 	<string name="delete_transaction_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar esta transacci&#243;n?</string>
 	<string name="title_export_preference_category">Exportaci&#243;n</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Exportar siempre todas las transacciones</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Borrar siempre todas las transacciones exportadas</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Correo electr&#243;nico por defecto para exportar</string>
 	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Puedes cambiarla en cada exportaci&#243;n.</string>
 </resources>
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index 84113769..f7a995b3 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -68,7 +68,6 @@
     <string name="label_move_destination">Compte de destination</string>
     <string name="permission_access_sdcard">Acc&#233;s carte SD</string>
     <string name="title_share_ofx_with">Partager l\export en OFX avec&#8230;</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">Impposible de d&#233;placer les transactions.\nLe compte de destination utilise une monnaie diff&#233;rente du compte d\'origine</string>
     <string name="header_general_settings">G&#233;n&#233;ral</string>
     <string name="header_about_gnucash">&#192; propos</string>
@@ -84,7 +83,6 @@
     <string name="label_display_account">Afficher le compte</string>
     <string name="btn_create_accounts">Cr&#233;er les comptes</string>
     <string name="title_default_accounts">Choisisez les comptes &#192; cr&#233;er</string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -448,15 +446,12 @@
 	    <item>Assurance</item>
 	</string-array>
 	<string name="error_no_accounts">Aucun compte &#233;xistant dans Gnucash.\nCr&#233;er un compte avant d\'ajouter un widget</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version">Version logiciel</string>
 	<string name="title_license">Licence</string>
 	<string name="summary_licence_details">Apache License v2.0. Click pour plus de d&#233;tails</string>
 	<string name="title_general_prefs">G&#233;n&#233;ral</string>
-	<string name="key_license">app_license</string>
 	<string name="label_widget_configuration">Selectionnez un compte</string>
 	<string name="toast_no_transactions_to_export">Il n\'existe pas de transactions disponible pour l\'exportation</string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash">&#192; propos de Gnucash</string>
 	<string name="summary_about_gnucash">GnucashMobile est une application mobile de suivis de finance pour Android.\nIl permet un suivi simple des d&#233;penses et qui peut tre export&#233; vers le format Open Financial eXchange (OFX) et import&#233;s dans Gnucash pour PC.</string>
 	<string name="title_about">&#192; propos</string>
@@ -467,7 +462,6 @@
 	<string name="header_transaction_settings">Transactions</string>
 	<string name="title_transaction_preferences">Prfrences des transactions</string>
 	<string name="title_account_preferences">Prfrences du compte</string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">Type de transaction par dfaut</string>
 	<string name="summary_default_transaction_type">Le type de transaction  utiliser par dfaut, CREDIT ou DEBIT</string>
 	<string-array name="transaction_types">
@@ -477,11 +471,8 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-hu/strings.xml b/GnucashMobile/res/values-hu/strings.xml
new file mode 100644
index 00000000..42e55acb
--- /dev/null
+++ b/GnucashMobile/res/values-hu/strings.xml
@@ -0,0 +1,477 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+ Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
+ 
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+ 
+    http://www.apache.org/licenses/LICENSE-2.0
+ 
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<resources>
+    <string name="app_name">GnuCash</string>
+    <string name="title_add_account">Create Account</string>
+    <string name="title_edit_account">Edit Account</string>
+    <string name="info_details">Info</string>
+    <string name="title_settings">Settings</string>
+    <string name="menu_export_ofx">Export OFX</string>
+    <string name="description_add_transaction_icon">Add a new transaction to an account</string>
+    <string name="label_no_accounts">No accounts to display</string>
+    <string name="label_account_name">Account name</string>
+    <string name="btn_cancel">Cancel</string>
+    <string name="btn_save">Save</string>
+    <string name="label_no_transactions_to_display">No transactions to display</string>
+    <string name="label_transaction_name">Description</string>
+    <string name="label_transaction_amount">Amount</string>
+    <string name="title_add_transaction">New transaction</string>
+    <string name="label_no_transactions">No transactions to display</string>
+    <string name="label_timeanddate">DATE &amp; TIME</string>
+    <string name="label_account">Account</string>
+    <string name="label_debit">DEBIT</string>
+    <string name="label_credit">CREDIT</string>
+    <string name="title_accounts">Accounts</string>
+    <string name="title_transactions">Transactions</string>
+    <string name="menu_delete">DELETE</string>
+    <string name="alert_dialog_ok_delete">Delete</string>
+    <string name="alert_dialog_cancel">Cancel</string>
+    <string name="toast_account_deleted">Account deleted</string>
+    <string name="title_confirm_delete">Confirm delete</string>
+    <string name="delete_account_confirmation_message">All transactions in this account will also be deleted</string>
+    <string name="title_edit_transaction">Edit Transaction</string>
+    <string name="label_transaction_description">Note</string>
+    <string name="menu_move">MOVE</string>
+    <string name="title_selected">%1$d selected</string>
+    <string name="label_transactions_total">Total sum:</string>
+    <string name="label_export_destination">Export Destination</string>
+    <string name="title_export_dialog">Export OFX</string>
+    <string name="option_export_all_transactions">Export all transactions</string>
+    <string name="hint_export_choice">By default, only new transactions since last export will be exported. Check this option to export all transactions</string>
+    <string name="error_exporting">Error exporting OFX data</string>    
+    <string name="btn_export">Export</string>
+    <string name="option_delete_after_export">Delete after export</string>
+    <string name="hint_delete_after_export">All exported transactions will be deleted when exporting is completed</string>
+    <string name="title_settings">Settings</string>
+    <string-array name="export_destinations">
+        <item>Share file&#8230;</item>
+        <item>SD Card</item>
+    </string-array>
+    <string name="btn_move">Move</string>
+    <string name="title_move_transactions">Move %1$d transaction(s)</string>
+    <string name="label_move_destination">Destination Account</string>
+    <string name="permission_access_sdcard">Access SD Card</string>
+    <string name="title_share_ofx_with">Share OFX export with&#8230;</string>
+    <string name="toast_incompatible_currency">Cannot move transactions.\nThe destination account uses a different currency from origin account</string>
+    <string name="header_general_settings">General</string>
+    <string name="header_about_gnucash">About</string>
+    <string name="title_choose_currency">Choose default currency</string>
+    <string name="title_default_currency">Default currency</string>
+    <string name="summary_default_currency">Default currency to assign to new accounts</string>
+    <string name="label_permission_record_transactions">Enables recording transactions in GnuCash for Android</string>
+    <string name="label_permission_create_accounts">Enables creation of accounts in GnuCash for Android</string>
+    <string name="label_permission_group">Your GnuCash data</string>
+    <string name="description_permission_group">Read and modify GnuCash data</string>
+    <string name="label_permission_record_transaction">record transactions</string>
+    <string name="label_permission_create_account">create accounts</string>
+    <string name="label_display_account">Display account</string>
+    <string name="btn_create_accounts">Create Accounts</string>
+    <string name="title_default_accounts">Select accounts to create</string>
+    <string-array name="currency_names">
+        <item>Afghani</item>
+		<item>Algerian Dinar</item>
+		<item>Argentine Peso</item>
+		<item>Armenian Dram</item>
+		<item>Aruban Florin</item>
+		<item>Australian Dollar</item>
+		<item>Azerbaijanian Manat</item>
+		<item>Bahamian Dollar</item>
+		<item>Bahraini Dinar</item>
+		<item>Baht</item>
+		<item>Balboa</item>
+		<item>Barbados Dollar</item>
+		<item>Belarussian Ruble</item>
+		<item>Belize Dollar</item>
+		<item>Bermudian Dollar</item>
+		<item>Bolivar Fuerte</item>
+		<item>Boliviano</item>
+		<item>Brazilian Real</item>
+		<item>Brunei Dollar</item>
+		<item>Bulgarian Lev</item>
+		<item>Burundi Franc</item>
+		<item>Canadian Dollar</item>
+		<item>Cape Verde Escudo</item>
+		<item>Cayman Islands Dollar</item>
+		<item>CFA Franc BCEAO</item>
+		<item>CFA Franc BEAC</item>
+		<item>CFP Franc</item>
+		<item>Chilean Peso</item>
+		<item>Testing currency</item>
+		<item>Colombian Peso</item>
+		<item>Comoro Franc</item>
+		<item>Congolese Franc</item>
+		<item>Convertible Mark</item>
+		<item>Cordoba Oro</item>
+		<item>Costa Rican Colon</item>
+		<item>Croatian Kuna</item>
+		<item>Cuban Peso</item>
+		<item>Czech Koruna</item>
+		<item>Dalasi</item>
+		<item>Danish Krone</item>
+		<item>Denar</item>
+		<item>Djibouti Franc</item>
+		<item>Dobra</item>
+		<item>Dominican Peso</item>
+		<item>Dong</item>
+		<item>East Caribbean Dollar</item>
+		<item>Egyptian Pound</item>
+		<item>El Salvador Colon</item>
+		<item>Ethiopian Birr</item>
+		<item>Euro</item>
+		<item>Falkland Islands Pound</item>
+		<item>Fiji Dollar</item>
+		<item>Forint</item>
+		<item>Ghana Cedi</item>
+		<item>Gibraltar Pound</item>
+		<item>Gold</item>
+		<item>Gourde</item>
+		<item>Guarani</item>
+		<item>Guinea Franc</item>
+		<item>Guyana Dollar</item>
+		<item>Hong Kong Dollar</item>
+		<item>Hryvnia</item>
+		<item>Iceland Krona</item>
+		<item>Indian Rupee</item>
+		<item>Iranian Rial</item>
+		<item>Iraqi Dinar</item>
+		<item>Jamaican Dollar</item>
+		<item>Jordanian Dinar</item>
+		<item>Kenyan Shilling</item>
+		<item>Kina</item>
+		<item>Kip</item>
+		<item>Kuwaiti Dinar</item>
+		<item>Kwacha</item>
+		<item>Kwanza</item>
+		<item>Kyat</item>
+		<item>Lari</item>
+		<item>Latvian Lats</item>
+		<item>Lebanese Pound</item>
+		<item>Lek</item>
+		<item>Lempira</item>
+		<item>Leone</item>
+		<item>Liberian Dollar</item>
+		<item>Libyan Dinar</item>
+		<item>Lilangeni</item>
+		<item>Lithuanian Litas</item>
+		<item>Loti</item>
+		<item>Malagasy Ariary</item>
+		<item>Malaysian Ringgit</item>
+		<item>Mauritius Rupee</item>
+		<item>Mexican Peso</item>
+		<item>Mexican Unidad de Inversion (UDI)</item>
+		<item>Moldovan Leu</item>
+		<item>Moroccan Dirham</item>
+		<item>Mozambique Metical</item>
+		<item>Mvdol</item>
+		<item>Naira</item>
+		<item>Nakfa</item>
+		<item>Namibia Dollar</item>
+		<item>Nepalese Rupee</item>
+		<item>Netherlands Antillean Guilder</item>
+		<item>New Israeli Sheqel</item>
+		<item>New Romanian Leu</item>
+		<item>New Taiwan Dollar</item>
+		<item>New Zealand Dollar</item>
+		<item>Ngultrum</item>
+		<item>North Korean Won</item>
+		<item>Norwegian Krone</item>
+		<item>Nuevo Sol</item>
+		<item>Ouguiya</item>
+		<item>Paanga</item>
+		<item>Pakistan Rupee</item>
+		<item>Palladium</item>
+		<item>Pataca</item>
+		<item>Peso Convertible</item>
+		<item>Peso Uruguayo</item>
+		<item>Philippine Peso</item>
+		<item>Platinum</item>
+		<item>Pound Sterling</item>
+		<item>Pula</item>
+		<item>Qatari Rial</item>
+		<item>Quetzal</item>
+		<item>Rand</item>
+		<item>Rial Omani</item>
+		<item>Riel</item>
+		<item>Rufiyaa</item>
+		<item>Rupiah</item>
+		<item>Russian Ruble</item>
+		<item>Rwanda Franc</item>
+		<item>Saint Helena Pound</item>
+		<item>Saudi Riyal</item>
+		<item>SDR (Special Drawing Right)</item>
+		<item>Serbian Dinar</item>
+		<item>Seychelles Rupee</item>
+		<item>Silver</item>
+		<item>Singapore Dollar</item>
+		<item>Solomon Islands Dollar</item>
+		<item>Som</item>
+		<item>Somali Shilling</item>
+		<item>Somoni</item>
+		<item>South Sudanese Pound</item>
+		<item>Sri Lanka Rupee</item>
+		<item>Sucre</item>
+		<item>Sudanese Pound</item>
+		<item>Surinam Dollar</item>
+		<item>Swedish Krona</item>
+		<item>Swiss Franc</item>
+		<item>Syrian Pound</item>
+		<item>Taka</item>
+		<item>Tala</item>
+		<item>Tanzanian Shilling</item>
+		<item>Tenge</item>
+		<item>No currency</item>
+		<item>Trinidad and Tobago Dollar</item>
+		<item>Tugrik</item>
+		<item>Tunisian Dinar</item>
+		<item>Turkish Lira</item>
+		<item>Turkmenistan New Manat</item>
+		<item>UAE Dirham</item>
+		<item>Uganda Shilling</item>
+		<item>UIC-Franc</item>
+		<item>Unidad de Valor Real</item>
+		<item>Unidades de fomento</item>
+		<item>Uruguay Peso en Unidades Indexadas (URUIURUI)</item>
+		<item>US Dollar</item>
+		<item>Uzbekistan Sum</item>
+		<item>Vatu</item>
+		<item>WIR Euro</item>
+		<item>WIR Franc</item>
+		<item>Won</item>
+		<item>Yemeni Rial</item>
+		<item>Yen</item>
+		<item>Yuan Renminbi</item>
+		<item>Zambian Kwacha</item>
+		<item>Zimbabwe Dollar</item>
+		<item>Zloty</item>
+    </string-array>
+    
+	<string-array name="currency_codes">
+        <item>AFN</item>
+		<item>DZD</item>
+		<item>ARS</item>
+		<item>AMD</item>
+		<item>AWG</item>
+		<item>AUD</item>
+		<item>AZN</item>
+		<item>BSD</item>
+		<item>BHD</item>
+		<item>THB</item>
+		<item>PAB</item>
+		<item>BBD</item>
+		<item>BYR</item>
+		<item>BZD</item>
+		<item>BMD</item>
+		<item>VEF</item>
+		<item>BOB</item>
+		<item>BRL</item>
+		<item>BND</item>
+		<item>BGN</item>
+		<item>BIF</item>
+		<item>CAD</item>
+		<item>CVE</item>
+		<item>KYD</item>
+		<item>XOF</item>
+		<item>XAF</item>
+		<item>XPF</item>
+		<item>CLP</item>
+		<item>XTS</item>
+		<item>COP</item>
+		<item>KMF</item>
+		<item>CDF</item>
+		<item>BAM</item>
+		<item>NIO</item>
+		<item>CRC</item>
+		<item>HRK</item>
+		<item>CUP</item>
+		<item>CZK</item>
+		<item>GMD</item>
+		<item>DKK</item>
+		<item>MKD</item>
+		<item>DJF</item>
+		<item>STD</item>
+		<item>DOP</item>
+		<item>VND</item>
+		<item>XCD</item>
+		<item>EGP</item>
+		<item>SVC</item>
+		<item>ETB</item>
+		<item>EUR</item>
+		<item>FKP</item>
+		<item>FJD</item>
+		<item>HUF</item>
+		<item>GHS</item>
+		<item>GIP</item>
+		<item>XAU</item>
+		<item>HTG</item>
+		<item>PYG</item>
+		<item>GNF</item>
+		<item>GYD</item>
+		<item>HKD</item>
+		<item>UAH</item>
+		<item>ISK</item>
+		<item>INR</item>
+		<item>IRR</item>
+		<item>IQD</item>
+		<item>JMD</item>
+		<item>JOD</item>
+		<item>KES</item>
+		<item>PGK</item>
+		<item>LAK</item>
+		<item>KWD</item>
+		<item>MWK</item>
+		<item>AOA</item>
+		<item>MMK</item>
+		<item>GEL</item>
+		<item>LVL</item>
+		<item>LBP</item>
+		<item>ALL</item>
+		<item>HNL</item>
+		<item>SLL</item>
+		<item>LRD</item>
+		<item>LYD</item>
+		<item>SZL</item>
+		<item>LTL</item>
+		<item>LSL</item>
+		<item>MGA</item>
+		<item>MYR</item>
+		<item>MUR</item>
+		<item>MXN</item>
+		<item>MXV</item>
+		<item>MDL</item>
+		<item>MAD</item>
+		<item>MZN</item>
+		<item>BOV</item>
+		<item>NGN</item>
+		<item>ERN</item>
+		<item>NAD</item>
+		<item>NPR</item>
+		<item>ANG</item>
+		<item>ILS</item>
+		<item>RON</item>
+		<item>TWD</item>
+		<item>NZD</item>
+		<item>BTN</item>
+		<item>KPW</item>
+		<item>NOK</item>
+		<item>PEN</item>
+		<item>MRO</item>
+		<item>TOP</item>
+		<item>PKR</item>
+		<item>XPD</item>
+		<item>MOP</item>
+		<item>CUC</item>
+		<item>UYU</item>
+		<item>PHP</item>
+		<item>XPT</item>
+		<item>GBP</item>
+		<item>BWP</item>
+		<item>QAR</item>
+		<item>GTQ</item>
+		<item>ZAR</item>
+		<item>OMR</item>
+		<item>KHR</item>
+		<item>MVR</item>
+		<item>IDR</item>
+		<item>RUB</item>
+		<item>RWF</item>
+		<item>SHP</item>
+		<item>SAR</item>
+		<item>XDR</item>
+		<item>RSD</item>
+		<item>SCR</item>
+		<item>XAG</item>
+		<item>SGD</item>
+		<item>SBD</item>
+		<item>KGS</item>
+		<item>SOS</item>
+		<item>TJS</item>
+		<item>SSP</item>
+		<item>LKR</item>
+		<item>XSU</item>
+		<item>SDG</item>
+		<item>SRD</item>
+		<item>SEK</item>
+		<item>CHF</item>
+		<item>SYP</item>
+		<item>BDT</item>
+		<item>WST</item>
+		<item>TZS</item>
+		<item>KZT</item>
+		<item>XXX</item>
+		<item>TTD</item>
+		<item>MNT</item>
+		<item>TND</item>
+		<item>TRY</item>
+		<item>TMT</item>
+		<item>AED</item>
+		<item>UGX</item>
+		<item>XFU</item>
+		<item>COU</item>
+		<item>CLF</item>
+		<item>UYI</item>
+		<item>USD</item>
+		<item>UZS</item>
+		<item>VUV</item>
+		<item>CHE</item>
+		<item>CHW</item>
+		<item>KRW</item>
+		<item>YER</item>
+		<item>JPY</item>
+		<item>CNY</item>
+		<item>ZMK</item>
+		<item>ZWL</item>
+		<item>PLN</item>
+    </string-array>
+	<string-array name="default_accounts">
+	    <item>Expenses</item>
+	    <item>Income</item>
+	    <item>Assets</item>	    
+	    <item>Entertainment</item>
+	    <item>Insurance</item>
+	</string-array>
+	<string name="error_no_accounts">No accounts exist in GnuCash.\nCreate an account before adding a widget</string>
+	<string name="title_build_version">Build version</string>
+	<string name="title_license">License</string>
+	<string name="summary_licence_details">Apache License v2.0. Click for details</string>
+	<string name="title_general_prefs">General Preferences</string>
+	<string name="label_widget_configuration">Select Account</string>
+	<string name="toast_no_transactions_to_export">There are no transactions available to export</string>
+	<string name="title_about_gnucash">About GnuCash</string>
+	<string name="summary_about_gnucash">Gnucash is a mobile finance expense tracker application for Android.\nIt enables flexible tracking of expenses on-the-go which can be exported to the Open Financial eXchange (OFX) format and imported into GnuCash for the desktop.</string>
+	<string name="title_about">About</string>
+	<string name="toast_error_exporting">Could not write OFX file to :\n</string>
+	<string name="toast_ofx_exported_to">OFX file exported to:\n</string>
+	<string name="title_export_email">GnuCash OFX export</string>
+	<string name="description_export_email">GnuCash OFX Export from </string>
+	<string name="header_transaction_settings">Transactions</string>
+	<string name="title_transaction_preferences">Transaction Preferences</string>
+	<string name="title_account_preferences">Account Preferences</string>
+	<string name="title_default_transaction_type">Default Transaction Type</string>
+	<string name="summary_default_transaction_type">The type of transaction to use by default, CREDIT or DEBIT</string>
+	<string-array name="transaction_types">
+		<item>CREDIT</item>
+		<item>DEBIT</item>
+	</string-array>
+	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="title_export_preference_category">Export</string>
+	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_default_export_email">Default export email</string>
+	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
+</resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index 9a55bd05..d9b0671c 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -68,7 +68,6 @@
     <string name="label_move_destination">Conto di destinazione</string>
     <string name="permission_access_sdcard">Accedi alla scheda SD</string>
     <string name="title_share_ofx_with">Condividi l\'esportazione OFX con&#8230;</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">Impossibile spostare le transazioni.\nIl conto di destinazione ha una valuta diversa dal conto di origine</string>
     <string name="header_general_settings">Generali</string>
     <string name="header_about_gnucash">Informazioni</string>
@@ -84,7 +83,6 @@
     <string name="label_display_account">Visualizza conto</string>
     <string name="btn_create_accounts">Crea conti</string>
     <string name="title_default_accounts">Selezione dei conti da creare</string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -448,15 +446,12 @@
 	    <item>Assicurazione</item>
 	</string-array>
 	<string name="error_no_accounts">Non esiste alcun conto in Gnucash.\nCreare un conto prima di aggiungere il widget</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version">Versione build</string>
 	<string name="title_license">Licenza</string>
 	<string name="summary_licence_details">Apache License v2.0. Fare clic per i dettagli</string>
 	<string name="title_general_prefs">Generale</string>
-	<string name="key_license">app_license</string>
 	<string name="label_widget_configuration">Seleziona conto</string>
 	<string name="toast_no_transactions_to_export">Non sono disponibili transazioni da esportare</string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash">Informazioni su Gnucash</string>
 	<string name="summary_about_gnucash">GnucashMobile &#232; un\'applicazione Android per tenere traccia delle proprie spese.\nPermette di registrare le proprie uscite al volo, di esportarle in formato OFX (Open Financial eXchange) e di importarle nella versione desktop di GnuCash.</string>
 	<string name="title_about">Informazioni</string>
@@ -467,7 +462,6 @@
 	<string name="header_transaction_settings">Transazioni</string>
 	<string name="title_transaction_preferences">Preferenza della transazione</string>
 	<string name="title_account_preferences">Preferenze del conto</string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">Tipo di transazione predefinita</string>
 	<string name="summary_default_transaction_type">Il tipo di transazione da usare come predefinita, CREDITO o DEBITO</string>
 	<string-array name="transaction_types">
@@ -477,11 +471,8 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
diff --git a/GnucashMobile/res/values-nb/strings.xml b/GnucashMobile/res/values-nb/strings.xml
index 01c3b002..11afa03e 100644
--- a/GnucashMobile/res/values-nb/strings.xml
+++ b/GnucashMobile/res/values-nb/strings.xml
@@ -69,7 +69,6 @@
     <string name="label_move_destination">Til konto</string>
     <string name="permission_access_sdcard">Aksesser minnekort</string>
     <string name="title_share_ofx_with">Del OFX-eksport med&#8230;</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">Kan ikke flytte transaksjonen(e).\nMottakerkonto har en annen valuta</string>
     <string name="header_general_settings">Generelt</string>
     <string name="header_about_gnucash">Om</string>
@@ -85,7 +84,6 @@
     <string name="label_display_account">Vis konto</string>
     <string name="btn_create_accounts">Opprette kontoer</string>
     <string name="title_default_accounts">Velg kontoer som skal opprettes</string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -449,15 +447,12 @@
 	    <item>Forsikringer</item>
 	</string-array>
 	<string name="error_no_accounts">Ingen kontoer finnes i Gnucash.\nOpprett en konto fr du legger til en widget</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version">Byggversion</string>
 	<string name="title_license">Lisens</string>
 	<string name="summary_licence_details">Apache Lisens v2.0. Klikk for detaljer.</string>
 	<string name="title_general_prefs">Generelt</string>
-	<string name="key_license">app_license</string>
 	<string name="label_widget_configuration">Velg konto</string>
 	<string name="toast_no_transactions_to_export">Ingen transaksjoner  eksportere</string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash">Om Gnucash</string>
 	<string name="summary_about_gnucash">GnucashMobile er en mobil regnskapsfrer for Android.\nDen gir 
 muligheten til  raskt og fleksibelt logge transaksjoner som kan eksporteres til OFX (Open Financial eXchange)-
@@ -470,7 +465,6 @@ format og importeres i regnskapsprogrammet GnuCash for PC.</string>
 	<string name="header_transaction_settings">Transaksjoner</string>
 	<string name="title_transaction_preferences">Transaksjonsinnstillinger</string>
 	<string name="title_account_preferences">Kontoinnstillinger</string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">Standard transaksjonstype</string>
 	<string name="summary_default_transaction_type">Transaksjonstypen som skal brukes som standard, KREDIT eller DEBET</string>
 	<string-array name="transaction_types">
@@ -480,11 +474,8 @@ format og importeres i regnskapsprogrammet GnuCash for PC.</string>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
diff --git a/GnucashMobile/res/values-nl/strings.xml b/GnucashMobile/res/values-nl/strings.xml
index 62f59aaf..ac7b30ec 100644
--- a/GnucashMobile/res/values-nl/strings.xml
+++ b/GnucashMobile/res/values-nl/strings.xml
@@ -68,7 +68,6 @@
     <string name="label_move_destination">Bestemmingsdagboek</string>
     <string name="permission_access_sdcard">SD kaart benaderen</string>
     <string name="title_share_ofx_with">OFX data verzenden via&#8230;</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">Transacties kunnen niet verplaatst worden.\nHet munteenheid van het dagboeken is niet compatibel</string>
     <string name="header_general_settings">Algemeen</string>
     <string name="header_about_gnucash">Over</string>
@@ -84,7 +83,6 @@
     <string name="label_display_account">Dagboek tonen</string>
     <string name="btn_create_accounts">Dagboeken aanmaken</string>
     <string name="title_default_accounts">Te aanmaken dagboeken selecteren</string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -448,15 +446,12 @@
 	    <item>Verzekering</item>
 	</string-array>
 	<string name="error_no_accounts">Geen dagboeken beschikbaar.\nU moet een dagboek aanmaken alvorens een widget toe te voegen</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version">Versie</string>
 	<string name="title_license">License</string>
 	<string name="summary_licence_details">Apache License v2.0. Klik voor details</string>
 	<string name="title_general_prefs">Algemeen</string>
-	<string name="key_license">app_license</string>
 	<string name="label_widget_configuration">Account kiezen</string>
 	<string name="toast_no_transactions_to_export">Geen transacties beschikbaar om te exporteren</string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash">Over GnuCash</string>
 	<string name="summary_about_gnucash">GnucashMobile is een mobiele uitgavebeheerstoepassing voor Android.\nHet laat onderweg een snelle en flexibele registratie van uitgaven toe, die als OFX gegevens ge&#235;xporteerd kunnen worden om in de GnuCash-toepassing op een desktop-computer te importeren.</string>
 	<string name="title_about">Over</string>
@@ -467,7 +462,6 @@
 	<string name="header_transaction_settings">Transacties</string>
 	<string name="title_transaction_preferences">Transaction Preferences</string>
 	<string name="title_account_preferences">Account Preferences</string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">Default Transaction Type</string>
 	<string name="summary_default_transaction_type">The type of transaction to use by default, CREDIT or DEBIT</string>
 	<string-array name="transaction_types">
@@ -477,11 +471,8 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index 38f3781e..e00eb07b 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -67,7 +67,6 @@
   <string name="label_move_destination">Conta de destino</string>
   <string name="permission_access_sdcard">Acessar carto SD</string>
   <string name="title_share_ofx_with">Compartilhar OFX exportado com&#8230;</string>
-  <string name="key_default_currency">default_currency</string>
   <string name="toast_incompatible_currency">No  possvel mover as transaes. \nA conta de destino usa uma moeda padro diferente da moeda usada pela conta de origem.</string>
   <string name="header_general_settings">Geral</string>
   <string name="header_about_gnucash">Sobre</string>
@@ -83,7 +82,6 @@
   <string name="label_display_account">Mostrar conta</string>
   <string name="btn_create_accounts">Criar Contas</string>
   <string name="title_default_accounts">Selecionar contas para criar</string>
-  <string name="key_first_run">key_first_run</string>
   <string-array name="currency_names">
     <item>Afegane</item>
     <item>Dinar Argelino</item>
@@ -446,15 +444,12 @@
     <item>Seguros</item>
   </string-array>
   <string name="error_no_accounts">No existem contas no GnuCash.\nCriar uma conta antes de adicionar um widget</string>
-  <string name="key_build_version">build_version</string>
   <string name="title_build_version">Verso de compilao</string>
   <string name="title_license">Licena</string>
   <string name="summary_licence_details">Apache License v2.0. Clique para mais detalhes</string>
   <string name="title_general_prefs">Preferncias Gerais</string>
-  <string name="key_license">app_license</string>
   <string name="label_widget_configuration">Selecionar Conta</string>
   <string name="toast_no_transactions_to_export">No existem transaes disponveis para exportar</string>
-  <string name="key_about">about_gnucash</string>
   <string name="title_about_gnucash">Sobre o GnuCash</string>
   <string name="summary_about_gnucash">GnuCash  um aplicativo para controle de despesas no Android.\nEle proporciona uma forma flexvel de registrar despesas on-the-go, que podem ser exportadas para o formato Open Financial eXchange (OFX) e importadas para o Gnucash para desktop.</string>
   <string name="title_about">Sobre</string>
@@ -465,7 +460,6 @@
   <string name="header_transaction_settings">Transaes</string>
   <string name="title_transaction_preferences">Preferncias para Transaes</string>
   <string name="title_account_preferences">Preferncias para Contas</string>
-  <string name="key_default_transaction_type">default_transaction_type</string>
   <string name="title_default_transaction_type">Tipo de Transao Padro</string>
   <string name="summary_default_transaction_type">O tipo de transao a ser usada por padro, CRDITO ou DBITO</string>
   <string-array name="transaction_types">
@@ -475,11 +469,8 @@
   <string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
   <string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
   <string name="title_export_preference_category">Export</string>
-  <string name="key_export_all_transactions">export_all_transactions</string>
   <string name="title_export_all_transactions">Always export all transactions</string>
-  <string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
   <string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-  <string name="key_default_export_email">export_email_target</string>
   <string name="title_default_export_email">Default export email</string>
   <string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>  
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index 292b0599..2fea690f 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -68,7 +68,6 @@
     <string name="label_move_destination">-</string>
     <string name="permission_access_sdcard">   </string>
     <string name="title_share_ofx_with"> OFX&#8230;</string>
-    <string name="key_default_currency">default_currency</string>
     <string name="toast_incompatible_currency">  .\n-   .</string>
     <string name="header_general_settings"></string>
     <string name="header_about_gnucash"> </string>
@@ -84,7 +83,6 @@
     <string name="label_display_account"> </string>
     <string name="btn_create_accounts"> </string>
     <string name="title_default_accounts">   </string>
-    <string name="key_first_run">key_first_run</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -448,15 +446,12 @@
 	    <item></item>
 	</string-array>
 	<string name="error_no_accounts">   Gnucash.\n  ,    .</string>
-	<string name="key_build_version">build_version</string>
 	<string name="title_build_version"> </string>
 	<string name="title_license"></string>
 	<string name="summary_licence_details">Apache License v2.0. ,  .</string>
 	<string name="title_general_prefs"></string>
-	<string name="key_license">app_license</string>
         <string name="label_widget_configuration"> </string>
 	<string name="toast_no_transactions_to_export">   </string>
-	<string name="key_about">about_gnucash</string>
 	<string name="title_about_gnucash"> Gnucash</string>
         <string name="summary_about_gnucash">Gnucash -     Android.\n         Gnucash       OFX (Open Financial eXchange).</string>
 	<string name="title_about"> </string>
@@ -467,7 +462,6 @@
 	<string name="header_transaction_settings"></string>
 	<string name="title_transaction_preferences"> </string>
 	<string name="title_account_preferences"> </string>
-	<string name="key_default_transaction_type">default_transaction_type</string>
 	<string name="title_default_transaction_type">   </string>
 	<string name="summary_default_transaction_type">   :   </string>
 	<string-array name="transaction_types">
@@ -477,11 +471,8 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="key_export_all_transactions">export_all_transactions</string>
 	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
-	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
 </resources>
\ No newline at end of file

From bddaa9fade0e326126452117e26bdb297769f233 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 30 Nov 2012 00:05:37 +0100
Subject: [PATCH 03/27] Removed currency codes from localization strings
 Currency codes will not change

---
 GnucashMobile/res/values-de/strings.xml     | 177 ---------------------------
 GnucashMobile/res/values-el/strings.xml     | 178 ----------------------------
 GnucashMobile/res/values-es-rMX/strings.xml | 177 ---------------------------
 GnucashMobile/res/values-es/strings.xml     | 177 ---------------------------
 GnucashMobile/res/values-fr/strings.xml     | 178 ----------------------------
 GnucashMobile/res/values-hu/strings.xml     | 178 ----------------------------
 GnucashMobile/res/values-it/strings.xml     | 178 ----------------------------
 GnucashMobile/res/values-nb/strings.xml     | 178 ----------------------------
 GnucashMobile/res/values-nl/strings.xml     | 178 ----------------------------
 GnucashMobile/res/values-pt-rBR/strings.xml | 177 ---------------------------
 GnucashMobile/res/values-ru/strings.xml     | 178 ----------------------------
 11 files changed, 1954 deletions(-)

diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index 07b92890..d5327bcc 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -259,183 +259,6 @@
 		<item>Zimbabwe Dollar</item>
 		<item>Zloty</item>
     </string-array>
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item>Ausgaben</item>
 	    <item>Einkommen</item>
diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index 966bb0cb..fc0bc627 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -260,184 +260,6 @@
 		<item>Zimbabwe Dollar</item>
 		<item>Zloty</item>
     </string-array>
-    
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item></item>
 	    <item></item>
diff --git a/GnucashMobile/res/values-es-rMX/strings.xml b/GnucashMobile/res/values-es-rMX/strings.xml
index 1de7591d..659b06d5 100644
--- a/GnucashMobile/res/values-es-rMX/strings.xml
+++ b/GnucashMobile/res/values-es-rMX/strings.xml
@@ -259,183 +259,6 @@
 		<item>D&#243;lar zimbabuense</item>
 		<item>Zloty polaco</item>
     </string-array>
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item>Gastos</item>
 	    <item>Ingresos</item>
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 974d0b5e..c21d084a 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -260,183 +260,6 @@
 		<item>D&#243;lar zimbabuense</item>
 		<item>Zloty polaco</item>
     </string-array>
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item>Gastos</item>
 	    <item>Ingresos</item>
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index f7a995b3..9ed3740d 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -260,184 +260,6 @@
 		<item>Zimbabwe Dollar</item>
 		<item>Zloty</item>
     </string-array>
-    
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item>D&#233;pense</item>
 	    <item>Revenu</item>
diff --git a/GnucashMobile/res/values-hu/strings.xml b/GnucashMobile/res/values-hu/strings.xml
index 42e55acb..06577161 100644
--- a/GnucashMobile/res/values-hu/strings.xml
+++ b/GnucashMobile/res/values-hu/strings.xml
@@ -259,184 +259,6 @@
 		<item>Zimbabwe Dollar</item>
 		<item>Zloty</item>
     </string-array>
-    
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item>Expenses</item>
 	    <item>Income</item>
diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index d9b0671c..946f99f5 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -260,184 +260,6 @@
 		<item>Zimbabwe Dollar</item>
 		<item>Zloty</item>
     </string-array>
-    
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item>Uscite</item>
 	    <item>Entrate</item>
diff --git a/GnucashMobile/res/values-nb/strings.xml b/GnucashMobile/res/values-nb/strings.xml
index 11afa03e..40a86f86 100644
--- a/GnucashMobile/res/values-nb/strings.xml
+++ b/GnucashMobile/res/values-nb/strings.xml
@@ -261,184 +261,6 @@
 		<item>Zimbabwe Dollar</item>
 		<item>Zloty</item>
     </string-array>
-    
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item>Utgifter</item>
 	    <item>Inntekter</item>
diff --git a/GnucashMobile/res/values-nl/strings.xml b/GnucashMobile/res/values-nl/strings.xml
index ac7b30ec..49f060a0 100644
--- a/GnucashMobile/res/values-nl/strings.xml
+++ b/GnucashMobile/res/values-nl/strings.xml
@@ -260,184 +260,6 @@
 		<item>Zimbabwe Dollar</item>
 		<item>Zloty</item>
     </string-array>
-    
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item>Uitgaven</item>
 	    <item>Inkomsten</item>
diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index e00eb07b..ceeba39b 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -259,183 +259,6 @@
     <item>Dlar do Zimbabue</item>
     <item>Zloty</item>
   </string-array>
-  <string-array name="currency_codes">
-    <item>AFN</item>
-    <item>DZD</item>
-    <item>ARS</item>
-    <item>AMD</item>
-    <item>AWG</item>
-    <item>AUD</item>
-    <item>AZN</item>
-    <item>BSD</item>
-    <item>BHD</item>
-    <item>THB</item>
-    <item>PAB</item>
-    <item>BBD</item>
-    <item>BYR</item>
-    <item>BZD</item>
-    <item>BMD</item>
-    <item>VEF</item>
-    <item>BOB</item>
-    <item>BRL</item>
-    <item>BND</item>
-    <item>BGN</item>
-    <item>BIF</item>
-    <item>CAD</item>
-    <item>CVE</item>
-    <item>KYD</item>
-    <item>XOF</item>
-    <item>XAF</item>
-    <item>XPF</item>
-    <item>CLP</item>
-    <item>XTS</item>
-    <item>COP</item>
-    <item>KMF</item>
-    <item>CDF</item>
-    <item>BAM</item>
-    <item>NIO</item>
-    <item>CRC</item>
-    <item>HRK</item>
-    <item>CUP</item>
-    <item>CZK</item>
-    <item>GMD</item>
-    <item>DKK</item>
-    <item>MKD</item>
-    <item>DJF</item>
-    <item>STD</item>
-    <item>DOP</item>
-    <item>VND</item>
-    <item>XCD</item>
-    <item>EGP</item>
-    <item>SVC</item>
-    <item>ETB</item>
-    <item>EUR</item>
-    <item>FKP</item>
-    <item>FJD</item>
-    <item>HUF</item>
-    <item>GHS</item>
-    <item>GIP</item>
-    <item>XAU</item>
-    <item>HTG</item>
-    <item>PYG</item>
-    <item>GNF</item>
-    <item>GYD</item>
-    <item>HKD</item>
-    <item>UAH</item>
-    <item>ISK</item>
-    <item>INR</item>
-    <item>IRR</item>
-    <item>IQD</item>
-    <item>JMD</item>
-    <item>JOD</item>
-    <item>KES</item>
-    <item>PGK</item>
-    <item>LAK</item>
-    <item>KWD</item>
-    <item>MWK</item>
-    <item>AOA</item>
-    <item>MMK</item>
-    <item>GEL</item>
-    <item>LVL</item>
-    <item>LBP</item>
-    <item>ALL</item>
-    <item>HNL</item>
-    <item>SLL</item>
-    <item>LRD</item>
-    <item>LYD</item>
-    <item>SZL</item>
-    <item>LTL</item>
-    <item>LSL</item>
-    <item>MGA</item>
-    <item>MYR</item>
-    <item>MUR</item>
-    <item>MXN</item>
-    <item>MXV</item>
-    <item>MDL</item>
-    <item>MAD</item>
-    <item>MZN</item>
-    <item>BOV</item>
-    <item>NGN</item>
-    <item>ERN</item>
-    <item>NAD</item>
-    <item>NPR</item>
-    <item>ANG</item>
-    <item>ILS</item>
-    <item>RON</item>
-    <item>TWD</item>
-    <item>NZD</item>
-    <item>BTN</item>
-    <item>KPW</item>
-    <item>NOK</item>
-    <item>PEN</item>
-    <item>MRO</item>
-    <item>TOP</item>
-    <item>PKR</item>
-    <item>XPD</item>
-    <item>MOP</item>
-    <item>CUC</item>
-    <item>UYU</item>
-    <item>PHP</item>
-    <item>XPT</item>
-    <item>GBP</item>
-    <item>BWP</item>
-    <item>QAR</item>
-    <item>GTQ</item>
-    <item>ZAR</item>
-    <item>OMR</item>
-    <item>KHR</item>
-    <item>MVR</item>
-    <item>IDR</item>
-    <item>RUB</item>
-    <item>RWF</item>
-    <item>SHP</item>
-    <item>SAR</item>
-    <item>XDR</item>
-    <item>RSD</item>
-    <item>SCR</item>
-    <item>XAG</item>
-    <item>SGD</item>
-    <item>SBD</item>
-    <item>KGS</item>
-    <item>SOS</item>
-    <item>TJS</item>
-    <item>SSP</item>
-    <item>LKR</item>
-    <item>XSU</item>
-    <item>SDG</item>
-    <item>SRD</item>
-    <item>SEK</item>
-    <item>CHF</item>
-    <item>SYP</item>
-    <item>BDT</item>
-    <item>WST</item>
-    <item>TZS</item>
-    <item>KZT</item>
-    <item>XXX</item>
-    <item>TTD</item>
-    <item>MNT</item>
-    <item>TND</item>
-    <item>TRY</item>
-    <item>TMT</item>
-    <item>AED</item>
-    <item>UGX</item>
-    <item>XFU</item>
-    <item>COU</item>
-    <item>CLF</item>
-    <item>UYI</item>
-    <item>USD</item>
-    <item>UZS</item>
-    <item>VUV</item>
-    <item>CHE</item>
-    <item>CHW</item>
-    <item>KRW</item>
-    <item>YER</item>
-    <item>JPY</item>
-    <item>CNY</item>
-    <item>ZMK</item>
-    <item>ZWL</item>
-    <item>PLN</item>
-  </string-array>
   <string-array name="default_accounts">
     <item>Despesas</item>
     <item>Receitas</item>
diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index 2fea690f..718e14a9 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -260,184 +260,6 @@
 		<item>Zimbabwe Dollar</item>
 		<item>Zloty</item>
     </string-array>
-    
-	<string-array name="currency_codes">
-        <item>AFN</item>
-		<item>DZD</item>
-		<item>ARS</item>
-		<item>AMD</item>
-		<item>AWG</item>
-		<item>AUD</item>
-		<item>AZN</item>
-		<item>BSD</item>
-		<item>BHD</item>
-		<item>THB</item>
-		<item>PAB</item>
-		<item>BBD</item>
-		<item>BYR</item>
-		<item>BZD</item>
-		<item>BMD</item>
-		<item>VEF</item>
-		<item>BOB</item>
-		<item>BRL</item>
-		<item>BND</item>
-		<item>BGN</item>
-		<item>BIF</item>
-		<item>CAD</item>
-		<item>CVE</item>
-		<item>KYD</item>
-		<item>XOF</item>
-		<item>XAF</item>
-		<item>XPF</item>
-		<item>CLP</item>
-		<item>XTS</item>
-		<item>COP</item>
-		<item>KMF</item>
-		<item>CDF</item>
-		<item>BAM</item>
-		<item>NIO</item>
-		<item>CRC</item>
-		<item>HRK</item>
-		<item>CUP</item>
-		<item>CZK</item>
-		<item>GMD</item>
-		<item>DKK</item>
-		<item>MKD</item>
-		<item>DJF</item>
-		<item>STD</item>
-		<item>DOP</item>
-		<item>VND</item>
-		<item>XCD</item>
-		<item>EGP</item>
-		<item>SVC</item>
-		<item>ETB</item>
-		<item>EUR</item>
-		<item>FKP</item>
-		<item>FJD</item>
-		<item>HUF</item>
-		<item>GHS</item>
-		<item>GIP</item>
-		<item>XAU</item>
-		<item>HTG</item>
-		<item>PYG</item>
-		<item>GNF</item>
-		<item>GYD</item>
-		<item>HKD</item>
-		<item>UAH</item>
-		<item>ISK</item>
-		<item>INR</item>
-		<item>IRR</item>
-		<item>IQD</item>
-		<item>JMD</item>
-		<item>JOD</item>
-		<item>KES</item>
-		<item>PGK</item>
-		<item>LAK</item>
-		<item>KWD</item>
-		<item>MWK</item>
-		<item>AOA</item>
-		<item>MMK</item>
-		<item>GEL</item>
-		<item>LVL</item>
-		<item>LBP</item>
-		<item>ALL</item>
-		<item>HNL</item>
-		<item>SLL</item>
-		<item>LRD</item>
-		<item>LYD</item>
-		<item>SZL</item>
-		<item>LTL</item>
-		<item>LSL</item>
-		<item>MGA</item>
-		<item>MYR</item>
-		<item>MUR</item>
-		<item>MXN</item>
-		<item>MXV</item>
-		<item>MDL</item>
-		<item>MAD</item>
-		<item>MZN</item>
-		<item>BOV</item>
-		<item>NGN</item>
-		<item>ERN</item>
-		<item>NAD</item>
-		<item>NPR</item>
-		<item>ANG</item>
-		<item>ILS</item>
-		<item>RON</item>
-		<item>TWD</item>
-		<item>NZD</item>
-		<item>BTN</item>
-		<item>KPW</item>
-		<item>NOK</item>
-		<item>PEN</item>
-		<item>MRO</item>
-		<item>TOP</item>
-		<item>PKR</item>
-		<item>XPD</item>
-		<item>MOP</item>
-		<item>CUC</item>
-		<item>UYU</item>
-		<item>PHP</item>
-		<item>XPT</item>
-		<item>GBP</item>
-		<item>BWP</item>
-		<item>QAR</item>
-		<item>GTQ</item>
-		<item>ZAR</item>
-		<item>OMR</item>
-		<item>KHR</item>
-		<item>MVR</item>
-		<item>IDR</item>
-		<item>RUB</item>
-		<item>RWF</item>
-		<item>SHP</item>
-		<item>SAR</item>
-		<item>XDR</item>
-		<item>RSD</item>
-		<item>SCR</item>
-		<item>XAG</item>
-		<item>SGD</item>
-		<item>SBD</item>
-		<item>KGS</item>
-		<item>SOS</item>
-		<item>TJS</item>
-		<item>SSP</item>
-		<item>LKR</item>
-		<item>XSU</item>
-		<item>SDG</item>
-		<item>SRD</item>
-		<item>SEK</item>
-		<item>CHF</item>
-		<item>SYP</item>
-		<item>BDT</item>
-		<item>WST</item>
-		<item>TZS</item>
-		<item>KZT</item>
-		<item>XXX</item>
-		<item>TTD</item>
-		<item>MNT</item>
-		<item>TND</item>
-		<item>TRY</item>
-		<item>TMT</item>
-		<item>AED</item>
-		<item>UGX</item>
-		<item>XFU</item>
-		<item>COU</item>
-		<item>CLF</item>
-		<item>UYI</item>
-		<item>USD</item>
-		<item>UZS</item>
-		<item>VUV</item>
-		<item>CHE</item>
-		<item>CHW</item>
-		<item>KRW</item>
-		<item>YER</item>
-		<item>JPY</item>
-		<item>CNY</item>
-		<item>ZMK</item>
-		<item>ZWL</item>
-		<item>PLN</item>
-    </string-array>
 	<string-array name="default_accounts">
 	    <item></item>
 	    <item></item>

From 7db7dea10579e49fc900bfc7c5b97b5084b8ff05 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 12 Dec 2012 02:25:02 +0100
Subject: [PATCH 04/27] Feature: Display account balance in account screen
 Improved: Display time & date throughout the app in the device locale
 Improved handling of double accounts when editing transactions Code
 refactoring

---
 .../res/layout/fragment_accounts_list.xml          | 14 +++++--
 .../res/layout/fragment_transactions_list.xml      | 29 +--------------
 GnucashMobile/res/layout/transactions_sum_bar.xml  | 43 ++++++++++++++++++++++
 GnucashMobile/res/values/strings.xml               |  1 +
 .../src/org/gnucash/android/data/Account.java      |  4 +-
 .../src/org/gnucash/android/data/Money.java        | 10 +++++
 .../org/gnucash/android/db/AccountsDbAdapter.java  | 33 +++++++++++++++++
 .../gnucash/android/db/TransactionsDbAdapter.java  | 19 ++++++++++
 .../android/ui/accounts/AccountsListFragment.java  | 24 +++++++++++-
 .../ui/transactions/NewTransactionFragment.java    | 38 +++++++++++--------
 10 files changed, 164 insertions(+), 51 deletions(-)
 create mode 100644 GnucashMobile/res/layout/transactions_sum_bar.xml

diff --git a/GnucashMobile/res/layout/fragment_accounts_list.xml b/GnucashMobile/res/layout/fragment_accounts_list.xml
index 3951a1eb..d83ad0fa 100644
--- a/GnucashMobile/res/layout/fragment_accounts_list.xml
+++ b/GnucashMobile/res/layout/fragment_accounts_list.xml
@@ -15,21 +15,27 @@
  limitations under the License.
 -->
 
-<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:orientation="vertical" >
 
+    <include layout="@layout/transactions_sum_bar" 
+        android:id="@+id/transactions_sum_bar" />
+    
     <ListView android:id="@id/android:list"        
         android:layout_width="match_parent"
-        android:layout_height="0dp"	
-        android:layout_weight="1"
+        android:layout_height="match_parent"	
+        android:layout_above="@id/transactions_sum_bar"
+        android:listSelector="@drawable/abs__list_selector_holo_light"
+        android:drawSelectorOnTop="false"
         />
     
 	<LinearLayout
         android:id="@id/android:empty"
         android:layout_width="match_parent"
         android:layout_height="match_parent"
+        android:layout_above="@id/transactions_sum_bar"
         android:gravity="center"
         android:orientation="vertical">
 		<TextView 
@@ -44,4 +50,4 @@
             android:onClick="onNewAccountClick"
             android:text="@string/title_add_account" />
     </LinearLayout>
-</LinearLayout>
\ No newline at end of file
+</RelativeLayout>
\ No newline at end of file
diff --git a/GnucashMobile/res/layout/fragment_transactions_list.xml b/GnucashMobile/res/layout/fragment_transactions_list.xml
index 63059c9c..ab57f318 100644
--- a/GnucashMobile/res/layout/fragment_transactions_list.xml
+++ b/GnucashMobile/res/layout/fragment_transactions_list.xml
@@ -19,34 +19,9 @@
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:orientation="vertical" >
-
-	<LinearLayout android:id="@+id/transactions_sum_bar"
-		android:layout_width="match_parent" 
-		android:layout_height="wrap_content"
-		android:layout_alignParentBottom="true"
-		android:background="@drawable/abs__ab_bottom_solid_light_holo"
-		android:orientation="horizontal"
-		android:minHeight="50dp"
-		style="@style/ListItem">
-        	    
-		<TextView  
-			android:layout_width="0dp"
-			android:layout_height="wrap_content"
-			android:gravity="left|center_vertical"
-			android:layout_weight="1"
-			android:layout_marginLeft="20dp"
-			android:text="@string/label_transactions_total" 			
-			style="@style/ListItemText" />
-		
-		<TextView android:id="@+id/transactions_sum"
-			android:layout_width="wrap_content"
-			android:layout_height="wrap_content"
-			android:gravity="right|center_vertical"
-			android:layout_marginRight="@dimen/edge_padding"			
-			style="@style/ListItemText" />
+    
+	<include layout="@layout/transactions_sum_bar" android:id="@+id/transactions_sum_bar" />
 		
-	</LinearLayout>	
-	
     <ListView android:id="@id/android:list"        
         android:layout_width="match_parent"
         android:layout_height="match_parent"	
diff --git a/GnucashMobile/res/layout/transactions_sum_bar.xml b/GnucashMobile/res/layout/transactions_sum_bar.xml
new file mode 100644
index 00000000..0c53c575
--- /dev/null
+++ b/GnucashMobile/res/layout/transactions_sum_bar.xml
@@ -0,0 +1,43 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+ Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
+ 
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+ 
+    http://www.apache.org/licenses/LICENSE-2.0
+ 
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    	android:id="@+id/transactions_sum_bar"
+		android:layout_width="match_parent" 
+		android:layout_height="wrap_content"
+		android:layout_alignParentBottom="true"
+		android:background="@drawable/abs__ab_bottom_solid_light_holo"
+		android:orientation="horizontal"
+		android:minHeight="50dp"
+		style="@style/ListItem">
+        	    
+		<TextView android:id="@+id/label_sum" 
+			android:layout_width="0dp"
+			android:layout_height="wrap_content"
+			android:gravity="left|center_vertical"
+			android:layout_weight="1"
+			android:layout_marginLeft="@dimen/edge_padding"
+			android:text="@string/label_transactions_total" 			
+			style="@style/ListItemText" />
+		
+		<TextView android:id="@+id/transactions_sum"
+			android:layout_width="wrap_content"
+			android:layout_height="wrap_content"
+			android:gravity="right|center_vertical"
+			android:layout_marginRight="@dimen/edge_padding"			
+			style="@style/ListItemText" />
+		
+</LinearLayout>
\ No newline at end of file
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 6d4aef73..50ed1f6e 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -491,4 +491,5 @@
 	<string name="key_use_double_entry">use_double_entry</string>
 	<string name="summary_use_double_entry">All transactions will involve two accounts: source and destination accounts</string>
 	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index 05b37993..6017f380 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -49,7 +49,7 @@
 	 * This are the different types specified by the OFX format and 
 	 * they are currently not used except for exporting
 	 */
-	public enum AccountType {CHECKING, SAVINGS, MONEYMRKT, CREDITLINE};
+	public enum AccountType {CASH, BANK, CREDIT_CARD, ASSET, LIABILITY, INCOME, EXPENSE, EQUITY, CURRENCY, STOCK, MUTUAL_FUND};
 	
 	/**
 	 * Unique Identifier of the account
@@ -71,7 +71,7 @@
 	 * Type of account
 	 * Defaults to {@link AccountType#CHECKING}
 	 */
-	private AccountType mAccountType = AccountType.CHECKING;
+	private AccountType mAccountType = AccountType.CASH;
 	
 	/**
 	 * List of transactions in this account
diff --git a/GnucashMobile/src/org/gnucash/android/data/Money.java b/GnucashMobile/src/org/gnucash/android/data/Money.java
index bd93fc33..6fa96fa0 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Money.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Money.java
@@ -135,6 +135,16 @@ public Money(String amount){
 	}
 
 	/**
+	 * Overloaded constructor. 
+	 * Initializes the currency to that specified by {@link Money#DEFAULT_CURRENCY_CODE}
+	 * @param amount Value associated with this Money object
+	 */
+	public Money(BigDecimal amount){
+		init();
+		setAmount(amount);
+	}
+	
+	/**
 	 * Initializes the amount and currency to their default values
 	 * @see {@link Money#DEFAULT_CURRENCY_CODE}, {@link #DEFAULT_ROUNDING_MODE}, {@link #DEFAULT_DECIMAL_PLACES}
 	 */
diff --git a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
index 5ba45620..e5d0515f 100644
--- a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -22,6 +22,7 @@
 import java.util.List;
 
 import org.gnucash.android.data.Account;
+import org.gnucash.android.data.Money;
 import org.gnucash.android.data.Account.AccountType;
 import org.gnucash.android.data.Transaction;
 
@@ -278,6 +279,38 @@ public Cursor fetchAccounts(String condition){
 	}
 	
 	/**
+	 * Returns the balance of all accounts with each transaction counted only once
+	 * This does not take into account the currencies and double entry 
+	 * transactions are not considered as well.
+	 * @return Balance of all accounts in the database
+	 * @see AccountsDbAdapter#getDoubleEntryAccountsBalance()
+	 */
+	public Money getAllAccountsBalance(){
+		return mTransactionsAdapter.getAllTransactionsSum();
+	}
+	
+	/**
+	 * Returns the balance for all transactions while taking double entry into consideration
+	 * This means that double transactions will be counted twice
+	 * @return Total balance of the accounts while using double entry
+	 */
+	public Money getDoubleEntryAccountsBalance(){
+		Cursor c = mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME, 
+				new String[]{DatabaseHelper.KEY_ROW_ID}, 
+				null, null, null, null, null);
+		Money totalSum = new Money();
+		if (c != null){
+			while (c.moveToNext()) {
+				long id = c.getLong(DatabaseAdapter.COLUMN_ROW_ID);
+				Money sum = mTransactionsAdapter.getTransactionsSum(id);
+				totalSum = totalSum.add(sum);
+			}
+			c.close();
+		}
+		return totalSum;
+	}
+	
+	/**
 	 * Return the record ID for the account with UID <code>accountUID</code>
 	 * @param accountUID String Unique ID of the account
 	 * @return Record ID belonging to account UID
diff --git a/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
index 225f2912..295829b0 100644
--- a/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
@@ -339,6 +339,25 @@ public Money getTransactionsSum(long accountId){
 	}
 	
 	/**
+	 * Returns the balance of all accounts with each transaction counted only once
+	 * This does not take into account the currencies and double entry 
+	 * transactions are not considered as well.
+	 * @return Balance of all accounts in the database
+	 * @see AccountsDbAdapter#getDoubleEntryAccountsBalance()
+	 */
+	public Money getAllTransactionsSum(){
+		String query = "SELECT TOTAL(" + DatabaseHelper.KEY_AMOUNT +") FROM " + DatabaseHelper.TRANSACTIONS_TABLE_NAME;
+		Cursor c = mDb.rawQuery(query, null); 
+//				new String[]{DatabaseHelper.KEY_AMOUNT, DatabaseHelper.TRANSACTIONS_TABLE_NAME});
+		double result = 0;
+		if (c != null && c.moveToFirst()){
+			result = c.getDouble(0);	
+		}
+		c.close();
+		return new Money(new BigDecimal(result));	
+	}
+	
+	/**
 	 * Returns true if <code>rowId</code> and <code>accountUID</code> belong to the same account
 	 * @param rowId Database record ID
 	 * @param accountUID Unique Identifier string of the account
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
index caf36827..d3158261 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
@@ -40,6 +40,7 @@
 import android.content.Intent;
 import android.database.Cursor;
 import android.os.Bundle;
+import android.preference.PreferenceManager;
 import android.support.v4.app.DialogFragment;
 import android.support.v4.app.Fragment;
 import android.support.v4.app.FragmentManager;
@@ -220,8 +221,11 @@ public void onClick(DialogInterface dialog, int whichButton) {
 	@Override
 	public View onCreateView(LayoutInflater inflater, ViewGroup container,
 			Bundle savedInstanceState) {
-		return inflater.inflate(R.layout.fragment_accounts_list, container,
+		View v = inflater.inflate(R.layout.fragment_accounts_list, container,
 				false);
+		TextView sumlabelTextView = (TextView) v.findViewById(R.id.label_sum);		
+		sumlabelTextView.setText(R.string.account_balance);
+		return v;
 	}
 	
 	@Override
@@ -246,7 +250,7 @@ public void onActivityCreated(Bundle savedInstanceState) {
 		actionbar.setDisplayHomeAsUpEnabled(false);
 		
 		setHasOptionsMenu(true);
-		
+				
 		ListView lv = getListView();
 		lv.setOnItemLongClickListener(this);	
 		getLoaderManager().initLoader(0, null, this);		
@@ -410,6 +414,22 @@ public boolean onOptionsItemSelected(MenuItem item) {
 	 */
 	public void refreshList(){
 		getLoaderManager().restartLoader(0, null, this);
+		
+		boolean doubleEntryActive = PreferenceManager.getDefaultSharedPreferences(getActivity())
+				.getBoolean(getString(R.string.key_use_double_entry), false);
+		
+		TextView tv = (TextView) getView().findViewById(R.id.transactions_sum);	
+		Money balance = null; 
+		if (doubleEntryActive){
+			balance = mAccountsDbAdapter.getDoubleEntryAccountsBalance();
+		} else {
+			balance = mAccountsDbAdapter.getAllAccountsBalance();
+		}
+		tv.setText(balance.formattedString(Locale.getDefault()));
+		if (balance.isNegative())
+			tv.setTextColor(getResources().getColor(R.color.debit_red));
+		else
+			tv.setTextColor(getResources().getColor(R.color.credit_green));
 	}
 	
 	/**
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
index 3d2437a9..29e2b121 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
@@ -18,10 +18,10 @@
 
 import java.math.BigDecimal;
 import java.math.RoundingMode;
+import java.text.DateFormat;
 import java.text.DecimalFormat;
 import java.text.NumberFormat;
 import java.text.ParseException;
-import java.text.SimpleDateFormat;
 import java.util.Calendar;
 import java.util.Currency;
 import java.util.Date;
@@ -119,12 +119,12 @@
 	/**
 	 * Formats a {@link Date} object into a date string of the format dd MMM yyyy e.g. 18 July 2012
 	 */
-	public final static SimpleDateFormat DATE_FORMATTER = new SimpleDateFormat("dd MMM yyyy");
+	public final static DateFormat DATE_FORMATTER = DateFormat.getDateInstance();
 	
 	/**
 	 * Formats a {@link Date} object to time string of format HH:mm e.g. 15:25
 	 */
-	public final static SimpleDateFormat TIME_FORMATTER = new SimpleDateFormat("HH:mm");
+	public final static DateFormat TIME_FORMATTER = DateFormat.getTimeInstance();
 	
 	/**
 	 * Button for setting the transaction type, either credit or debit
@@ -219,22 +219,11 @@ public void onActivityCreated(Bundle savedInstanceState) {
 		mUseDoubleEntry = sharedPrefs.getBoolean(getString(R.string.key_use_double_entry), false);
 		if (mUseDoubleEntry == false){
 			getView().findViewById(R.id.layout_double_entry).setVisibility(View.GONE);
-//			mTransferAccountSpinner.setVisibility(View.GONE);
 		}
 		
-		String[] from = new String[] {DatabaseHelper.KEY_NAME};
-		int[] to = new int[] {android.R.id.text1};
+		//updateTransferAccountsList must only be called after creating mAccountsDbAdapter
 		mAccountsDbAdapter = new AccountsDbAdapter(getActivity());
-		long accountId = ((TransactionsActivity)getActivity()).getCurrentAccountID();
-		String conditions = "(" + DatabaseHelper.KEY_ROW_ID + " != " + accountId + ") AND " + "(" +
-							DatabaseHelper.KEY_CURRENCY_CODE + " = '" + mAccountsDbAdapter.getCurrencyCode(accountId) + "')";
-		mCursor = mAccountsDbAdapter.fetchAccounts(conditions);
-		
-		mCursorAdapter = new SimpleCursorAdapter(getActivity(), 
-				android.R.layout.simple_spinner_item, 
-				mCursor, from, to, 0);
-		mCursorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
-		mTransferAccountSpinner.setAdapter(mCursorAdapter);
+		updateTransferAccountsList();
 		
 		mTransactionId = getArguments().getLong(SELECTED_TRANSACTION_ID);
 		mTransactionsDbAdapter = new TransactionsDbAdapter(getActivity());
@@ -309,6 +298,21 @@ private void initalizeViews() {
 		mCurrencyTextView.setText(accountCurrency.getSymbol(Locale.getDefault()));
 	}
 	
+	private void updateTransferAccountsList(){
+		long accountId = ((TransactionsActivity)getActivity()).getCurrentAccountID();
+		String conditions = "(" + DatabaseHelper.KEY_ROW_ID + " != " + accountId + ") AND " + "(" +
+							DatabaseHelper.KEY_CURRENCY_CODE + " = '" + mAccountsDbAdapter.getCurrencyCode(accountId) + "')";
+		mCursor = mAccountsDbAdapter.fetchAccounts(conditions);
+		
+		String[] from = new String[] {DatabaseHelper.KEY_NAME};
+		int[] to = new int[] {android.R.id.text1};
+		mCursorAdapter = new SimpleCursorAdapter(getActivity(), 
+				android.R.layout.simple_spinner_item, 
+				mCursor, from, to, 0);
+		mCursorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);		
+		mTransferAccountSpinner.setAdapter(mCursorAdapter);
+	}
+	
 	/**
 	 * Sets click listeners for the dialog buttons
 	 */
@@ -399,6 +403,8 @@ public void onAccountChanged(long newAccountId){
 		Currency currency = Currency.getInstance(currencyCode);
 		mCurrencyTextView.setText(currency.getSymbol(Locale.getDefault()));
 		accountsDbAdapter.close();
+		
+		updateTransferAccountsList();
 	}
 	
 	/**

From aa3a9b078434e0a5a22c7f51ccdda16f176e40ef Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Sat, 15 Dec 2012 01:22:50 +0100
Subject: [PATCH 05/27] Feature: Nested accounts (arbitrary nesting levels)
 Improved: Creating accounts no longer uses a dialog, it has its own screen

---
 GnucashMobile/res/layout/dialog_new_account.xml    |  43 ----
 GnucashMobile/res/layout/fragment_new_account.xml  |  84 +++++++
 ...action_actions.xml => default_save_actions.xml} |   0
 GnucashMobile/res/values-de/strings.xml            |   2 +-
 GnucashMobile/res/values-el/strings.xml            |   1 +
 GnucashMobile/res/values-es-rMX/strings.xml        |   1 +
 GnucashMobile/res/values-es/strings.xml            |   1 +
 GnucashMobile/res/values-fr/strings.xml            |   1 +
 GnucashMobile/res/values-it/strings.xml            |   4 +-
 GnucashMobile/res/values-nb/strings.xml            |   1 +
 GnucashMobile/res/values-nl/strings.xml            |   1 +
 GnucashMobile/res/values-pt-rBR/strings.xml        |   1 +
 GnucashMobile/res/values-ru/strings.xml            |   1 +
 GnucashMobile/res/values/strings.xml               |   3 +
 .../src/org/gnucash/android/data/Account.java      |  19 +-
 .../org/gnucash/android/db/AccountsDbAdapter.java  |  43 +++-
 .../org/gnucash/android/db/DatabaseAdapter.java    |   1 +
 .../src/org/gnucash/android/db/DatabaseHelper.java |  13 +-
 .../android/ui/accounts/AccountsActivity.java      |   2 +-
 .../android/ui/accounts/AccountsListFragment.java  |  73 +++---
 .../android/ui/accounts/AddAccountFragment.java    | 277 +++++++++++++++++++++
 .../ui/accounts/NewAccountDialogFragment.java      | 243 ------------------
 .../ui/transactions/NewTransactionFragment.java    |   2 +-
 23 files changed, 479 insertions(+), 338 deletions(-)
 delete mode 100644 GnucashMobile/res/layout/dialog_new_account.xml
 create mode 100644 GnucashMobile/res/layout/fragment_new_account.xml
 rename GnucashMobile/res/menu/{new_transaction_actions.xml => default_save_actions.xml} (100%)
 create mode 100644 GnucashMobile/src/org/gnucash/android/ui/accounts/AddAccountFragment.java
 delete mode 100644 GnucashMobile/src/org/gnucash/android/ui/accounts/NewAccountDialogFragment.java

diff --git a/GnucashMobile/res/layout/dialog_new_account.xml b/GnucashMobile/res/layout/dialog_new_account.xml
deleted file mode 100644
index da6bfae3..00000000
--- a/GnucashMobile/res/layout/dialog_new_account.xml
+++ /dev/null
@@ -1,43 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
- Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
- 
- Licensed under the Apache License, Version 2.0 (the "License");
- you may not use this file except in compliance with the License.
- You may obtain a copy of the License at
- 
-    http://www.apache.org/licenses/LICENSE-2.0
- 
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-
-<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
-    android:layout_width="match_parent"
-    android:layout_height="match_parent"
-    android:orientation="vertical" >
-    
-    <EditText
-        android:id="@+id/edit_text_account_name"
-        android:layout_width="match_parent"
-        android:layout_height="50dp"
-        android:layout_margin="10dp"
-        android:ems="15" 
-        android:inputType="textCapWords"
-        android:singleLine="true"
-        android:ellipsize="start"
-        android:hint="@string/label_account_name">
-        <requestFocus />
-    </EditText>
-    
-    <Spinner android:id="@+id/input_currency_spinner"
-        android:layout_width="match_parent"
-		android:layout_height="wrap_content"
-		android:layout_margin="10dp"		/>
-       
-    <include layout="@layout/default_buttons"/>
-
-</LinearLayout>
\ No newline at end of file
diff --git a/GnucashMobile/res/layout/fragment_new_account.xml b/GnucashMobile/res/layout/fragment_new_account.xml
new file mode 100644
index 00000000..8e1a611c
--- /dev/null
+++ b/GnucashMobile/res/layout/fragment_new_account.xml
@@ -0,0 +1,84 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+ Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
+ 
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+ 
+    http://www.apache.org/licenses/LICENSE-2.0
+ 
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:orientation="vertical" >
+    
+    <EditText
+        android:id="@+id/edit_text_account_name"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="10dp"
+        android:layout_marginLeft="10dp"
+        android:layout_marginRight="10dp"
+        android:layout_marginBottom="20dp"
+        android:ems="15" 
+        android:inputType="textCapWords"
+        android:minHeight="?android:attr/listPreferredItemHeight"
+        android:singleLine="true"
+        android:ellipsize="start"
+        android:hint="@string/label_account_name"
+        style="@style/ListItemText">
+        <requestFocus />
+    </EditText>
+    
+    <TextView
+	    android:text="@string/label_account_currency"
+	    android:layout_height="wrap_content"
+	    android:layout_width="wrap_content"
+	    android:layout_marginBottom="-8dip"
+	    android:layout_marginLeft="10dp"
+	    style="@style/TextAppearance.EditTransaction_LabelSmall" />
+    
+    <Spinner android:id="@+id/input_currency_spinner"
+        android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:layout_marginLeft="10dp"
+		android:layout_marginRight="10dp"
+		android:layout_marginBottom="20dp"
+		style="@style/ListItem"		/>
+
+    
+    <TextView
+	    android:text="@string/label_parent_account"
+	    android:layout_height="wrap_content"
+	    android:layout_width="wrap_content"
+	    android:layout_marginLeft="10dp"
+	    android:layout_marginBottom="-8dip"
+	    style="@style/TextAppearance.EditTransaction_LabelSmall" />
+    
+    <LinearLayout 
+        android:layout_width="match_parent"
+	    android:layout_height="wrap_content"
+	    style="@style/ListItem"
+	    android:orientation="horizontal" >
+	    
+	    <CheckBox android:id="@+id/checkbox"
+	        android:layout_width="wrap_content"
+	        android:layout_height="wrap_content"
+	        android:focusable="false"        />
+	    <Spinner
+	        android:id="@+id/input_parent_account"        
+	        android:layout_width="match_parent"
+	        android:layout_height="wrap_content"
+	        android:layout_marginLeft="10dp"
+			android:layout_marginRight="10dp"			
+	        android:minHeight="?android:attr/listPreferredItemHeight" />
+	</LinearLayout>
+</LinearLayout>
\ No newline at end of file
diff --git a/GnucashMobile/res/menu/new_transaction_actions.xml b/GnucashMobile/res/menu/default_save_actions.xml
similarity index 100%
rename from GnucashMobile/res/menu/new_transaction_actions.xml
rename to GnucashMobile/res/menu/default_save_actions.xml
diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index d5327bcc..8652e92f 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -297,5 +297,5 @@
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
-	
+	<string name="toast_no_account_name_entered">Bitte tragen Sie einen Kontoname ein</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index fc0bc627..f2665d7b 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -303,4 +303,5 @@
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>		
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
 </resources>
diff --git a/GnucashMobile/res/values-es-rMX/strings.xml b/GnucashMobile/res/values-es-rMX/strings.xml
index 659b06d5..e9a62867 100644
--- a/GnucashMobile/res/values-es-rMX/strings.xml
+++ b/GnucashMobile/res/values-es-rMX/strings.xml
@@ -296,4 +296,5 @@
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index c21d084a..33634566 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -297,4 +297,5 @@
 	<string name="title_always_delete_exported_transactions">Borrar siempre todas las transacciones exportadas</string>
 	<string name="title_default_export_email">Correo electr&#243;nico por defecto para exportar</string>
 	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Puedes cambiarla en cada exportaci&#243;n.</string>
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
 </resources>
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index 9ed3740d..c5392cf1 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -297,4 +297,5 @@
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index 946f99f5..d8e0b5fb 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -297,5 +297,5 @@
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
-</resources>
-
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
+</resources>
diff --git a/GnucashMobile/res/values-nb/strings.xml b/GnucashMobile/res/values-nb/strings.xml
index 40a86f86..3705be2b 100644
--- a/GnucashMobile/res/values-nb/strings.xml
+++ b/GnucashMobile/res/values-nb/strings.xml
@@ -300,4 +300,5 @@ format og importeres i regnskapsprogrammet GnuCash for PC.</string>
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
 </resources>
diff --git a/GnucashMobile/res/values-nl/strings.xml b/GnucashMobile/res/values-nl/strings.xml
index 49f060a0..ed78dc2f 100644
--- a/GnucashMobile/res/values-nl/strings.xml
+++ b/GnucashMobile/res/values-nl/strings.xml
@@ -297,4 +297,5 @@
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
 </resources>
diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index ceeba39b..dffeaf7c 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -296,4 +296,5 @@
   <string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
   <string name="title_default_export_email">Default export email</string>
   <string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>  
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index 718e14a9..c2f37ca8 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -297,4 +297,5 @@
 	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 50ed1f6e..93ce2395 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -492,4 +492,7 @@
 	<string name="summary_use_double_entry">All transactions will involve two accounts: source and destination accounts</string>
 	<string name="title_use_double_entry">Activate Double Entry</string>
 	<string name="account_balance">Balance</string>
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index 6017f380..078ba0ca 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -20,6 +20,7 @@
 import java.util.ArrayList;
 import java.util.Currency;
 import java.util.List;
+import java.util.Locale;
 import java.util.UUID;
 
 import org.w3c.dom.Document;
@@ -49,7 +50,8 @@
 	 * This are the different types specified by the OFX format and 
 	 * they are currently not used except for exporting
 	 */
-	public enum AccountType {CASH, BANK, CREDIT_CARD, ASSET, LIABILITY, INCOME, EXPENSE, EQUITY, CURRENCY, STOCK, MUTUAL_FUND};
+	public enum AccountType {CASH, BANK, CREDIT_CARD, ASSET, LIABILITY, INCOME, EXPENSE, EQUITY, CURRENCY, STOCK, MUTUAL_FUND,
+		CHECKING, SAVINGS, MONEYMRKT, CREDITLINE};
 	
 	/**
 	 * Unique Identifier of the account
@@ -79,6 +81,11 @@
 	private List<Transaction> mTransactionsList = new ArrayList<Transaction>();
 
 	/**
+	 * Account UID of the parent account
+	 */
+	private String mParentAccountUID;
+
+	/**
 	 * An extra key for passing the currency code (according ISO 4217) in an intent
 	 */
 	public static final String EXTRA_CURRENCY_CODE 	= "org.gnucash.android.extra.currency_code";
@@ -135,7 +142,7 @@ protected String generateUID(){
 		}
 		
 		uuid = uuid.substring(uuid.lastIndexOf("-"));
-		String name = mName.toLowerCase().replace(" ", "-");
+		String name = mName.toLowerCase(Locale.US).replace(" ", "-");
 		if (name.length() > 9)
 			name = name.substring(0, 10);
 		uuid = name + uuid;		
@@ -271,6 +278,14 @@ public void setCurrency(Currency mCurrency) {
 		//transaction values to the corresponding value in the new currency
 	}
 
+	public void setParentUID(String parentUID){
+		mParentAccountUID = parentUID;
+	}
+	
+	public String getParentUID() {
+		return mParentAccountUID;
+		
+	}
 	/**
 	 * Converts this account's transactions into XML and adds them to the DOM document
 	 * @param doc XML DOM document for the OFX data
diff --git a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
index e5d0515f..a452f1fd 100644
--- a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -72,6 +72,7 @@ public long addAccount(Account account){
 		contentValues.put(DatabaseHelper.KEY_TYPE, account.getAccountType().name());
 		contentValues.put(DatabaseHelper.KEY_UID, account.getUID());
 		contentValues.put(DatabaseHelper.KEY_CURRENCY_CODE, account.getCurrency().getCurrencyCode());
+		contentValues.put(DatabaseHelper.KEY_PARENT_ACCOUNT_UID, account.getParentUID());
 		
 		long rowId = -1;
 		if ((rowId = getAccountID(account.getUID())) > 0){
@@ -150,6 +151,7 @@ public Account buildAccountInstance(Cursor c){
 		Account account = new Account(c.getString(DatabaseAdapter.COLUMN_NAME));
 		String uid = c.getString(DatabaseAdapter.COLUMN_UID);
 		account.setUID(uid);
+		account.setParentUID(c.getString(DatabaseAdapter.COLUMN_PARENT_ACCOUNT_UID));
 		account.setAccountType(AccountType.valueOf(c.getString(DatabaseAdapter.COLUMN_TYPE)));
 		//make sure the account currency is set before setting the transactions
 		//else the transactions end up with a different currency from the account
@@ -178,6 +180,26 @@ public long getAccountID(String uid){
 	}
 	
 	/**
+	 * Returns the  unique ID of the parent account of the account with unique ID <code>uid</code>
+	 * If the account has no parent, null is returned
+	 * @param uid Unique Identifier of account whose parent is to be returned
+	 * @return DB record UID of the parent account, null if the account has no parent
+	 */
+	public String getParentAccountUID(String uid){
+		Cursor cursor = mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME, 
+				new String[] {DatabaseHelper.KEY_ROW_ID, DatabaseHelper.KEY_PARENT_ACCOUNT_UID}, 
+				DatabaseHelper.KEY_UID + " = '" + uid + "'", null, null, null, null);
+		String result = null;
+		if (cursor != null && cursor.moveToFirst()){
+			Log.d(TAG, "Account already exists. Returning existing id");
+			result = cursor.getString(0); //0 because only one row was requested
+
+			cursor.close();
+		}
+		return result;
+	}	
+	
+	/**
 	 * Retrieves an account object from a database with database ID <code>rowId</code>
 	 * @param rowId Identifier of the account record to be retrieved
 	 * @return {@link Account} object corresponding to database record
@@ -192,7 +214,7 @@ public Account getAccount(long rowId){
 		}
 		return account;
 	}
-	
+		
 	/**
 	 * Returns the {@link Account} object populated with data from the database
 	 * for the record with UID <code>uid</code>
@@ -204,6 +226,24 @@ public Account getAccount(String uid){
 	}	
 	
 	/**
+	 * Returns the unique identifier for the account with record ID <code>id</code>
+	 * @param id Database record id of account
+	 * @return Unique identifier string of the account
+	 */
+	public String getAccountUID(long id){
+		String uid = null;
+		Cursor c = mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME, 
+				new String[]{DatabaseHelper.KEY_ROW_ID, DatabaseHelper.KEY_UID}, 
+				DatabaseHelper.KEY_ROW_ID + "=" + id, 
+				null, null, null, null);
+		if (c != null && c.moveToFirst()){
+			uid = c.getString(1);
+			c.close();
+		}
+		return uid;
+	}
+	
+	/**
 	 * Returns the name of the account with id <code>accountID</code>
 	 * @param accountID Database ID of the account record
 	 * @return Name of the account 
@@ -295,6 +335,7 @@ public Money getAllAccountsBalance(){
 	 * @return Total balance of the accounts while using double entry
 	 */
 	public Money getDoubleEntryAccountsBalance(){
+		//FIXME: This does not take account currency into consideration
 		Cursor c = mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME, 
 				new String[]{DatabaseHelper.KEY_ROW_ID}, 
 				null, null, null, null, null);
diff --git a/GnucashMobile/src/org/gnucash/android/db/DatabaseAdapter.java b/GnucashMobile/src/org/gnucash/android/db/DatabaseAdapter.java
index 341a7007..ec2d0f74 100644
--- a/GnucashMobile/src/org/gnucash/android/db/DatabaseAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/DatabaseAdapter.java
@@ -52,6 +52,7 @@
 	
 	//columns specific to accounts
 	public static final int COLUMN_CURRENCY_CODE = 4;
+	public static final int COLUMN_PARENT_ACCOUNT_UID = 5;
 	
 	/**
 	 * {@link DatabaseHelper} for creating and opening the database
diff --git a/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java b/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
index ee2c5780..6e6138d6 100644
--- a/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
+++ b/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
@@ -96,6 +96,11 @@
 	public static final String KEY_ACCOUNT_UID 	= "account_uid";
 	
 	/**
+	 * UID of the parent account
+	 */
+	public static final String KEY_PARENT_ACCOUNT_UID = "parent_account_uid";
+	
+	/**
 	 * Account which the origin account this transaction in double entry mode
 	 */
 	public static final String KEY_DOUBLE_ENTRY_ACCOUNT_UID 	= "double_account_uid";
@@ -128,8 +133,9 @@
 			+ KEY_ROW_ID + " integer primary key autoincrement, "
 			+ KEY_UID 	+ " varchar(255) not null, "
 			+ KEY_NAME 	+ " varchar(255) not null, "
-			+ KEY_TYPE 	+ " varchar(255), "
+			+ KEY_TYPE 	+ " varchar(255), "			
 			+ KEY_CURRENCY_CODE + " varchar(255) not null, "
+			+ KEY_PARENT_ACCOUNT_UID + " varchar(255), "
 			+ "UNIQUE (" + KEY_UID + ")"	
 			+ ");";
 	
@@ -180,7 +186,12 @@ public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
 				Log.i(TAG, "Adding column for splitting transactions");
 				String addColumnSql = "ALTER TABLE " + TRANSACTIONS_TABLE_NAME + 
 									" ADD COLUMN " + KEY_DOUBLE_ENTRY_ACCOUNT_UID + " varchar(255)";
+				
+				String addParentAccountSql = "ALTER TABLE " + ACCOUNTS_TABLE_NAME + 
+						" ADD COLUMN " + KEY_PARENT_ACCOUNT_UID + " varchar(255)";
+	
 				db.execSQL(addColumnSql);
+				db.execSQL(addParentAccountSql);
 			}
 			
 		} else {
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
index 992319ae..37377c5c 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
@@ -159,7 +159,7 @@ public void onNewAccountClick(View v) {
 		AccountsListFragment accountFragment = (AccountsListFragment) getSupportFragmentManager()
 				.findFragmentByTag(FRAGMENT_ACCOUNTS_LIST);
 		if (accountFragment != null)
-			accountFragment.showAddAccountDialog(0);
+			accountFragment.showAddAccountFragment(0);
 	}
 
 	/**
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
index d3158261..95236efa 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
@@ -76,11 +76,6 @@
  */
 public class AccountsListFragment extends SherlockListFragment implements
 		LoaderCallbacks<Cursor>, OnItemLongClickListener {
-
-	/**
-	 * Request code passed when displaying the "Add Account" dialog. 
-	 */
-	private static final int DIALOG_ADD_ACCOUNT = 0x10;
 	
 	/**
 	 * Logging tag
@@ -95,7 +90,7 @@
 	/**
 	 * Dialog fragment for adding new accounts
 	 */
-	NewAccountDialogFragment mAddAccountFragment;
+	AddAccountFragment mAddAccountFragment;
 	
 	/**
 	 * Database adapter for loading Account records from the database
@@ -154,8 +149,9 @@ public boolean onPrepareActionMode(ActionMode mode, Menu menu) {
 		@Override
 		public boolean onActionItemClicked(ActionMode mode, MenuItem item) {
 			switch (item.getItemId()) {
-			case R.id.context_menu_edit_accounts:
-				showAddAccountDialog(mSelectedItemId);
+			case R.id.context_menu_edit_accounts:				
+				showAddAccountFragment(mSelectedItemId);
+				mode.finish();
 				return true;
 
 			case R.id.context_menu_delete:
@@ -285,18 +281,19 @@ public void onListItemClick(ListView l, View v, int position, long id) {
 	
 	@Override
 	public boolean onItemLongClick(AdapterView<?> parent, View view, int position,
-				long id) {
-			if (mActionMode != null) {
-	            return false;
-	        }		
-			mInEditMode = true;
-			mSelectedItemId = id;
-	        // Start the CAB using the ActionMode.Callback defined above
-	        mActionMode = getSherlockActivity().startActionMode(mActionModeCallbacks);
-	             
-	        selectItem(position);
-	        return true;
+			long id) {
+		if (mActionMode != null) {
+			return false;
 		}
+		mInEditMode = true;
+		mSelectedItemId = id;
+		// Start the CAB using the ActionMode.Callback defined above
+		mActionMode = getSherlockActivity().startActionMode(
+				mActionModeCallbacks);
+
+		selectItem(position);
+		return true;
+	}
 
 	/**
 	 * Delete the account with record ID <code>rowId</code>
@@ -392,7 +389,7 @@ public boolean onOptionsItemSelected(MenuItem item) {
 		switch (item.getItemId()) {
 
 		case R.id.menu_add_account:
-			showAddAccountDialog(0);
+			showAddAccountFragment(0);
 			return true;
 
 		case R.id.menu_export:
@@ -441,34 +438,24 @@ public void onDestroy() {
 		mAccountsDbAdapter.close();
 		mAccountsCursorAdapter.close();
 	}	
-	
-	/**
-	 * Show dialog for creating a new {@link Account}
-	 */
-	public void showAddAccountDialog(long accountId) {
-		FragmentManager manager = getSherlockActivity().getSupportFragmentManager();
-		FragmentTransaction ft = manager.beginTransaction();
-		Fragment prev = manager.findFragmentByTag(AccountsActivity.FRAGMENT_NEW_ACCOUNT);
-		
-		if (prev != null) {
-			ft.remove(prev);
-		}
-
-		ft.addToBackStack(null);
 
-		mAddAccountFragment = NewAccountDialogFragment.newInstance(mAccountsDbAdapter);
+	public void showAddAccountFragment(long accountId) {
+		FragmentManager fragmentManager = getSherlockActivity().getSupportFragmentManager();
+		FragmentTransaction fragmentTransaction = fragmentManager
+				.beginTransaction();
+						
 		Bundle args = new Bundle();
 		args.putLong(TransactionsListFragment.SELECTED_ACCOUNT_ID, accountId);
-		mAddAccountFragment.setArguments(args);
+		AddAccountFragment newAccountFragment = AddAccountFragment.newInstance(mAccountsDbAdapter);	
+		newAccountFragment.setArguments(args);
 		
-		mAddAccountFragment.setTargetFragment(this, DIALOG_ADD_ACCOUNT);
-		if (mActionMode != null){
-			//if we were editing, stop before going somewhere else
-			mActionMode.finish(); 
-		}
-		mAddAccountFragment.show(ft, AccountsActivity.FRAGMENT_NEW_ACCOUNT);
+		fragmentTransaction.replace(R.id.fragment_container,
+				newAccountFragment, AccountsActivity.FRAGMENT_NEW_ACCOUNT);
+		
+		fragmentTransaction.addToBackStack(null);
+		fragmentTransaction.commit();
 	}
-
+	
 	/**
 	 * Displays the dialog for exporting transactions in OFX
 	 */
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AddAccountFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AddAccountFragment.java
new file mode 100644
index 00000000..8dc0908e
--- /dev/null
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AddAccountFragment.java
@@ -0,0 +1,277 @@
+/*
+ * Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.gnucash.android.ui.accounts;
+
+import java.util.Arrays;
+import java.util.Currency;
+import java.util.List;
+
+import org.gnucash.android.R;
+import org.gnucash.android.data.Account;
+import org.gnucash.android.data.Money;
+import org.gnucash.android.db.AccountsDbAdapter;
+import org.gnucash.android.db.DatabaseHelper;
+import org.gnucash.android.ui.transactions.TransactionsListFragment;
+import org.gnucash.android.ui.widget.WidgetConfigurationActivity;
+
+import android.content.Context;
+import android.database.Cursor;
+import android.os.Bundle;
+import android.support.v4.widget.SimpleCursorAdapter;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.view.inputmethod.InputMethodManager;
+import android.widget.ArrayAdapter;
+import android.widget.CheckBox;
+import android.widget.CompoundButton;
+import android.widget.CompoundButton.OnCheckedChangeListener;
+import android.widget.EditText;
+import android.widget.Spinner;
+import android.widget.Toast;
+
+import com.actionbarsherlock.app.SherlockFragment;
+import com.actionbarsherlock.view.Menu;
+import com.actionbarsherlock.view.MenuInflater;
+import com.actionbarsherlock.view.MenuItem;
+
+/**
+ * Fragment used for creating and editing accounts
+ * @author Ngewi Fet <ngewif@gmail.com>
+ */
+public class AddAccountFragment extends SherlockFragment {
+
+	/**
+	 * EditText for the name of the account to be created/edited
+	 */
+	private EditText mNameEditText;
+	
+	/**
+	 * Spinner for selecting the currency of the account
+	 * Currencies listed are those specified by ISO 4217
+	 */
+	private Spinner mCurrencySpinner;
+	
+	/**
+	 * Accounts database adapter
+	 */
+	private AccountsDbAdapter mAccountsDbAdapter;
+	
+	/**
+	 * List of all currency codes (ISO 4217) supported by the app
+	 */
+	private List<String> mCurrencyCodes;
+	
+	/**
+	 * Record ID of the account which was selected
+	 * This is used if we are editing an account instead of creating one
+	 */
+	private long mSelectedAccountId = 0;
+	
+	/**
+	 * Reference to account object which will be created at end of dialog
+	 */
+	private Account mAccount = null;
+
+	private Cursor mCursor;
+	
+	private SimpleCursorAdapter mCursorAdapter;
+	
+	private Spinner mParentAccountSpinner;
+
+	private CheckBox mParentCheckBox;
+	
+	/**
+	 * Default constructor
+	 * Required, else the app crashes on screen rotation
+	 */
+	public AddAccountFragment() {
+		//nothing to see here, move along
+	}
+	
+	/**
+	 * Construct a new instance of the dialog
+	 * @param dbAdapter {@link AccountsDbAdapter} for saving the account
+	 * @return New instance of the dialog fragment
+	 */
+	static public AddAccountFragment newInstance(AccountsDbAdapter dbAdapter){
+		AddAccountFragment f = new AddAccountFragment();
+		f.mAccountsDbAdapter = dbAdapter;
+		return f;
+	}
+	
+	@Override
+	public void onCreate(Bundle savedInstanceState) {
+		super.onCreate(savedInstanceState);
+		setHasOptionsMenu(true);		
+	}
+	
+	/**
+	 * Inflates the dialog view and retrieves references to the dialog elements
+	 */
+	@Override
+	public View onCreateView(LayoutInflater inflater, ViewGroup container,
+			Bundle savedInstanceState) {
+		View view = inflater.inflate(R.layout.fragment_new_account, container, false);
+		getSherlockActivity().getSupportActionBar().setTitle(R.string.title_add_account);
+		mCurrencySpinner = (Spinner) view.findViewById(R.id.input_currency_spinner);
+		mNameEditText = (EditText) view.findViewById(R.id.edit_text_account_name);
+		mNameEditText.requestFocus();
+        
+		mParentAccountSpinner = (Spinner) view.findViewById(R.id.input_parent_account);
+		mParentAccountSpinner.setEnabled(false);
+		
+		mParentCheckBox = (CheckBox) view.findViewById(R.id.checkbox);
+		mParentCheckBox.setOnCheckedChangeListener(new OnCheckedChangeListener() {
+			
+			@Override
+			public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
+				mParentAccountSpinner.setEnabled(isChecked);
+			}
+		});
+
+		mSelectedAccountId = getArguments().getLong(TransactionsListFragment.SELECTED_ACCOUNT_ID);
+		if (mSelectedAccountId > 0) {
+        	mAccount = mAccountsDbAdapter.getAccount(mSelectedAccountId);
+        	mNameEditText.setText(mAccount.getName());
+        	getSherlockActivity().getSupportActionBar().setTitle(R.string.title_edit_account);
+        }
+		return view;
+	}
+	
+	/**
+	 * Initializes the values of the views in the dialog
+	 */
+	@Override
+	public void onActivityCreated(Bundle savedInstanceState) {
+		super.onActivityCreated(savedInstanceState);
+		
+		ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(getActivity(), android.R.layout.simple_spinner_item, getResources().getStringArray(R.array.currency_names));
+		
+		arrayAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
+		mCurrencySpinner.setAdapter(arrayAdapter);
+		
+		String currencyCode = Money.DEFAULT_CURRENCY_CODE;
+		
+		if (mSelectedAccountId != 0){
+			//if we are editing an account instead of creating one
+			currencyCode = mAccount.getCurrency().getCurrencyCode();
+		}
+		mCurrencyCodes = Arrays.asList(getResources().getStringArray(R.array.currency_codes));
+		
+		if (mCurrencyCodes.contains(currencyCode)){
+			mCurrencySpinner.setSelection(mCurrencyCodes.indexOf(currencyCode));
+		}	
+		
+		loadParentAccountList();
+	}
+	
+	@Override
+	public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {		
+		super.onCreateOptionsMenu(menu, inflater);
+		inflater.inflate(R.menu.default_save_actions, menu);
+	}
+	
+	@Override
+	public boolean onOptionsItemSelected(MenuItem item) {
+		switch (item.getItemId()) {
+		case R.id.menu_save:
+			saveAccount();
+			return true;
+
+		case R.id.menu_cancel:
+			finish();
+			return true;
+		}
+		
+		return false;
+	}
+	
+	private void loadParentAccountList(){
+		mCursor = mAccountsDbAdapter.fetchAllAccounts();
+		
+		String[] from = new String[] {DatabaseHelper.KEY_NAME};
+		int[] to = new int[] {android.R.id.text1};
+		mCursorAdapter = new SimpleCursorAdapter(
+				getActivity(), 
+				android.R.layout.simple_spinner_item, 
+				mCursor, from, to, 0);
+		mCursorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);		
+		mParentAccountSpinner.setAdapter(mCursorAdapter);
+	}
+	
+	/**
+	 * Finishes the fragment appropriately.
+	 * Depends on how the fragment was loaded, it might have a backstack or not
+	 */
+	private void finish() {
+		InputMethodManager imm = (InputMethodManager) getSherlockActivity().getSystemService(
+			      Context.INPUT_METHOD_SERVICE);
+			imm.hideSoftInputFromWindow(mNameEditText.getWindowToken(), 0);
+			
+		getSherlockActivity().getSupportFragmentManager().popBackStack();			
+	}
+	
+	@Override
+	public void onDestroy() {
+		super.onDestroyView();
+		if (mCursor != null)
+			mCursor.close();
+		//do not close the database adapter. We got it from the activity, 
+		//the activity will take care of it.
+	}
+	
+	private void saveAccount() {
+		if (mAccount == null){
+			String name = getEnteredName();
+			if (name == null || name.length() == 0){
+				Toast.makeText(getSherlockActivity(), 
+						R.string.toast_no_account_name_entered, 
+						Toast.LENGTH_LONG).show();
+				return;				
+			}
+			mAccount = new Account(getEnteredName());
+		}
+		else
+			mAccount.setName(getEnteredName());
+			
+		String curCode = mCurrencyCodes.get(mCurrencySpinner
+				.getSelectedItemPosition());
+		mAccount.setCurrency(Currency.getInstance(curCode));
+
+		if (mAccountsDbAdapter == null)
+			mAccountsDbAdapter = new AccountsDbAdapter(getActivity());
+		mAccountsDbAdapter.addAccount(mAccount);
+
+		if (mParentCheckBox.isChecked()){
+			long id = mParentAccountSpinner.getSelectedItemId();
+			mAccount.setParentUID(mAccountsDbAdapter.getAccountUID(id));
+		}
+		WidgetConfigurationActivity.updateAllWidgets(getActivity()
+				.getApplicationContext());
+		finish();
+	}
+	
+	/**
+	 * Retrieves the name of the account which has been entered in the EditText
+	 * @return
+	 */
+	public String getEnteredName(){
+		return mNameEditText.getText().toString().trim();
+	}
+
+}
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/NewAccountDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/NewAccountDialogFragment.java
deleted file mode 100644
index da1ebd57..00000000
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/NewAccountDialogFragment.java
+++ /dev/null
@@ -1,243 +0,0 @@
-/*
- * Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.gnucash.android.ui.accounts;
-
-import java.util.Arrays;
-import java.util.Currency;
-import java.util.List;
-
-import org.gnucash.android.R;
-import org.gnucash.android.data.Account;
-import org.gnucash.android.data.Money;
-import org.gnucash.android.db.AccountsDbAdapter;
-import org.gnucash.android.ui.transactions.TransactionsListFragment;
-import org.gnucash.android.ui.widget.WidgetConfigurationActivity;
-
-import android.os.Bundle;
-import android.text.Editable;
-import android.text.TextWatcher;
-import android.view.LayoutInflater;
-import android.view.View;
-import android.view.ViewGroup;
-import android.view.WindowManager.LayoutParams;
-import android.widget.ArrayAdapter;
-import android.widget.Button;
-import android.widget.EditText;
-import android.widget.Spinner;
-
-import com.actionbarsherlock.app.SherlockDialogFragment;
-
-/**
- * Dialog fragment used for creating and editing accounts
- * @author Ngewi Fet <ngewif@gmail.com>
- */
-public class NewAccountDialogFragment extends SherlockDialogFragment {
-	/**
-	 * Really? You want documentation for this too?
-	 */
-	private Button mSaveButton;
-	
-	/**
-	 * Come on! It's a button, what else should I say?
-	 */
-	private Button mCancelButton;
-	
-	/**
-	 * EditText for the name of the account to be created/edited
-	 */
-	private EditText mNameEditText;
-	
-	/**
-	 * Spinner for selecting the currency of the account
-	 * Currencies listed are those specified by ISO 4217
-	 */
-	private Spinner mCurrencySpinner;
-	
-	/**
-	 * Accounts database adapter
-	 */
-	private AccountsDbAdapter mDbAdapter;
-	
-	/**
-	 * List of all currency codes (ISO 4217) supported by the app
-	 */
-	private List<String> mCurrencyCodes;
-	
-	/**
-	 * Record ID of the account which was selected
-	 * This is used if we are editing an account instead of creating one
-	 */
-	private long mSelectedAccountId = 0;
-	
-	/**
-	 * Reference to account object which will be created at end of dialog
-	 */
-	private Account mAccount = null;
-	
-	/**
-	 * Default constructor
-	 * Required, else the app crashes on screen rotation
-	 */
-	public NewAccountDialogFragment() {
-		//nothing to see here, move along
-	}
-	
-	/**
-	 * Construct a new instance of the dialog
-	 * @param dbAdapter {@link AccountsDbAdapter} for saving the account
-	 * @return New instance of the dialog fragment
-	 */
-	static public NewAccountDialogFragment newInstance(AccountsDbAdapter dbAdapter){
-		NewAccountDialogFragment f = new NewAccountDialogFragment();
-		f.mDbAdapter = dbAdapter;
-		return f;
-	}
-	
-	@Override
-	public void onCreate(Bundle savedInstanceState) {
-		super.onCreate(savedInstanceState);
-		mSelectedAccountId = getArguments().getLong(TransactionsListFragment.SELECTED_ACCOUNT_ID);				
-	}
-	
-	/**
-	 * Inflates the dialog view and retrieves references to the dialog elements
-	 */
-	@Override
-	public View onCreateView(LayoutInflater inflater, ViewGroup container,
-			Bundle savedInstanceState) {
-		View v = inflater.inflate(R.layout.dialog_new_account, container, false);
-		getDialog().setTitle(R.string.title_add_account);	
-		setStyle(STYLE_NORMAL, R.style.Sherlock___Theme_Dialog);
-		mSaveButton = (Button) v.findViewById(R.id.btn_save);
-		mCancelButton = (Button) v.findViewById(R.id.btn_cancel);
-		mCurrencySpinner = (Spinner) v.findViewById(R.id.input_currency_spinner);
-		mNameEditText = (EditText) v.findViewById(R.id.edit_text_account_name);
-		mNameEditText.requestFocus();
-        getDialog().getWindow().setSoftInputMode(
-                LayoutParams.SOFT_INPUT_STATE_VISIBLE);
-        
-        mNameEditText.addTextChangedListener(new NameFieldWatcher());
-		       
-        if (mSelectedAccountId != 0) {
-        	mAccount = mDbAdapter.getAccount(mSelectedAccountId);
-        	mNameEditText.setText(mAccount.getName());  
-        	getDialog().setTitle(R.string.title_edit_account);	
-        }
-		
-		mSaveButton.setOnClickListener(new View.OnClickListener() {
-			
-
-			@Override
-			public void onClick(View v) {
-				if (mAccount == null)
-					mAccount = new Account(getEnteredName());
-				else
-					mAccount.setName(getEnteredName());
-								
-				String curCode = mCurrencyCodes.get(mCurrencySpinner.getSelectedItemPosition());
-				mAccount.setCurrency(Currency.getInstance(curCode));
-				
-				if (mDbAdapter == null)
-					mDbAdapter = new AccountsDbAdapter(getActivity());
-				mDbAdapter.addAccount(mAccount);
-				
-				((AccountsListFragment)getTargetFragment()).refreshList();
-				
-				WidgetConfigurationActivity.updateAllWidgets(getActivity().getApplicationContext());
-				dismiss();				
-			}
-		});
-		
-		mCancelButton.setOnClickListener(new View.OnClickListener() {
-			
-			@Override
-			public void onClick(View v) {
-				NewAccountDialogFragment.this.dismiss();			
-			}
-		});
-		return v;
-	}
-	
-	/**
-	 * Initializes the values of the views in the dialog
-	 */
-	@Override
-	public void onActivityCreated(Bundle savedInstanceState) {
-		super.onActivityCreated(savedInstanceState);
-		
-		ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(getActivity(), android.R.layout.simple_spinner_item, getResources().getStringArray(R.array.currency_names));
-		
-		arrayAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
-		mCurrencySpinner.setAdapter(arrayAdapter);
-		
-		String currencyCode = Money.DEFAULT_CURRENCY_CODE;
-		
-		if (mSelectedAccountId != 0){
-			//if we are editing an account instead of creating one
-			currencyCode = mAccount.getCurrency().getCurrencyCode();
-		}
-		mCurrencyCodes = Arrays.asList(getResources().getStringArray(R.array.currency_codes));
-		
-		if (mCurrencyCodes.contains(currencyCode)){
-			mCurrencySpinner.setSelection(mCurrencyCodes.indexOf(currencyCode));
-		}		
-	}
-	
-	/**
-	 * Retrieves the name of the account which has been entered in the EditText
-	 * @return
-	 */
-	public String getEnteredName(){
-		return mNameEditText.getText().toString();
-	}
-	
-	/**
-	 * Validation text field watcher which enables the save button only when an account
-	 * name has been provided
-	 * @author Ngewi Fet <ngewif@gmail.com>
-	 *
-	 */
-	private class NameFieldWatcher implements TextWatcher {
-
-		/**
-		 * Enable text if an account name has been entered, disable it otherwise
-		 */
-		@Override
-		public void afterTextChanged(Editable s) {
-			if (s.length() > 0)
-				NewAccountDialogFragment.this.mSaveButton.setEnabled(true);
-			else
-				NewAccountDialogFragment.this.mSaveButton.setEnabled(false);
-		}
-
-		@Override
-		public void beforeTextChanged(CharSequence s, int start, int count,
-				int after) {
-			//nothing to see here, move along
-			
-		}
-
-		@Override
-		public void onTextChanged(CharSequence s, int start, int before,
-				int count) {
-			// nothing to see here, move along
-			
-		}
-		
-	}
-
-}
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
index 29e2b121..17aad77e 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
@@ -474,7 +474,7 @@ public void onDestroyView() {
 	
 	@Override
 	public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
-		inflater.inflate(R.menu.new_transaction_actions, menu);
+		inflater.inflate(R.menu.default_save_actions, menu);
 		mSaveMenuItem = menu.findItem(R.id.menu_save);
 		//only initially enable if we are editing a transaction
 		mSaveMenuItem.setEnabled(mTransactionId > 0);

From 073943e8f213bf2c718721683c0b55fa28f6b0bd Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 19 Dec 2012 01:24:17 +0100
Subject: [PATCH 06/27] Fixed: saving and editing of parent accounts Improved:
 Hide the accounts sum bar due to inaccurate summaries. May re-enable in the
 future Changed default accounts to match Gnucash desktop (Assets, Income,
 Expenses, Liabilities, Equity)

---
 .../res/layout/fragment_accounts_list.xml          |  3 +-
 GnucashMobile/res/values-de/strings.xml            |  4 +-
 GnucashMobile/res/values-el/strings.xml            |  4 +-
 GnucashMobile/res/values-es-rMX/strings.xml        |  4 +-
 GnucashMobile/res/values-es/strings.xml            |  4 +-
 GnucashMobile/res/values-fr/strings.xml            |  4 +-
 GnucashMobile/res/values-hu/strings.xml            |  4 +-
 GnucashMobile/res/values-it/strings.xml            |  4 +-
 GnucashMobile/res/values-nb/strings.xml            |  4 +-
 GnucashMobile/res/values-nl/strings.xml            |  4 +-
 GnucashMobile/res/values-pt-rBR/strings.xml        |  4 +-
 GnucashMobile/res/values-ru/strings.xml            |  4 +-
 GnucashMobile/res/values/strings.xml               |  4 +-
 .../android/ui/accounts/AddAccountFragment.java    | 46 +++++++++++++++++-----
 14 files changed, 62 insertions(+), 35 deletions(-)

diff --git a/GnucashMobile/res/layout/fragment_accounts_list.xml b/GnucashMobile/res/layout/fragment_accounts_list.xml
index d83ad0fa..6fe184ec 100644
--- a/GnucashMobile/res/layout/fragment_accounts_list.xml
+++ b/GnucashMobile/res/layout/fragment_accounts_list.xml
@@ -21,7 +21,8 @@
     android:orientation="vertical" >
 
     <include layout="@layout/transactions_sum_bar" 
-        android:id="@+id/transactions_sum_bar" />
+        android:id="@+id/transactions_sum_bar" 
+        android:visibility="gone" />
     
     <ListView android:id="@id/android:list"        
         android:layout_width="match_parent"
diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index 8652e92f..fdc513a9 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -263,8 +263,8 @@
 	    <item>Ausgaben</item>
 	    <item>Einkommen</item>
 	    <item>Aktiva</item>	    
-	    <item>Unterhaltung</item>
-	    <item>Versicherung</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">Keine Konten vorhanden.\nSie m&#252;ssen einen Konto erstellen um Widgets zu anzuf&#252;gen</string>
 	<string name="title_build_version">Version</string>
diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index f2665d7b..f5e3341a 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -264,8 +264,8 @@
 	    <item></item>
 	    <item></item>
 	    <item></item>	    
-	    <item></item>
-	    <item></item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">   
 	GnuCash.\n      widget</string>
diff --git a/GnucashMobile/res/values-es-rMX/strings.xml b/GnucashMobile/res/values-es-rMX/strings.xml
index e9a62867..6b3f27c9 100644
--- a/GnucashMobile/res/values-es-rMX/strings.xml
+++ b/GnucashMobile/res/values-es-rMX/strings.xml
@@ -263,8 +263,8 @@
 	    <item>Gastos</item>
 	    <item>Ingresos</item>
 	    <item>Bienes</item>
-	    <item>Entretenimiento</item>
-	    <item>Seguro</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">No hay cuentas en Gnucash.\nCree una cuenta antes de agregar un widget</string>
 	<string name="title_build_version">Versi&#243;n de compilaci&#243;n</string>
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 33634566..22612c74 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -264,8 +264,8 @@
 	    <item>Gastos</item>
 	    <item>Ingresos</item>
 	    <item>Activos</item>	    
-	    <item>Entretenimiento</item>
-	    <item>Seguros</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">No hay cuentas en Gnucash.\nCrea una cuenta antes de a&#241;adir un widget</string>
 	<string name="title_build_version">Versi&#243;n de compilaci&#243;n</string>
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index c5392cf1..f5fc18f4 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -264,8 +264,8 @@
 	    <item>D&#233;pense</item>
 	    <item>Revenu</item>
 	    <item>Actif</item>	    
-	    <item>Divertissement</item>
-	    <item>Assurance</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">Aucun compte &#233;xistant dans Gnucash.\nCr&#233;er un compte avant d\'ajouter un widget</string>
 	<string name="title_build_version">Version logiciel</string>
diff --git a/GnucashMobile/res/values-hu/strings.xml b/GnucashMobile/res/values-hu/strings.xml
index 06577161..c0bd0210 100644
--- a/GnucashMobile/res/values-hu/strings.xml
+++ b/GnucashMobile/res/values-hu/strings.xml
@@ -263,8 +263,8 @@
 	    <item>Expenses</item>
 	    <item>Income</item>
 	    <item>Assets</item>	    
-	    <item>Entertainment</item>
-	    <item>Insurance</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">No accounts exist in GnuCash.\nCreate an account before adding a widget</string>
 	<string name="title_build_version">Build version</string>
diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index d8e0b5fb..00c3b7de 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -264,8 +264,8 @@
 	    <item>Uscite</item>
 	    <item>Entrate</item>
 	    <item>Capitali</item>	    
-	    <item>Intrattenimento</item>
-	    <item>Assicurazione</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">Non esiste alcun conto in Gnucash.\nCreare un conto prima di aggiungere il widget</string>
 	<string name="title_build_version">Versione build</string>
diff --git a/GnucashMobile/res/values-nb/strings.xml b/GnucashMobile/res/values-nb/strings.xml
index 3705be2b..1857a6eb 100644
--- a/GnucashMobile/res/values-nb/strings.xml
+++ b/GnucashMobile/res/values-nb/strings.xml
@@ -265,8 +265,8 @@
 	    <item>Utgifter</item>
 	    <item>Inntekter</item>
 	    <item>Eiendeler</item>	    
-	    <item>Underholdning</item>
-	    <item>Forsikringer</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">Ingen kontoer finnes i Gnucash.\nOpprett en konto fr du legger til en widget</string>
 	<string name="title_build_version">Byggversion</string>
diff --git a/GnucashMobile/res/values-nl/strings.xml b/GnucashMobile/res/values-nl/strings.xml
index ed78dc2f..704c1176 100644
--- a/GnucashMobile/res/values-nl/strings.xml
+++ b/GnucashMobile/res/values-nl/strings.xml
@@ -264,8 +264,8 @@
 	    <item>Uitgaven</item>
 	    <item>Inkomsten</item>
 	    <item>Activa</item>	    
-	    <item>Ontspanning</item>
-	    <item>Verzekering</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">Geen dagboeken beschikbaar.\nU moet een dagboek aanmaken alvorens een widget toe te voegen</string>
 	<string name="title_build_version">Versie</string>
diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index dffeaf7c..0823abed 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -263,8 +263,8 @@
     <item>Despesas</item>
     <item>Receitas</item>
     <item>Ativos</item>
-    <item>Diverso</item>
-    <item>Seguros</item>
+    <item>Equity</item>
+	<item>Liabilities</item>
   </string-array>
   <string name="error_no_accounts">No existem contas no GnuCash.\nCriar uma conta antes de adicionar um widget</string>
   <string name="title_build_version">Verso de compilao</string>
diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index c2f37ca8..78796349 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -264,8 +264,8 @@
 	    <item></item>
 	    <item></item>
 	    <item></item>	    
-	    <item></item>
-	    <item></item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">   Gnucash.\n  ,    .</string>
 	<string name="title_build_version"> </string>
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 93ce2395..5903f10c 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -443,8 +443,8 @@
 	    <item>Expenses</item>
 	    <item>Income</item>
 	    <item>Assets</item>	    
-	    <item>Entertainment</item>
-	    <item>Insurance</item>
+	    <item>Equity</item>
+	    <item>Liabilities</item>
 	</string-array>
 	<string name="error_no_accounts">No accounts exist in GnuCash.\nCreate an account before adding a widget</string>
 	<string name="key_build_version">build_version</string>
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AddAccountFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AddAccountFragment.java
index 8dc0908e..bb9577a8 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AddAccountFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AddAccountFragment.java
@@ -147,12 +147,21 @@ public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
 		mSelectedAccountId = getArguments().getLong(TransactionsListFragment.SELECTED_ACCOUNT_ID);
 		if (mSelectedAccountId > 0) {
         	mAccount = mAccountsDbAdapter.getAccount(mSelectedAccountId);
-        	mNameEditText.setText(mAccount.getName());
         	getSherlockActivity().getSupportActionBar().setTitle(R.string.title_edit_account);
-        }
+		}
 		return view;
 	}
 	
+	private void setParentAccountSelection(String parentUID){
+		long parentId = mAccountsDbAdapter.getAccountID(parentUID);
+		for (int pos = 0; pos < mCursorAdapter.getCount(); pos++) {
+			if (mCursorAdapter.getItemId(pos) == parentId){
+				mParentAccountSpinner.setSelection(pos);				
+				break;
+			}
+		}
+	}
+	
 	/**
 	 * Initializes the values of the views in the dialog
 	 */
@@ -160,8 +169,10 @@ public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
 	public void onActivityCreated(Bundle savedInstanceState) {
 		super.onActivityCreated(savedInstanceState);
 		
-		ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(getActivity(), android.R.layout.simple_spinner_item, getResources().getStringArray(R.array.currency_names));
-		
+		ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(
+				getActivity(), 
+				android.R.layout.simple_spinner_item, 
+				getResources().getStringArray(R.array.currency_names));		
 		arrayAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
 		mCurrencySpinner.setAdapter(arrayAdapter);
 		
@@ -177,7 +188,18 @@ public void onActivityCreated(Bundle savedInstanceState) {
 			mCurrencySpinner.setSelection(mCurrencyCodes.indexOf(currencyCode));
 		}	
 		
-		loadParentAccountList();
+		loadParentAccountList();		
+
+		if (mSelectedAccountId > 0) {
+        	mNameEditText.setText(mAccount.getName());
+        	String parentUID = mAccount.getParentUID();
+        	if (parentUID != null){
+        		mParentCheckBox.setChecked(true);
+        		mParentAccountSpinner.setEnabled(true);
+        		setParentAccountSelection(parentUID);
+        	}        	
+        }
+		
 	}
 	
 	@Override
@@ -202,7 +224,8 @@ public boolean onOptionsItemSelected(MenuItem item) {
 	}
 	
 	private void loadParentAccountList(){
-		mCursor = mAccountsDbAdapter.fetchAllAccounts();
+		String condition = DatabaseHelper.KEY_ROW_ID + "!=" + mSelectedAccountId;
+		mCursor = mAccountsDbAdapter.fetchAccounts(condition);
 		
 		String[] from = new String[] {DatabaseHelper.KEY_NAME};
 		int[] to = new int[] {android.R.id.text1};
@@ -253,14 +276,17 @@ private void saveAccount() {
 				.getSelectedItemPosition());
 		mAccount.setCurrency(Currency.getInstance(curCode));
 
-		if (mAccountsDbAdapter == null)
-			mAccountsDbAdapter = new AccountsDbAdapter(getActivity());
-		mAccountsDbAdapter.addAccount(mAccount);
-
 		if (mParentCheckBox.isChecked()){
 			long id = mParentAccountSpinner.getSelectedItemId();
 			mAccount.setParentUID(mAccountsDbAdapter.getAccountUID(id));
+		} else {
+			mAccount.setParentUID(null);
 		}
+		
+		if (mAccountsDbAdapter == null)
+			mAccountsDbAdapter = new AccountsDbAdapter(getActivity());
+		mAccountsDbAdapter.addAccount(mAccount);
+		
 		WidgetConfigurationActivity.updateAllWidgets(getActivity()
 				.getApplicationContext());
 		finish();

From 111d1c2d5d8e57bf26c10972a44befbbd481e062 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 19 Dec 2012 23:06:58 +0100
Subject: [PATCH 07/27] Improved: specify encoding when exporting OFX Improved:
 Add option to use SGML OFX headers during export (issue #43) This helps
 GnuCash desktop to better detect encoding and import OFX files, especially
 for users of non-Latin characters Fixes #16, #28

---
 GnucashMobile/AndroidManifest.xml                  |  4 ++--
 GnucashMobile/res/values/strings.xml               |  3 +++
 .../res/xml/fragment_general_preferences.xml       |  1 +
 .../android/ui/accounts/ExportDialogFragment.java  | 23 ++++++++++++++++++++--
 .../src/org/gnucash/android/util/OfxFormatter.java |  5 +++++
 5 files changed, 32 insertions(+), 4 deletions(-)

diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index 739d4222..eba68ba4 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -17,8 +17,8 @@
 
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="org.gnucash.android"
-    android:versionCode="4"
-    android:versionName="1.0.3" >
+    android:versionCode="5"
+    android:versionName="1.0.4.beta1" >
 
     <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15"/>
     
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index cbe54793..7b630f03 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -487,4 +487,7 @@
 	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
+	<string name="key_sgml_ofx_header">sgml_ofx_header</string>
+	<string name="title_sgml_ofx_header">Use SGML for OFX header</string>
+	<string name="summary_sgml_ofx_header">Allows GnuCash desktop to correctly detect encoding of OFX file. Useful for non-Latin character sets.</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/xml/fragment_general_preferences.xml b/GnucashMobile/res/xml/fragment_general_preferences.xml
index ff63cf99..87821a6d 100644
--- a/GnucashMobile/res/xml/fragment_general_preferences.xml
+++ b/GnucashMobile/res/xml/fragment_general_preferences.xml
@@ -29,6 +29,7 @@
             android:inputType="textEmailAddress"/>
         <CheckBoxPreference android:summary="@string/hint_export_choice" android:key="@string/key_export_all_transactions" android:title="@string/title_export_all_transactions"/>
         <CheckBoxPreference android:summary="@string/hint_delete_after_export" android:key="@string/key_delete_transactions_after_export" android:title="@string/title_always_delete_exported_transactions"/>
+        <CheckBoxPreference android:title="@string/title_sgml_ofx_header" android:key="@string/key_sgml_ofx_header" android:summary="@string/summary_sgml_ofx_header"/>
         
     </PreferenceCategory>
     
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
index cfc10092..1ea29501 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
@@ -16,11 +16,14 @@
 
 package org.gnucash.android.ui.accounts;
 
+import java.io.BufferedWriter;
 import java.io.File;
 import java.io.FileInputStream;
 import java.io.FileOutputStream;
 import java.io.FileWriter;
 import java.io.IOException;
+import java.io.OutputStreamWriter;
+import java.io.StringWriter;
 import java.io.Writer;
 import java.nio.channels.FileChannel;
 import java.text.SimpleDateFormat;
@@ -222,9 +225,25 @@ public void onClick(View v) {
 	private void writeToExternalStorage(Document doc) throws IOException{
 		File file = new File(mFilePath);
 		
-		FileWriter writer = new FileWriter(file);
-		write(doc, writer);
+//		FileWriter writer = new FileWriter(file);
+		BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(file), "UTF-8"));
+		boolean useSgmlHeader = PreferenceManager.getDefaultSharedPreferences(getActivity())
+				.getBoolean(getString(R.string.key_sgml_ofx_header), false);
+
+		//if we want SGML OFX headers, write first to string and then prepend header
+		if (useSgmlHeader){		
+			StringWriter stringWriter = new StringWriter();
+			write(doc, stringWriter);
+			
+			StringBuffer stringBuffer = new StringBuffer(OfxFormatter.OFX_SGML_HEADER);
+			stringBuffer.append('\n');
+			writer.write(stringBuffer.toString());
+		} else {
+			write(doc, writer);
+		}
 		
+		writer.flush();
+		writer.close();
 	}
 	
 	/**
diff --git a/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java b/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
index 0babb022..d76c8432 100644
--- a/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
+++ b/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
@@ -76,6 +76,11 @@
 	public static final String OFX_HEADER = "OFXHEADER=\"200\" VERSION=\"211\" SECURITY=\"NONE\" OLDFILEUID=\"NONE\" NEWFILEUID=\"NONE\"";
 	
 	/**
+	 * SGML header for OFX. Used for compatibility with desktop GnuCash
+	 */
+	public static final String OFX_SGML_HEADER = "ENCODING:UTF-8 \nOFXHEADER:100 \nDATA:OFXSGML \nVERSION:211 \nSECURITY:NONE \nCHARSET:UTF-8 \nCOMPRESSION:NONE \nOLDFILEUID:NONE \nNEWFILEUID:NONE";
+	
+	/**
 	 * Builds an XML representation of the {@link Account}s and {@link Transaction}s in the database 
 	 * @param context Application context
 	 * @param exportAll Whether all transactions should be exported or only new ones since last export

From 610de366c6ef4d7c69b7fd34aa74ef7bbe5f948a Mon Sep 17 00:00:00 2001
From: choni <wani@dri-h.net>
Date: Thu, 20 Dec 2012 13:13:51 +0900
Subject: [PATCH 08/27] Modified SGML type OFX export file.

---
 .../android/ui/accounts/ExportDialogFragment.java      | 18 +++++++++++-------
 .../src/org/gnucash/android/util/OfxFormatter.java     |  2 +-
 2 files changed, 12 insertions(+), 8 deletions(-)

diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
index 1ea29501..b0289f0d 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
@@ -20,7 +20,6 @@
 import java.io.File;
 import java.io.FileInputStream;
 import java.io.FileOutputStream;
-import java.io.FileWriter;
 import java.io.IOException;
 import java.io.OutputStreamWriter;
 import java.io.StringWriter;
@@ -45,6 +44,7 @@
 import org.gnucash.android.util.OfxFormatter;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
+import org.w3c.dom.Node;
 import org.w3c.dom.ProcessingInstruction;
 
 import android.app.Activity;
@@ -231,15 +231,16 @@ private void writeToExternalStorage(Document doc) throws IOException{
 				.getBoolean(getString(R.string.key_sgml_ofx_header), false);
 
 		//if we want SGML OFX headers, write first to string and then prepend header
-		if (useSgmlHeader){		
+		if (useSgmlHeader){
+			Node ofxNode = doc.getElementsByTagName("OFX").item(0);
 			StringWriter stringWriter = new StringWriter();
-			write(doc, stringWriter);
+			write(ofxNode, stringWriter, true);
 			
 			StringBuffer stringBuffer = new StringBuffer(OfxFormatter.OFX_SGML_HEADER);
 			stringBuffer.append('\n');
-			writer.write(stringBuffer.toString());
+			writer.write(stringBuffer.toString() + stringWriter.toString());
 		} else {
-			write(doc, writer);
+			write(doc, writer, false);
 		}
 		
 		writer.flush();
@@ -346,16 +347,19 @@ protected Document exportOfx(boolean exportAll) throws ParserConfigurationExcept
 	 * @param document {@link Document} containing the OFX document structure
 	 * @param outputWriter {@link Writer} to use in writing the file to stream
 	 */
-	public void write(Document document, Writer outputWriter){
+	public void write(Node node, Writer outputWriter, boolean omitXmlDeclaration){
 		try {
 			TransformerFactory transformerFactory = TransformerFactory
 					.newInstance();
 			Transformer transformer = transformerFactory.newTransformer();
-			DOMSource source = new DOMSource(document);
+			DOMSource source = new DOMSource(node);
 			StreamResult result = new StreamResult(outputWriter);
 			
 			transformer.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "2");
 			transformer.setOutputProperty(OutputKeys.INDENT, "yes");
+			if (omitXmlDeclaration) {
+				transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
+			}
 			
 			transformer.transform(source, result);
 		} catch (TransformerConfigurationException txconfigException) {
diff --git a/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java b/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
index d76c8432..ac6bb7f7 100644
--- a/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
+++ b/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
@@ -78,7 +78,7 @@
 	/**
 	 * SGML header for OFX. Used for compatibility with desktop GnuCash
 	 */
-	public static final String OFX_SGML_HEADER = "ENCODING:UTF-8 \nOFXHEADER:100 \nDATA:OFXSGML \nVERSION:211 \nSECURITY:NONE \nCHARSET:UTF-8 \nCOMPRESSION:NONE \nOLDFILEUID:NONE \nNEWFILEUID:NONE";
+	public static final String OFX_SGML_HEADER = "ENCODING:UTF-8\nOFXHEADER:100\nDATA:OFXSGML\nVERSION:211\nSECURITY:NONE\nCHARSET:UTF-8\nCOMPRESSION:NONE\nOLDFILEUID:NONE\nNEWFILEUID:NONE";
 	
 	/**
 	 * Builds an XML representation of the {@link Account}s and {@link Transaction}s in the database 

From 293713566bd3e4efbddd58ae837f06dbfcb6f111 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 21 Dec 2012 00:35:10 +0100
Subject: [PATCH 09/27] Started support for double entry in OFX exports

---
 .../src/org/gnucash/android/data/Account.java      | 50 +++++++++++++++++++++-
 .../src/org/gnucash/android/data/Transaction.java  | 19 ++++++++
 .../android/ui/accounts/ExportDialogFragment.java  |  9 +++-
 3 files changed, 74 insertions(+), 4 deletions(-)

diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index 078ba0ca..938e7490 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -50,9 +50,11 @@
 	 * This are the different types specified by the OFX format and 
 	 * they are currently not used except for exporting
 	 */
-	public enum AccountType {CASH, BANK, CREDIT_CARD, ASSET, LIABILITY, INCOME, EXPENSE, EQUITY, CURRENCY, STOCK, MUTUAL_FUND,
-		CHECKING, SAVINGS, MONEYMRKT, CREDITLINE};
+	public enum AccountType {CASH, BANK, CREDIT_CARD, ASSET, LIABILITY, INCOME, EXPENSE, 
+		EQUITY, CURRENCY, STOCK, MUTUAL_FUND, CHECKING, SAVINGS, MONEYMRKT, CREDITLINE};
 	
+	public enum OfxAccountType {CHECKING, SAVINGS, MONEYMRKT, CREDITLINE };
+		
 	/**
 	 * Unique Identifier of the account
 	 * It is generated when the account is created and can be set a posteriori as well
@@ -278,14 +280,56 @@ public void setCurrency(Currency mCurrency) {
 		//transaction values to the corresponding value in the new currency
 	}
 
+	/**
+	 * Sets the Unique Account Identifier of the parent account
+	 * @param parentUID String Unique ID of parent account
+	 */
 	public void setParentUID(String parentUID){
 		mParentAccountUID = parentUID;
 	}
 	
+	/**
+	 * Returns the Unique Account Identifier of the parent account
+	 * @return String Unique ID of parent account
+	 */
 	public String getParentUID() {
 		return mParentAccountUID;
 		
 	}
+
+	/**
+	 * Maps the <code>accountType</code> to the corresponding account type.
+	 * <code>accountType</code> have corresponding values to GnuCash desktop
+	 * @param accountType {@link AccountType} of an account
+	 * @return Corresponding {@link OfxAccountType} for the <code>accountType</code>
+	 * @see AccountType
+	 * @see OfxAccountType
+	 */
+	public OfxAccountType ofxAccountTypeMapping(AccountType accountType){
+		switch (accountType) {
+		case CREDITLINE:
+			return OfxAccountType.CREDITLINE;
+			
+		case CASH:
+		case INCOME:
+		case EXPENSE:
+		case CURRENCY:
+			return OfxAccountType.CHECKING;
+			
+		case BANK:
+		case ASSET:
+			return OfxAccountType.SAVINGS;
+			
+		case MUTUAL_FUND:
+		case STOCK:
+		case EQUITY:
+			return OfxAccountType.MONEYMRKT;
+
+		default:
+			return OfxAccountType.CHECKING;
+		}
+	}
+	
 	/**
 	 * Converts this account's transactions into XML and adds them to the DOM document
 	 * @param doc XML DOM document for the OFX data
@@ -295,7 +339,9 @@ public void toOfx(Document doc, Element parent, boolean allTransactions){
 		for (Transaction transaction : mTransactionsList) {
 			if (!allTransactions && transaction.isExported())
 				continue;
+			
 			parent.appendChild(transaction.toOfx(doc));
 		}
 	}
+
 }
diff --git a/GnucashMobile/src/org/gnucash/android/data/Transaction.java b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
index d37f8548..9455bb11 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Transaction.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
@@ -22,6 +22,7 @@
 import java.util.Locale;
 import java.util.UUID;
 
+import org.gnucash.android.data.Account.OfxAccountType;
 import org.gnucash.android.util.OfxFormatter;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
@@ -393,6 +394,24 @@ public Element toOfx(Document doc){
 			transactionNode.appendChild(memo);
 		}
 		
+		if (mDoubleEntryAccountUID != null && mDoubleEntryAccountUID.length() > 0){
+			Element bankId = doc.createElement("BANKID");
+			bankId.appendChild(doc.createTextNode(OfxFormatter.APP_ID));
+			
+			Element acctId = doc.createElement("ACCTID");
+			acctId.appendChild(doc.createTextNode(mDoubleEntryAccountUID));
+			
+			Element accttype = doc.createElement("ACCTTYPE");
+			accttype.appendChild(doc.createTextNode(OfxAccountType.CHECKING.toString()));
+			
+			Element bankAccountTo = doc.createElement("BANKACCTTO");
+			bankAccountTo.appendChild(bankId);
+			bankAccountTo.appendChild(acctId);
+			bankAccountTo.appendChild(accttype);
+			
+			transactionNode.appendChild(bankAccountTo);
+		}
+		
 		return transactionNode;
 	}
 
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
index b0289f0d..b53e4539 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
@@ -106,6 +106,11 @@
 	String mFilePath;
 	
 	/**
+	 * Tag for logging
+	 */
+	private static final String TAG = "ExportDialogFragment";
+	
+	/**
 	 * Click listener for positive button in the dialog.
 	 * @author Ngewi Fet <ngewif@gmail.com>
 	 */
@@ -119,7 +124,7 @@ public void onClick(View v) {
 				document = exportOfx(exportAll);
 				writeToExternalStorage(document);
 			} catch (Exception e) {
-				Log.e(getTag(), e.getMessage());
+				Log.e(TAG, e.getMessage());
 				Toast.makeText(getActivity(), R.string.error_exporting,
 						Toast.LENGTH_LONG).show();
 				dismiss();
@@ -143,7 +148,7 @@ public void onClick(View v) {
 					Toast.makeText(getActivity(), 
 							getString(R.string.toast_error_exporting_ofx) + dst.getAbsolutePath(), 
 							Toast.LENGTH_LONG).show();		
-					Log.e(getTag(), e.getMessage());
+					Log.e(TAG, e.getMessage());
 					break;
 				}
 				

From 3ae8cb68a55c307744eedd8274bcb920dcf5d52c Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 21 Dec 2012 18:57:35 +0100
Subject: [PATCH 10/27] Moved double entry preference to transactions sub
 section

---
 GnucashMobile/res/values/strings.xml                       | 2 +-
 GnucashMobile/res/xml/fragment_general_preferences.xml     | 2 +-
 GnucashMobile/res/xml/fragment_transaction_preferences.xml | 1 +
 3 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 3359d5ee..1f2a77f8 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -487,7 +487,7 @@
 	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
-	<string name="label_double_entry_account">Transfer from</string>
+	<string name="label_double_entry_account">Transfer to</string>
 	<string name="key_use_double_entry">use_double_entry</string>
 	<string name="summary_use_double_entry">All transactions will involve two accounts: source and destination accounts</string>
 	<string name="title_use_double_entry">Activate Double Entry</string>
diff --git a/GnucashMobile/res/xml/fragment_general_preferences.xml b/GnucashMobile/res/xml/fragment_general_preferences.xml
index 452c6e7b..6dfc7854 100644
--- a/GnucashMobile/res/xml/fragment_general_preferences.xml
+++ b/GnucashMobile/res/xml/fragment_general_preferences.xml
@@ -21,7 +21,7 @@
         android:dialogTitle="@string/title_choose_currency" 
         android:title="@string/title_default_currency" 
         android:entries="@array/currency_names" 
-        android:entryValues="@array/currency_codes"/><CheckBoxPreference android:summary="@string/summary_use_double_entry" android:key="@string/key_use_double_entry" android:title="@string/title_use_double_entry"/>
+        android:entryValues="@array/currency_codes"/>
     <PreferenceCategory android:title="@string/title_export_preference_category">
         <EditTextPreference android:title="@string/title_default_export_email" 
             android:key="@string/key_default_export_email" 
diff --git a/GnucashMobile/res/xml/fragment_transaction_preferences.xml b/GnucashMobile/res/xml/fragment_transaction_preferences.xml
index 4c81f2a0..67d44711 100644
--- a/GnucashMobile/res/xml/fragment_transaction_preferences.xml
+++ b/GnucashMobile/res/xml/fragment_transaction_preferences.xml
@@ -16,4 +16,5 @@
 -->
 <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
     <ListPreference android:title="@string/title_default_transaction_type" android:entryValues="@array/key_transaction_type_values" android:entries="@array/transaction_types" android:key="@string/key_default_transaction_type" android:summary="@string/summary_default_transaction_type"/>
+    <CheckBoxPreference android:summary="@string/summary_use_double_entry" android:key="@string/key_use_double_entry" android:title="@string/title_use_double_entry"/>
 </PreferenceScreen>

From 6f61d35142daa9efc395ad7e03bb9e1e7c76cd3b Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 4 Jan 2013 14:17:46 +0100
Subject: [PATCH 11/27] Fixed: OFX exports now correctly includes double
 account information Fixed: Update transfer accounts in NewTransactionFragment
 when the main account is changed Removed currency condition for transfer
 accounts. Transferring to account with different currency is possible Account
 type is now required in the database Removed code displaying total account
 balances. Need to find a better way to display per currency balance (just as
 in GnuCash for desktop) Added a GnucashApplication class to provide static
 context Refactored OFX export code

---
 GnucashMobile/AndroidManifest.xml                  |  2 +-
 .../gnucash/android/app/GnuCashApplication.java    | 27 +++++++
 .../src/org/gnucash/android/data/Account.java      | 85 ++++++++++++++++++++--
 .../src/org/gnucash/android/data/Transaction.java  | 20 +++--
 .../org/gnucash/android/db/AccountsDbAdapter.java  | 28 +++++++
 .../src/org/gnucash/android/db/DatabaseHelper.java |  2 +-
 .../gnucash/android/db/TransactionsDbAdapter.java  |  5 +-
 .../android/ui/accounts/AccountsListFragment.java  |  6 +-
 .../android/ui/accounts/ExportDialogFragment.java  | 11 ++-
 .../ui/transactions/NewTransactionFragment.java    | 18 +++--
 .../src/org/gnucash/android/util/OfxFormatter.java | 65 +----------------
 11 files changed, 177 insertions(+), 92 deletions(-)
 create mode 100644 GnucashMobile/src/org/gnucash/android/app/GnuCashApplication.java

diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index eba68ba4..5386d5f6 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -43,7 +43,7 @@
     <uses-permission android:label="@string/permission_access_sdcard"
         android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
 	    
-    <application
+    <application android:name="org.gnucash.android.app.GnuCashApplication"
         android:icon="@drawable/ic_launcher"
         android:label="@string/app_name" 
         android:theme="@style/Theme.Sherlock.Light.DarkActionBar">
diff --git a/GnucashMobile/src/org/gnucash/android/app/GnuCashApplication.java b/GnucashMobile/src/org/gnucash/android/app/GnuCashApplication.java
new file mode 100644
index 00000000..38c6113d
--- /dev/null
+++ b/GnucashMobile/src/org/gnucash/android/app/GnuCashApplication.java
@@ -0,0 +1,27 @@
+package org.gnucash.android.app;
+
+import android.app.Application;
+import android.content.Context;
+
+/**
+ * An {@link Application} subclass for retrieving static context
+ * @author Ngewi Fet <ngewif@gmail.com>
+ *
+ */
+public class GnuCashApplication extends Application{
+
+    private static Context context;
+
+    public void onCreate(){
+        super.onCreate();
+        GnuCashApplication.context = getApplicationContext();
+    }
+
+    /**
+     * Returns the application context
+     * @return Application {@link Context} object
+     */
+    public static Context getAppContext() {
+        return GnuCashApplication.context;
+    }
+}
\ No newline at end of file
diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index 938e7490..56325058 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -23,6 +23,7 @@
 import java.util.Locale;
 import java.util.UUID;
 
+import org.gnucash.android.util.OfxFormatter;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
 
@@ -186,13 +187,20 @@ public void setAccountType(AccountType mAccountType) {
 
 	/**
 	 * Adds a transaction to this account
-	 * The currency of the transaction will be set to the currency of the account
+	 * <p>The currency of the transaction will be set to the currency of the account
 	 * if they are not the same. The currency value conversion is performed, just 
-	 * a different currecy is assigned to the same value amount in the transaction.
+	 * a different currency is assigned to the same value amount in the transaction.</p>
+	 * <p>
+	 * If the transaction has no account Unique ID, it will be set to the UID of this account.
+	 * Some transactions already have the account UID and double account UID set. In that case,
+	 * nothing is changed
+	 * </p>
 	 * @param transaction {@link Transaction} to be added to the account
 	 */
 	public void addTransaction(Transaction transaction){
-		transaction.setAccountUID(getUID());
+		//some double transactions may already an account UID. Set only for those with null
+		if (transaction.getAccountUID() == null)
+			transaction.setAccountUID(getUID());
 		transaction.setCurrency(mCurrency);
 		mTransactionsList.add(transaction);
 	}
@@ -206,7 +214,8 @@ public void addTransaction(Transaction transaction){
 	 */
 	public void setTransactions(List<Transaction> transactionsList){
 		for (Transaction transaction : transactionsList) {
-			transaction.setAccountUID(getUID());
+			if (transaction.getAccountUID() == null)
+				transaction.setAccountUID(getUID());
 			transaction.setCurrency(mCurrency);
 		}
 		this.mTransactionsList = transactionsList;
@@ -336,12 +345,76 @@ public OfxAccountType ofxAccountTypeMapping(AccountType accountType){
 	 * @param parent Parent node to which to add this account's transactions in XML
 	 */
 	public void toOfx(Document doc, Element parent, boolean allTransactions){
+		Element currency = doc.createElement("CURDEF");
+		currency.appendChild(doc.createTextNode(mCurrency.getCurrencyCode()));						
+		
+		//================= BEGIN BANK ACCOUNT INFO (BANKACCTFROM) =================================
+		
+		Element bankId = doc.createElement("BANKID");
+		bankId.appendChild(doc.createTextNode(OfxFormatter.APP_ID));
+		
+		Element acctId = doc.createElement("ACCTID");
+		acctId.appendChild(doc.createTextNode(mUID));
+		
+		Element accttype = doc.createElement("ACCTTYPE");
+		accttype.appendChild(doc.createTextNode(mAccountType.toString()));
+		
+		Element bankFrom = doc.createElement("BANKACCTFROM");
+		bankFrom.appendChild(bankId);
+		bankFrom.appendChild(acctId);
+		bankFrom.appendChild(accttype);
+		
+		//================= END BANK ACCOUNT INFO ============================================
+		
+		
+		//================= BEGIN ACCOUNT BALANCE INFO =================================
+		String balance = getBalance().toPlainString();
+		String formattedCurrentTimeString = OfxFormatter.getFormattedCurrentTime();
+		
+		Element balanceAmount = doc.createElement("BALAMT");
+		balanceAmount.appendChild(doc.createTextNode(balance));			
+		Element dtasof = doc.createElement("DTASOF");
+		dtasof.appendChild(doc.createTextNode(formattedCurrentTimeString));
+		
+		Element ledgerBalance = doc.createElement("LEDGERBAL");
+		ledgerBalance.appendChild(balanceAmount);
+		ledgerBalance.appendChild(dtasof);
+		
+		//================= END ACCOUNT BALANCE INFO =================================
+		
+		
+		//================= BEGIN TIME PERIOD INFO =================================
+		
+		Element dtstart = doc.createElement("DTSTART");			
+		dtstart.appendChild(doc.createTextNode(formattedCurrentTimeString));
+		
+		Element dtend = doc.createElement("DTEND");
+		dtend.appendChild(doc.createTextNode(formattedCurrentTimeString));
+		
+		//================= END TIME PERIOD INFO =================================
+		
+		
+		//================= BEGIN TRANSACTIONS LIST =================================
+		Element bankTransactionsList = doc.createElement("BANKTRANLIST");
+		bankTransactionsList.appendChild(dtstart);
+		bankTransactionsList.appendChild(dtend);
+		
 		for (Transaction transaction : mTransactionsList) {
 			if (!allTransactions && transaction.isExported())
 				continue;
 			
-			parent.appendChild(transaction.toOfx(doc));
-		}
+			bankTransactionsList.appendChild(transaction.toOfx(doc, mUID));
+		}		
+		//================= END TRANSACTIONS LIST =================================
+					
+		Element statementTransactions = doc.createElement("STMTRS");
+		statementTransactions.appendChild(currency);
+		statementTransactions.appendChild(bankFrom);
+		statementTransactions.appendChild(bankTransactionsList);
+		statementTransactions.appendChild(ledgerBalance);
+		
+		parent.appendChild(statementTransactions);
+				
 	}
 
 }
diff --git a/GnucashMobile/src/org/gnucash/android/data/Transaction.java b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
index 9455bb11..3ae7b31c 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Transaction.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
@@ -22,7 +22,8 @@
 import java.util.Locale;
 import java.util.UUID;
 
-import org.gnucash.android.data.Account.OfxAccountType;
+import org.gnucash.android.app.GnuCashApplication;
+import org.gnucash.android.db.AccountsDbAdapter;
 import org.gnucash.android.util.OfxFormatter;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
@@ -357,11 +358,13 @@ public void setAccountUID(String accountUID) {
 	
 	/**
 	 * Converts transaction to XML DOM corresponding to OFX Statement transaction and 
-	 * returns the element node for the transaction
+	 * returns the element node for the transaction.
+	 * The Unique ID of the account is needed in order to properly export double entry transactions
 	 * @param doc XML document to which transaction should be added
+	 * @param accountUID Unique Identifier of the account which called the method.
 	 * @return Element in DOM corresponding to transaction
 	 */
-	public Element toOfx(Document doc){		
+	public Element toOfx(Document doc, String accountUID){		
 		Element transactionNode = doc.createElement("STMTTRN");
 		Element type = doc.createElement("TRNTYPE");
 		type.appendChild(doc.createTextNode(mType.toString()));
@@ -398,11 +401,16 @@ public Element toOfx(Document doc){
 			Element bankId = doc.createElement("BANKID");
 			bankId.appendChild(doc.createTextNode(OfxFormatter.APP_ID));
 			
+			//select the proper account as the double account
+			String doubleAccountUID = mDoubleEntryAccountUID.equals(accountUID) ? mAccountUID : mDoubleEntryAccountUID;
+			
 			Element acctId = doc.createElement("ACCTID");
-			acctId.appendChild(doc.createTextNode(mDoubleEntryAccountUID));
+			acctId.appendChild(doc.createTextNode(doubleAccountUID));
 			
-			Element accttype = doc.createElement("ACCTTYPE");
-			accttype.appendChild(doc.createTextNode(OfxAccountType.CHECKING.toString()));
+			Element accttype = doc.createElement("ACCTTYPE");			
+			AccountsDbAdapter acctDbAdapter = new AccountsDbAdapter(GnuCashApplication.getAppContext());
+			accttype.appendChild(doc.createTextNode(acctDbAdapter.getAccountType(doubleAccountUID).toString()));
+			acctDbAdapter.close();
 			
 			Element bankAccountTo = doc.createElement("BANKACCTTO");
 			bankAccountTo.appendChild(bankId);
diff --git a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
index a452f1fd..dc1f4db3 100644
--- a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -244,6 +244,24 @@ public String getAccountUID(long id){
 	}
 	
 	/**
+	 * Returns the {@link AccountType} of the account with unique ID <code>uid</code>
+	 * @param uid Unique ID of the account
+	 * @return {@link AccountType} of the account
+	 */
+	public AccountType getAccountType(String uid){
+		String type = null;
+		Cursor c = mDb.query(DatabaseHelper.ACCOUNTS_TABLE_NAME, 
+				new String[]{DatabaseHelper.KEY_TYPE}, 
+				DatabaseHelper.KEY_UID + "='" + uid + "'", 
+				null, null, null, null);
+		if (c != null && c.moveToFirst()){
+			type = c.getString(0); //0 because we requested only the type column
+			c.close();
+		}
+		return AccountType.valueOf(type);
+	}
+	
+	/**
 	 * Returns the name of the account with id <code>accountID</code>
 	 * @param accountID Database ID of the account record
 	 * @return Name of the account 
@@ -379,6 +397,16 @@ public String getCurrencyCode(long id){
 	}
 	
 	/**
+	 * Returns the currency code of account with database ID
+	 * @param accountUID Unique Identifier of the account
+	 * @return ISO 4217 currency code of the account
+	 * @see #getCurrencyCode(long) 
+	 */
+	public String getCurrencyCode(String accountUID){
+		return getCurrencyCode(getAccountID(accountUID));
+	}
+	
+	/**
 	 * Deletes all accounts and their transactions from the database
 	 */
 	public void deleteAllAccounts(){
diff --git a/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java b/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
index 6e6138d6..2eb49d39 100644
--- a/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
+++ b/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
@@ -133,7 +133,7 @@
 			+ KEY_ROW_ID + " integer primary key autoincrement, "
 			+ KEY_UID 	+ " varchar(255) not null, "
 			+ KEY_NAME 	+ " varchar(255) not null, "
-			+ KEY_TYPE 	+ " varchar(255), "			
+			+ KEY_TYPE 	+ " varchar(255) not null, "			
 			+ KEY_CURRENCY_CODE + " varchar(255) not null, "
 			+ KEY_PARENT_ACCOUNT_UID + " varchar(255), "
 			+ "UNIQUE (" + KEY_UID + ")"	
diff --git a/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
index 295829b0..5b2da60a 100644
--- a/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/TransactionsDbAdapter.java
@@ -161,7 +161,7 @@ public Cursor fetchAllTransactionsForAccount(long accountID){
 		while (c.moveToNext()) {
 			Transaction transaction = buildTransactionInstance(c);
 			String doubleEntryAccountUID = transaction.getDoubleEntryAccountUID();
-			//negate double entry transactions for the origin account
+			//negate double entry transactions for the transfer account
 			if (doubleEntryAccountUID != null && doubleEntryAccountUID.equals(accountUID)){
 				transaction.setAmount(transaction.getAmount().negate());
 			}
@@ -179,6 +179,7 @@ public Cursor fetchAllTransactionsForAccount(long accountID){
 	 */
 	public Transaction buildTransactionInstance(Cursor c){		
 		String accountUID = c.getString(DatabaseAdapter.COLUMN_ACCOUNT_UID);
+		String doubleAccountUID = c.getString(DatabaseAdapter.COLUMN_DOUBLE_ENTRY_ACCOUNT_UID);
 		Currency currency = Currency.getInstance(getCurrencyCode(accountUID));
 		String amount = c.getString(DatabaseAdapter.COLUMN_AMOUNT);
 		Money moneyAmount = new Money(new BigDecimal(amount), currency);
@@ -190,7 +191,7 @@ public Transaction buildTransactionInstance(Cursor c){
 		transaction.setTime(c.getLong(DatabaseAdapter.COLUMN_TIMESTAMP));
 		transaction.setDescription(c.getString(DatabaseAdapter.COLUMN_DESCRIPTION));
 		transaction.setExported(c.getInt(DatabaseAdapter.COLUMN_EXPORTED) == 1);
-		transaction.setDoubleEntryAccountUID(c.getString(DatabaseAdapter.COLUMN_DOUBLE_ENTRY_ACCOUNT_UID));
+		transaction.setDoubleEntryAccountUID(doubleAccountUID);
 		
 		return transaction;
 	}
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
index 95236efa..3b0bd5fe 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
@@ -40,7 +40,6 @@
 import android.content.Intent;
 import android.database.Cursor;
 import android.os.Bundle;
-import android.preference.PreferenceManager;
 import android.support.v4.app.DialogFragment;
 import android.support.v4.app.Fragment;
 import android.support.v4.app.FragmentManager;
@@ -411,7 +410,9 @@ public boolean onOptionsItemSelected(MenuItem item) {
 	 */
 	public void refreshList(){
 		getLoaderManager().restartLoader(0, null, this);
-		
+				
+/*
+		//TODO: Figure out a way to display account balances
 		boolean doubleEntryActive = PreferenceManager.getDefaultSharedPreferences(getActivity())
 				.getBoolean(getString(R.string.key_use_double_entry), false);
 		
@@ -427,6 +428,7 @@ public void refreshList(){
 			tv.setTextColor(getResources().getColor(R.color.debit_red));
 		else
 			tv.setTextColor(getResources().getColor(R.color.credit_green));
+*/
 	}
 	
 	/**
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
index b53e4539..27738404 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
@@ -27,6 +27,7 @@
 import java.nio.channels.FileChannel;
 import java.text.SimpleDateFormat;
 import java.util.Date;
+import java.util.Locale;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
@@ -165,7 +166,8 @@ public void onClick(View v) {
 			if (mDeleteAllCheckBox.isChecked()){
 				Fragment currentFragment = getActivity().getSupportFragmentManager()
 						.findFragmentByTag(AccountsActivity.FRAGMENT_ACCOUNTS_LIST);
-				TransactionsDeleteConfirmationDialog alertFragment = TransactionsDeleteConfirmationDialog.newInstance(R.string.title_confirm_delete, 0);
+				TransactionsDeleteConfirmationDialog alertFragment = 
+						TransactionsDeleteConfirmationDialog.newInstance(R.string.title_confirm_delete, 0);
 				alertFragment.setTargetFragment(currentFragment, 0);
 				alertFragment.show(getActivity().getSupportFragmentManager(), "transactions_delete_confirmation_dialog");
 			}
@@ -280,9 +282,10 @@ private void shareFile(String path){
 		if (defaultEmail != null && defaultEmail.trim().length() > 0){
 			shareIntent.putExtra(Intent.EXTRA_EMAIL, new String[]{defaultEmail});
 		}			
-		SimpleDateFormat formatter = new SimpleDateFormat("yyyy.MM.dd HH:mm");
+		SimpleDateFormat formatter = (SimpleDateFormat) SimpleDateFormat.getDateTimeInstance();
+		
 		shareIntent.putExtra(Intent.EXTRA_TEXT, getString(R.string.description_export_email) 
-							+ formatter.format(new Date(System.currentTimeMillis())));
+							+ " " + formatter.format(new Date(System.currentTimeMillis())));
 		startActivity(Intent.createChooser(shareIntent, getString(R.string.title_share_ofx_with)));	
 	}
 	
@@ -315,7 +318,7 @@ public static void copyFile(File src, File dst) throws IOException
 	 * @return String containing the file name
 	 */
 	public static String buildExportFilename(){
-		SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMdd_HHmm");
+		SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMdd_HHmm", Locale.US);
 		String filename = formatter.format(
 				new Date(System.currentTimeMillis())) 
 				+ "_gnucash_all.ofx";
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
index 17aad77e..1101ff67 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
@@ -181,7 +181,7 @@
 	/**
 	 * Spinner for selecting the transfer account
 	 */
-	private Spinner mTransferAccountSpinner;
+	private Spinner mDoubleAccountSpinner;
 
 	private boolean mUseDoubleEntry;  
 	
@@ -200,7 +200,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container,
 		mAmountEditText = (EditText) v.findViewById(R.id.input_transaction_amount);		
 		mCurrencyTextView = (TextView) v.findViewById(R.id.currency_symbol);
 		mTransactionTypeButton = (ToggleButton) v.findViewById(R.id.input_transaction_type);
-		mTransferAccountSpinner = (Spinner) v.findViewById(R.id.input_double_entry_accounts_spinner);
+		mDoubleAccountSpinner = (Spinner) v.findViewById(R.id.input_double_entry_accounts_spinner);
 		
 		return v;
 	}
@@ -300,8 +300,12 @@ private void initalizeViews() {
 	
 	private void updateTransferAccountsList(){
 		long accountId = ((TransactionsActivity)getActivity()).getCurrentAccountID();
-		String conditions = "(" + DatabaseHelper.KEY_ROW_ID + " != " + accountId + ") AND " + "(" +
-							DatabaseHelper.KEY_CURRENCY_CODE + " = '" + mAccountsDbAdapter.getCurrencyCode(accountId) + "')";
+		
+		//TODO: we'll leave out the currency condition for now, maybe look at this in the future
+//		String conditions = "(" + DatabaseHelper.KEY_ROW_ID + " != " + accountId + ") AND " + "(" +
+//							DatabaseHelper.KEY_CURRENCY_CODE + " = '" + mAccountsDbAdapter.getCurrencyCode(accountId) + "')";
+		
+		String conditions = "(" + DatabaseHelper.KEY_ROW_ID + " != " + accountId + ")";
 		mCursor = mAccountsDbAdapter.fetchAccounts(conditions);
 		
 		String[] from = new String[] {DatabaseHelper.KEY_NAME};
@@ -310,7 +314,7 @@ private void updateTransferAccountsList(){
 				android.R.layout.simple_spinner_item, 
 				mCursor, from, to, 0);
 		mCursorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);		
-		mTransferAccountSpinner.setAdapter(mCursorAdapter);
+		mDoubleAccountSpinner.setAdapter(mCursorAdapter);
 	}
 	
 	/**
@@ -386,7 +390,7 @@ public void onClick(View v) {
 	private void setSelectedTransferAccount(long accountId){
 		for (int pos = 0; pos < mCursorAdapter.getCount(); pos++) {
 			if (mCursorAdapter.getItemId(pos) == accountId){
-				mTransferAccountSpinner.setSelection(pos);				
+				mDoubleAccountSpinner.setSelection(pos);				
 				break;
 			}
 		}
@@ -441,7 +445,7 @@ private void saveNewTransaction() {
 		
 		//set the double account
 		if (mUseDoubleEntry){
-			long doubleAccountId = mTransferAccountSpinner.getSelectedItemId();
+			long doubleAccountId = mDoubleAccountSpinner.getSelectedItemId();
 			//negate the transaction before saving if we are in the double account
 			if (isInDoubleAccount()){
 				mTransaction.setAmount(amount.negate());
diff --git a/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java b/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
index ac6bb7f7..dbdd7598 100644
--- a/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
+++ b/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
@@ -41,7 +41,7 @@
 	/**
 	 * A date formatter used when creating file names for the exported data
 	 */
-	public final static SimpleDateFormat OFX_DATE_FORMATTER = new SimpleDateFormat("yyyyMMddHHmmss");
+	public final static SimpleDateFormat OFX_DATE_FORMATTER = new SimpleDateFormat("yyyyMMddHHmmss", Locale.US);
 	
 	/**
 	 * ID which will be used as the bank ID for OFX from this app
@@ -140,69 +140,8 @@ public void toOfx(Document doc, Element parent){
 			if (account.getTransactionCount() == 0)
 				continue; 
 			
-			Element currency = doc.createElement("CURDEF");
-			currency.appendChild(doc.createTextNode(account.getCurrency().getCurrencyCode()));						
-			
-			//================= BEGIN BANK ACCOUNT INFO (BANKACCTFROM) =================================
-			
-			Element bankId = doc.createElement("BANKID");
-			bankId.appendChild(doc.createTextNode(APP_ID));
-			
-			Element acctId = doc.createElement("ACCTID");
-			acctId.appendChild(doc.createTextNode(account.getUID()));
-			
-			Element accttype = doc.createElement("ACCTTYPE");
-			accttype.appendChild(doc.createTextNode(account.getAccountType().toString()));
-			
-			Element bankFrom = doc.createElement("BANKACCTFROM");
-			bankFrom.appendChild(bankId);
-			bankFrom.appendChild(acctId);
-			bankFrom.appendChild(accttype);
-			
-			//================= END BANK ACCOUNT INFO ============================================
-			
-			
-			//================= BEGIN ACCOUNT BALANCE INFO =================================
-			String balance = account.getBalance().toPlainString();
-			String formattedCurrentTimeString = getFormattedCurrentTime();
-			
-			Element balanceAmount = doc.createElement("BALAMT");
-			balanceAmount.appendChild(doc.createTextNode(balance));			
-			Element dtasof = doc.createElement("DTASOF");
-			dtasof.appendChild(doc.createTextNode(formattedCurrentTimeString));
-			
-			Element ledgerBalance = doc.createElement("LEDGERBAL");
-			ledgerBalance.appendChild(balanceAmount);
-			ledgerBalance.appendChild(dtasof);
-			
-			//================= END ACCOUNT BALANCE INFO =================================
-			
-			
-			//================= BEGIN TIME PERIOD INFO =================================
-			
-			Element dtstart = doc.createElement("DTSTART");			
-			dtstart.appendChild(doc.createTextNode(formattedCurrentTimeString));
-			
-			Element dtend = doc.createElement("DTEND");
-			dtend.appendChild(doc.createTextNode(formattedCurrentTimeString));
-			
-			Element bankTransactionsList = doc.createElement("BANKTRANLIST");
-			bankTransactionsList.appendChild(dtstart);
-			bankTransactionsList.appendChild(dtend);
-			
-			//================= END TIME PERIOD INFO =================================
-			
-						
-			Element statementTransactions = doc.createElement("STMTRS");
-			statementTransactions.appendChild(currency);
-			statementTransactions.appendChild(bankFrom);
-			statementTransactions.appendChild(bankTransactionsList);
-			statementTransactions.appendChild(ledgerBalance);
-			
-			statementTransactionResponse.appendChild(statementTransactions);
-			
 			//add account details (transactions) to the XML document			
-			account.toOfx(doc, bankTransactionsList, mExportAll);
+			account.toOfx(doc, statementTransactionResponse, mExportAll);
 			
 			//mark as exported
 			transactionsDbAdapter.markAsExported(account.getUID());

From 98f4d603556300e98801d2970dcd91d91608e4e1 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 4 Jan 2013 15:24:15 +0100
Subject: [PATCH 12/27] Convert database account type to GnuCash-compatible
 account types Introduce mapping to fox Account types when exporting OFX data
 Update beta version code in manifest

---
 GnucashMobile/AndroidManifest.xml                    |  2 +-
 .../src/org/gnucash/android/data/Account.java        | 13 ++++++++-----
 .../src/org/gnucash/android/data/Transaction.java    |  4 +++-
 .../org/gnucash/android/db/AccountsDbAdapter.java    |  3 ++-
 .../src/org/gnucash/android/db/DatabaseHelper.java   | 20 +++++++++++++-------
 5 files changed, 27 insertions(+), 15 deletions(-)

diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index 5386d5f6..1be8c073 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -18,7 +18,7 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="org.gnucash.android"
     android:versionCode="5"
-    android:versionName="1.0.4.beta1" >
+    android:versionName="1.1.0.beta1" >
 
     <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15"/>
     
diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index 56325058..f70b379e 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -52,7 +52,7 @@
 	 * they are currently not used except for exporting
 	 */
 	public enum AccountType {CASH, BANK, CREDIT_CARD, ASSET, LIABILITY, INCOME, EXPENSE, 
-		EQUITY, CURRENCY, STOCK, MUTUAL_FUND, CHECKING, SAVINGS, MONEYMRKT, CREDITLINE};
+							PAYABLE, RECEIVABLE, EQUITY, CURRENCY, STOCK, MUTUAL_FUND};
 	
 	public enum OfxAccountType {CHECKING, SAVINGS, MONEYMRKT, CREDITLINE };
 		
@@ -314,15 +314,16 @@ public String getParentUID() {
 	 * @see AccountType
 	 * @see OfxAccountType
 	 */
-	public OfxAccountType ofxAccountTypeMapping(AccountType accountType){
+	public static OfxAccountType convertToOfxAccountType(AccountType accountType){
 		switch (accountType) {
-		case CREDITLINE:
+		case CREDIT_CARD:
 			return OfxAccountType.CREDITLINE;
 			
 		case CASH:
 		case INCOME:
 		case EXPENSE:
-		case CURRENCY:
+		case PAYABLE:
+		case RECEIVABLE:
 			return OfxAccountType.CHECKING;
 			
 		case BANK:
@@ -332,6 +333,7 @@ public OfxAccountType ofxAccountTypeMapping(AccountType accountType){
 		case MUTUAL_FUND:
 		case STOCK:
 		case EQUITY:
+		case CURRENCY:
 			return OfxAccountType.MONEYMRKT;
 
 		default:
@@ -357,7 +359,8 @@ public void toOfx(Document doc, Element parent, boolean allTransactions){
 		acctId.appendChild(doc.createTextNode(mUID));
 		
 		Element accttype = doc.createElement("ACCTTYPE");
-		accttype.appendChild(doc.createTextNode(mAccountType.toString()));
+		String ofxAccountType = convertToOfxAccountType(mAccountType).toString();
+		accttype.appendChild(doc.createTextNode(ofxAccountType));
 		
 		Element bankFrom = doc.createElement("BANKACCTFROM");
 		bankFrom.appendChild(bankId);
diff --git a/GnucashMobile/src/org/gnucash/android/data/Transaction.java b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
index 3ae7b31c..be2968c5 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Transaction.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
@@ -23,6 +23,7 @@
 import java.util.UUID;
 
 import org.gnucash.android.app.GnuCashApplication;
+import org.gnucash.android.data.Account.OfxAccountType;
 import org.gnucash.android.db.AccountsDbAdapter;
 import org.gnucash.android.util.OfxFormatter;
 import org.w3c.dom.Document;
@@ -409,7 +410,8 @@ public Element toOfx(Document doc, String accountUID){
 			
 			Element accttype = doc.createElement("ACCTTYPE");			
 			AccountsDbAdapter acctDbAdapter = new AccountsDbAdapter(GnuCashApplication.getAppContext());
-			accttype.appendChild(doc.createTextNode(acctDbAdapter.getAccountType(doubleAccountUID).toString()));
+			OfxAccountType ofxAccountType = Account.convertToOfxAccountType(acctDbAdapter.getAccountType(doubleAccountUID));
+			accttype.appendChild(doc.createTextNode(ofxAccountType.toString()));
 			acctDbAdapter.close();
 			
 			Element bankAccountTo = doc.createElement("BANKACCTTO");
diff --git a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
index dc1f4db3..ea4ac62d 100644
--- a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -78,7 +78,8 @@ public long addAccount(Account account){
 		if ((rowId = getAccountID(account.getUID())) > 0){
 			//if account already exists, then just update
 			Log.d(TAG, "Updating existing account");
-			mDb.update(DatabaseHelper.ACCOUNTS_TABLE_NAME, contentValues, DatabaseHelper.KEY_ROW_ID + " = " + rowId, null);
+			mDb.update(DatabaseHelper.ACCOUNTS_TABLE_NAME, contentValues, 
+					DatabaseHelper.KEY_ROW_ID + " = " + rowId, null);
 		} else {
 			Log.d(TAG, "Adding new account to db");
 			rowId = mDb.insert(DatabaseHelper.ACCOUNTS_TABLE_NAME, null, contentValues);
diff --git a/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java b/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
index 2eb49d39..20ee6629 100644
--- a/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
+++ b/GnucashMobile/src/org/gnucash/android/db/DatabaseHelper.java
@@ -16,6 +16,9 @@
 
 package org.gnucash.android.db;
 
+import org.gnucash.android.data.Account.AccountType;
+
+import android.content.ContentValues;
 import android.content.Context;
 import android.database.sqlite.SQLiteDatabase;
 import android.database.sqlite.SQLiteOpenHelper;
@@ -176,8 +179,7 @@ public void onCreate(SQLiteDatabase db) {
 	@Override
 	public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
 		Log.i(TAG, "Upgrading database from version " 
-				+ oldVersion + " to " + newVersion
-				+ " which will destroy all old data");
+				+ oldVersion + " to " + newVersion);
 		
 		if (oldVersion < newVersion){
 			//introducing double entry accounting
@@ -187,6 +189,8 @@ public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
 				String addColumnSql = "ALTER TABLE " + TRANSACTIONS_TABLE_NAME + 
 									" ADD COLUMN " + KEY_DOUBLE_ENTRY_ACCOUNT_UID + " varchar(255)";
 				
+				//introducing sub accounts
+				Log.i(TAG, "Adding column for parent accounts");
 				String addParentAccountSql = "ALTER TABLE " + ACCOUNTS_TABLE_NAME + 
 						" ADD COLUMN " + KEY_PARENT_ACCOUNT_UID + " varchar(255)";
 	
@@ -194,13 +198,15 @@ public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
 				db.execSQL(addParentAccountSql);
 			}
 			
+			//update account types to GnuCash account types
+			//since all were previously CHECKING, now all will be CASH
+			Log.i(TAG, "Converting account types to GnuCash compatible types");
+			ContentValues cv = new ContentValues();
+			cv.put(KEY_TYPE, AccountType.CASH.toString());
+			db.update(ACCOUNTS_TABLE_NAME, cv, null, null);
+				
 		} else {
 			Log.i(TAG, "Cannot downgrade database.");
-			/*
-			db.execSQL("DROP TABLE IF EXISTS " + TRANSACTIONS_TABLE_NAME);
-			db.execSQL("DROP TABLE IF EXISTS " + ACCOUNTS_TABLE_NAME);
-			onCreate(db);
-			*/
 		}
 	}
 

From 6e3dd8c499b788233fecf1e2ce508b3c72cca46d Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jorge=20Mart=C3=ADnez=20L=C3=B3pez?= <jorgeml@gmail.com>
Date: Wed, 9 Jan 2013 08:38:45 +0000
Subject: [PATCH 13/27] Added new Spanish translations

Added new Spanish translations and improved style in existing ones.
---
 GnucashMobile/res/values-es/strings.xml | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)

diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index c21d084a..be83839c 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
- Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
- Copyright (c) 2012 Jorge Martnez Lpez <jorgeml@gmail.com>
+ Copyright (c) 2013 Ngewi Fet <ngewif@gmail.com>
+ Copyright (c) 2013 Jorge Martnez Lpez <jorgeml@gmail.com>
  
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
@@ -53,7 +53,7 @@
     <string name="label_export_destination">Destino de la exportaci&#243;n</string>
     <string name="title_export_dialog">Exportar OFX</string>
     <string name="option_export_all_transactions">Exportar todas las transacciones</string>
-    <string name="hint_export_choice">Por defecto solo las nuevas transacciones desde la &#250;ltima exportaci&#243;n ser&#225;n exportadas. Selecciona esta opci&#243;n para exportar todas las transacciones</string>
+    <string name="hint_export_choice">Por defecto solo las nuevas transacciones desde la &#250;ltima exportaci&#243;n ser&#225;n exportadas. Seleccione esta opci&#243;n para exportar todas las transacciones</string>
     <string name="error_exporting">Error exportando datos OFX</string>    
     <string name="btn_export">Exportar</string>
     <string name="option_delete_after_export">Borrar despu&#233;s de exportar</string>
@@ -76,7 +76,7 @@
     <string name="summary_default_currency">Divisa por defecto para las nuevas cuentas</string>
     <string name="label_permission_record_transactions">Permite almacenar transacciones en Gnucash para Android</string>
     <string name="label_permission_create_accounts">Permite crear cuentas en Gnucash para Android</string>
-    <string name="label_permission_group">Tus datos GnuCash</string>
+    <string name="label_permission_group">Sus datos GnuCash</string>
     <string name="description_permission_group">Leer y modificar datos Gnucash</string>
     <string name="label_permission_record_transaction">almacenar transacciones</string>
     <string name="label_permission_create_account">crear cuentas</string>
@@ -267,7 +267,7 @@
 	    <item>Entretenimiento</item>
 	    <item>Seguros</item>
 	</string-array>
-	<string name="error_no_accounts">No hay cuentas en Gnucash.\nCrea una cuenta antes de a&#241;adir un widget</string>
+	<string name="error_no_accounts">No hay cuentas en Gnucash.\nCree una cuenta antes de a&#241;adir un widget</string>
 	<string name="title_build_version">Versi&#243;n de compilaci&#243;n</string>
 	<string name="title_license">Licencia</string>
 	<string name="summary_licence_details">Apache License v2.0. Clic para m&#225;s detalles</string>
@@ -290,11 +290,14 @@
 		<item>ABONO</item>
 		<item>CARGO</item>
 	</string-array>
-	<string name="delete_all_transactions_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar TODAS las transacciones?</string>
-	<string name="delete_transaction_confirmation_message">&#191;Est&#225;s seguro de que quieres borrar esta transacci&#243;n?</string>
+	<string name="delete_all_transactions_confirmation_message">&#191;Borrar TODAS las transacciones?</string>
+	<string name="delete_transaction_confirmation_message">&#191;Borrar esta transacci&#243;n?</string>
 	<string name="title_export_preference_category">Exportaci&#243;n</string>
 	<string name="title_export_all_transactions">Exportar siempre todas las transacciones</string>
 	<string name="title_always_delete_exported_transactions">Borrar siempre todas las transacciones exportadas</string>
 	<string name="title_default_export_email">Correo electr&#243;nico por defecto para exportar</string>
-	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Puedes cambiarla en cada exportaci&#243;n.</string>
+	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Se puede cambiar en cada exportaci&#243;n.</string>
+	<string name="key_sgml_ofx_header">sgml_ofx_header</string>
+	<string name="title_sgml_ofx_header">Usar SGML para el encabezado OFX</string>
+	<string name="summary_sgml_ofx_header">Permite a la versi&#243;n de escritorio de GnuCash detectar correctamente la codificaci&#243;n del archivo OFX. &#218;til para conjuntos de caracteres no latinos.</string>
 </resources>

From 08b2a8ce462a5ce51594b000a5204c87482c473d Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 16 Jan 2013 22:45:06 +0100
Subject: [PATCH 14/27] Fixed: exporting OFX outputs the wrong account type
 Commented total account summary code pending better solution for multiple
 currencies Code refactoring

---
 GnucashMobile/AndroidManifest.xml                  |  2 +-
 GnucashMobile/res/values/strings.xml               |  2 +-
 .../gnucash/android/app/GnuCashApplication.java    | 27 +++++++++
 .../src/org/gnucash/android/data/Account.java      | 69 +++++++++++++++++++++-
 .../src/org/gnucash/android/data/Transaction.java  | 16 +++--
 .../org/gnucash/android/db/AccountsDbAdapter.java  | 10 ++++
 .../android/ui/accounts/AccountsListFragment.java  |  6 +-
 .../android/ui/accounts/ExportDialogFragment.java  | 11 ++--
 .../ui/transactions/NewTransactionFragment.java    | 18 +++---
 .../src/org/gnucash/android/util/OfxFormatter.java | 67 +--------------------
 10 files changed, 143 insertions(+), 85 deletions(-)
 create mode 100644 GnucashMobile/src/org/gnucash/android/app/GnuCashApplication.java

diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index eba68ba4..5386d5f6 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -43,7 +43,7 @@
     <uses-permission android:label="@string/permission_access_sdcard"
         android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
 	    
-    <application
+    <application android:name="org.gnucash.android.app.GnuCashApplication"
         android:icon="@drawable/ic_launcher"
         android:label="@string/app_name" 
         android:theme="@style/Theme.Sherlock.Light.DarkActionBar">
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 1f2a77f8..797e5d5f 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -497,5 +497,5 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="key_sgml_ofx_header">sgml_ofx_header</string>
 	<string name="title_sgml_ofx_header">Use SGML for OFX header</string>
-	<string name="summary_sgml_ofx_header">Allows GnuCash desktop to correctly detect encoding of OFX file. Useful for non-Latin character sets.</string>
+	<string name="summary_sgml_ofx_header">Enables better encoding support in desktop GnuCash. Deactivate if you are not exporting to desktop GnuCash</string>
 </resources>
diff --git a/GnucashMobile/src/org/gnucash/android/app/GnuCashApplication.java b/GnucashMobile/src/org/gnucash/android/app/GnuCashApplication.java
new file mode 100644
index 00000000..38c6113d
--- /dev/null
+++ b/GnucashMobile/src/org/gnucash/android/app/GnuCashApplication.java
@@ -0,0 +1,27 @@
+package org.gnucash.android.app;
+
+import android.app.Application;
+import android.content.Context;
+
+/**
+ * An {@link Application} subclass for retrieving static context
+ * @author Ngewi Fet <ngewif@gmail.com>
+ *
+ */
+public class GnuCashApplication extends Application{
+
+    private static Context context;
+
+    public void onCreate(){
+        super.onCreate();
+        GnuCashApplication.context = getApplicationContext();
+    }
+
+    /**
+     * Returns the application context
+     * @return Application {@link Context} object
+     */
+    public static Context getAppContext() {
+        return GnuCashApplication.context;
+    }
+}
\ No newline at end of file
diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index 938e7490..f7161cbc 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -23,6 +23,7 @@
 import java.util.Locale;
 import java.util.UUID;
 
+import org.gnucash.android.util.OfxFormatter;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
 
@@ -336,12 +337,76 @@ public OfxAccountType ofxAccountTypeMapping(AccountType accountType){
 	 * @param parent Parent node to which to add this account's transactions in XML
 	 */
 	public void toOfx(Document doc, Element parent, boolean allTransactions){
+		Element currency = doc.createElement("CURDEF");
+		currency.appendChild(doc.createTextNode(mCurrency.getCurrencyCode()));						
+		
+		//================= BEGIN BANK ACCOUNT INFO (BANKACCTFROM) =================================
+		
+		Element bankId = doc.createElement("BANKID");
+		bankId.appendChild(doc.createTextNode(OfxFormatter.APP_ID));
+		
+		Element acctId = doc.createElement("ACCTID");
+		acctId.appendChild(doc.createTextNode(mUID));
+		
+		Element accttype = doc.createElement("ACCTTYPE");
+		accttype.appendChild(doc.createTextNode(mAccountType.toString()));
+		
+		Element bankFrom = doc.createElement("BANKACCTFROM");
+		bankFrom.appendChild(bankId);
+		bankFrom.appendChild(acctId);
+		bankFrom.appendChild(accttype);
+		
+		//================= END BANK ACCOUNT INFO ============================================
+		
+		
+		//================= BEGIN ACCOUNT BALANCE INFO =================================
+		String balance = getBalance().toPlainString();
+		String formattedCurrentTimeString = OfxFormatter.getFormattedCurrentTime();
+		
+		Element balanceAmount = doc.createElement("BALAMT");
+		balanceAmount.appendChild(doc.createTextNode(balance));			
+		Element dtasof = doc.createElement("DTASOF");
+		dtasof.appendChild(doc.createTextNode(formattedCurrentTimeString));
+		
+		Element ledgerBalance = doc.createElement("LEDGERBAL");
+		ledgerBalance.appendChild(balanceAmount);
+		ledgerBalance.appendChild(dtasof);
+		
+		//================= END ACCOUNT BALANCE INFO =================================
+		
+		
+		//================= BEGIN TIME PERIOD INFO =================================
+		
+		Element dtstart = doc.createElement("DTSTART");			
+		dtstart.appendChild(doc.createTextNode(formattedCurrentTimeString));
+		
+		Element dtend = doc.createElement("DTEND");
+		dtend.appendChild(doc.createTextNode(formattedCurrentTimeString));
+		
+		//================= END TIME PERIOD INFO =================================
+		
+		
+		//================= BEGIN TRANSACTIONS LIST =================================
+		Element bankTransactionsList = doc.createElement("BANKTRANLIST");
+		bankTransactionsList.appendChild(dtstart);
+		bankTransactionsList.appendChild(dtend);
+		
 		for (Transaction transaction : mTransactionsList) {
 			if (!allTransactions && transaction.isExported())
 				continue;
 			
-			parent.appendChild(transaction.toOfx(doc));
-		}
+			bankTransactionsList.appendChild(transaction.toOfx(doc, mUID));
+		}		
+		//================= END TRANSACTIONS LIST =================================
+					
+		Element statementTransactions = doc.createElement("STMTRS");
+		statementTransactions.appendChild(currency);
+		statementTransactions.appendChild(bankFrom);
+		statementTransactions.appendChild(bankTransactionsList);
+		statementTransactions.appendChild(ledgerBalance);
+		
+		parent.appendChild(statementTransactions);
+				
 	}
 
 }
diff --git a/GnucashMobile/src/org/gnucash/android/data/Transaction.java b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
index 9455bb11..af9a498d 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Transaction.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
@@ -22,7 +22,8 @@
 import java.util.Locale;
 import java.util.UUID;
 
-import org.gnucash.android.data.Account.OfxAccountType;
+import org.gnucash.android.app.GnuCashApplication;
+import org.gnucash.android.db.AccountsDbAdapter;
 import org.gnucash.android.util.OfxFormatter;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
@@ -357,11 +358,13 @@ public void setAccountUID(String accountUID) {
 	
 	/**
 	 * Converts transaction to XML DOM corresponding to OFX Statement transaction and 
-	 * returns the element node for the transaction
+	 * returns the element node for the transaction.
+	 * The Unique ID of the account is needed in order to properly export double entry transactions
 	 * @param doc XML document to which transaction should be added
+	 * @param accountUID Unique Identifier of the account which called the method.
 	 * @return Element in DOM corresponding to transaction
 	 */
-	public Element toOfx(Document doc){		
+	public Element toOfx(Document doc, String accountUID){		
 		Element transactionNode = doc.createElement("STMTTRN");
 		Element type = doc.createElement("TRNTYPE");
 		type.appendChild(doc.createTextNode(mType.toString()));
@@ -402,7 +405,12 @@ public Element toOfx(Document doc){
 			acctId.appendChild(doc.createTextNode(mDoubleEntryAccountUID));
 			
 			Element accttype = doc.createElement("ACCTTYPE");
-			accttype.appendChild(doc.createTextNode(OfxAccountType.CHECKING.toString()));
+			//select the proper account as the double account
+			String doubleAccountUID = mDoubleEntryAccountUID.equals(accountUID) ? mAccountUID : mDoubleEntryAccountUID;
+			AccountsDbAdapter acctDbAdapter = new AccountsDbAdapter(GnuCashApplication.getAppContext());
+			Account account = acctDbAdapter.getAccount(doubleAccountUID);
+			acctDbAdapter.close();
+			accttype.appendChild(doc.createTextNode(account.getAccountType().toString()));
 			
 			Element bankAccountTo = doc.createElement("BANKACCTTO");
 			bankAccountTo.appendChild(bankId);
diff --git a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
index a452f1fd..959ae8fe 100644
--- a/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
+++ b/GnucashMobile/src/org/gnucash/android/db/AccountsDbAdapter.java
@@ -379,6 +379,16 @@ public String getCurrencyCode(long id){
 	}
 	
 	/**
+	 * Returns the currency code of account with database ID
+	 * @param accountUID Unique Identifier of the account
+	 * @return ISO 4217 currency code of the account
+	 * @see #getCurrencyCode(long) 
+	 */
+	public String getCurrencyCode(String accountUID){
+		return getCurrencyCode(getAccountID(accountUID));
+	}
+	
+	/**
 	 * Deletes all accounts and their transactions from the database
 	 */
 	public void deleteAllAccounts(){
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
index 95236efa..3b0bd5fe 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsListFragment.java
@@ -40,7 +40,6 @@
 import android.content.Intent;
 import android.database.Cursor;
 import android.os.Bundle;
-import android.preference.PreferenceManager;
 import android.support.v4.app.DialogFragment;
 import android.support.v4.app.Fragment;
 import android.support.v4.app.FragmentManager;
@@ -411,7 +410,9 @@ public boolean onOptionsItemSelected(MenuItem item) {
 	 */
 	public void refreshList(){
 		getLoaderManager().restartLoader(0, null, this);
-		
+				
+/*
+		//TODO: Figure out a way to display account balances
 		boolean doubleEntryActive = PreferenceManager.getDefaultSharedPreferences(getActivity())
 				.getBoolean(getString(R.string.key_use_double_entry), false);
 		
@@ -427,6 +428,7 @@ public void refreshList(){
 			tv.setTextColor(getResources().getColor(R.color.debit_red));
 		else
 			tv.setTextColor(getResources().getColor(R.color.credit_green));
+*/
 	}
 	
 	/**
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
index b53e4539..a64476cb 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
@@ -27,6 +27,7 @@
 import java.nio.channels.FileChannel;
 import java.text.SimpleDateFormat;
 import java.util.Date;
+import java.util.Locale;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
@@ -165,7 +166,8 @@ public void onClick(View v) {
 			if (mDeleteAllCheckBox.isChecked()){
 				Fragment currentFragment = getActivity().getSupportFragmentManager()
 						.findFragmentByTag(AccountsActivity.FRAGMENT_ACCOUNTS_LIST);
-				TransactionsDeleteConfirmationDialog alertFragment = TransactionsDeleteConfirmationDialog.newInstance(R.string.title_confirm_delete, 0);
+				TransactionsDeleteConfirmationDialog alertFragment = 
+						TransactionsDeleteConfirmationDialog.newInstance(R.string.title_confirm_delete, 0);
 				alertFragment.setTargetFragment(currentFragment, 0);
 				alertFragment.show(getActivity().getSupportFragmentManager(), "transactions_delete_confirmation_dialog");
 			}
@@ -280,9 +282,10 @@ private void shareFile(String path){
 		if (defaultEmail != null && defaultEmail.trim().length() > 0){
 			shareIntent.putExtra(Intent.EXTRA_EMAIL, new String[]{defaultEmail});
 		}			
-		SimpleDateFormat formatter = new SimpleDateFormat("yyyy.MM.dd HH:mm");
+		SimpleDateFormat formatter = (SimpleDateFormat) SimpleDateFormat.getDateTimeInstance(); //new SimpleDateFormat("yyyy.MM.dd HH:mm");
+		
 		shareIntent.putExtra(Intent.EXTRA_TEXT, getString(R.string.description_export_email) 
-							+ formatter.format(new Date(System.currentTimeMillis())));
+							+ " " + formatter.format(new Date(System.currentTimeMillis())));
 		startActivity(Intent.createChooser(shareIntent, getString(R.string.title_share_ofx_with)));	
 	}
 	
@@ -315,7 +318,7 @@ public static void copyFile(File src, File dst) throws IOException
 	 * @return String containing the file name
 	 */
 	public static String buildExportFilename(){
-		SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMdd_HHmm");
+		SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMdd_HHmm", Locale.US);
 		String filename = formatter.format(
 				new Date(System.currentTimeMillis())) 
 				+ "_gnucash_all.ofx";
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
index 17aad77e..1101ff67 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
@@ -181,7 +181,7 @@
 	/**
 	 * Spinner for selecting the transfer account
 	 */
-	private Spinner mTransferAccountSpinner;
+	private Spinner mDoubleAccountSpinner;
 
 	private boolean mUseDoubleEntry;  
 	
@@ -200,7 +200,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container,
 		mAmountEditText = (EditText) v.findViewById(R.id.input_transaction_amount);		
 		mCurrencyTextView = (TextView) v.findViewById(R.id.currency_symbol);
 		mTransactionTypeButton = (ToggleButton) v.findViewById(R.id.input_transaction_type);
-		mTransferAccountSpinner = (Spinner) v.findViewById(R.id.input_double_entry_accounts_spinner);
+		mDoubleAccountSpinner = (Spinner) v.findViewById(R.id.input_double_entry_accounts_spinner);
 		
 		return v;
 	}
@@ -300,8 +300,12 @@ private void initalizeViews() {
 	
 	private void updateTransferAccountsList(){
 		long accountId = ((TransactionsActivity)getActivity()).getCurrentAccountID();
-		String conditions = "(" + DatabaseHelper.KEY_ROW_ID + " != " + accountId + ") AND " + "(" +
-							DatabaseHelper.KEY_CURRENCY_CODE + " = '" + mAccountsDbAdapter.getCurrencyCode(accountId) + "')";
+		
+		//TODO: we'll leave out the currency condition for now, maybe look at this in the future
+//		String conditions = "(" + DatabaseHelper.KEY_ROW_ID + " != " + accountId + ") AND " + "(" +
+//							DatabaseHelper.KEY_CURRENCY_CODE + " = '" + mAccountsDbAdapter.getCurrencyCode(accountId) + "')";
+		
+		String conditions = "(" + DatabaseHelper.KEY_ROW_ID + " != " + accountId + ")";
 		mCursor = mAccountsDbAdapter.fetchAccounts(conditions);
 		
 		String[] from = new String[] {DatabaseHelper.KEY_NAME};
@@ -310,7 +314,7 @@ private void updateTransferAccountsList(){
 				android.R.layout.simple_spinner_item, 
 				mCursor, from, to, 0);
 		mCursorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);		
-		mTransferAccountSpinner.setAdapter(mCursorAdapter);
+		mDoubleAccountSpinner.setAdapter(mCursorAdapter);
 	}
 	
 	/**
@@ -386,7 +390,7 @@ public void onClick(View v) {
 	private void setSelectedTransferAccount(long accountId){
 		for (int pos = 0; pos < mCursorAdapter.getCount(); pos++) {
 			if (mCursorAdapter.getItemId(pos) == accountId){
-				mTransferAccountSpinner.setSelection(pos);				
+				mDoubleAccountSpinner.setSelection(pos);				
 				break;
 			}
 		}
@@ -441,7 +445,7 @@ private void saveNewTransaction() {
 		
 		//set the double account
 		if (mUseDoubleEntry){
-			long doubleAccountId = mTransferAccountSpinner.getSelectedItemId();
+			long doubleAccountId = mDoubleAccountSpinner.getSelectedItemId();
 			//negate the transaction before saving if we are in the double account
 			if (isInDoubleAccount()){
 				mTransaction.setAmount(amount.negate());
diff --git a/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java b/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
index ac6bb7f7..ee184ca2 100644
--- a/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
+++ b/GnucashMobile/src/org/gnucash/android/util/OfxFormatter.java
@@ -41,7 +41,7 @@
 	/**
 	 * A date formatter used when creating file names for the exported data
 	 */
-	public final static SimpleDateFormat OFX_DATE_FORMATTER = new SimpleDateFormat("yyyyMMddHHmmss");
+	public final static SimpleDateFormat OFX_DATE_FORMATTER = new SimpleDateFormat("yyyyMMddHHmmss", Locale.US);
 	
 	/**
 	 * ID which will be used as the bank ID for OFX from this app
@@ -139,70 +139,9 @@ public void toOfx(Document doc, Element parent){
 		for (Account account : mAccountsList) {		
 			if (account.getTransactionCount() == 0)
 				continue; 
-			
-			Element currency = doc.createElement("CURDEF");
-			currency.appendChild(doc.createTextNode(account.getCurrency().getCurrencyCode()));						
-			
-			//================= BEGIN BANK ACCOUNT INFO (BANKACCTFROM) =================================
-			
-			Element bankId = doc.createElement("BANKID");
-			bankId.appendChild(doc.createTextNode(APP_ID));
-			
-			Element acctId = doc.createElement("ACCTID");
-			acctId.appendChild(doc.createTextNode(account.getUID()));
-			
-			Element accttype = doc.createElement("ACCTTYPE");
-			accttype.appendChild(doc.createTextNode(account.getAccountType().toString()));
-			
-			Element bankFrom = doc.createElement("BANKACCTFROM");
-			bankFrom.appendChild(bankId);
-			bankFrom.appendChild(acctId);
-			bankFrom.appendChild(accttype);
-			
-			//================= END BANK ACCOUNT INFO ============================================
-			
-			
-			//================= BEGIN ACCOUNT BALANCE INFO =================================
-			String balance = account.getBalance().toPlainString();
-			String formattedCurrentTimeString = getFormattedCurrentTime();
-			
-			Element balanceAmount = doc.createElement("BALAMT");
-			balanceAmount.appendChild(doc.createTextNode(balance));			
-			Element dtasof = doc.createElement("DTASOF");
-			dtasof.appendChild(doc.createTextNode(formattedCurrentTimeString));
-			
-			Element ledgerBalance = doc.createElement("LEDGERBAL");
-			ledgerBalance.appendChild(balanceAmount);
-			ledgerBalance.appendChild(dtasof);
-			
-			//================= END ACCOUNT BALANCE INFO =================================
-			
-			
-			//================= BEGIN TIME PERIOD INFO =================================
-			
-			Element dtstart = doc.createElement("DTSTART");			
-			dtstart.appendChild(doc.createTextNode(formattedCurrentTimeString));
-			
-			Element dtend = doc.createElement("DTEND");
-			dtend.appendChild(doc.createTextNode(formattedCurrentTimeString));
-			
-			Element bankTransactionsList = doc.createElement("BANKTRANLIST");
-			bankTransactionsList.appendChild(dtstart);
-			bankTransactionsList.appendChild(dtend);
-			
-			//================= END TIME PERIOD INFO =================================
-			
-						
-			Element statementTransactions = doc.createElement("STMTRS");
-			statementTransactions.appendChild(currency);
-			statementTransactions.appendChild(bankFrom);
-			statementTransactions.appendChild(bankTransactionsList);
-			statementTransactions.appendChild(ledgerBalance);
-			
-			statementTransactionResponse.appendChild(statementTransactions);
-			
+	
 			//add account details (transactions) to the XML document			
-			account.toOfx(doc, bankTransactionsList, mExportAll);
+			account.toOfx(doc, statementTransactionResponse, mExportAll);
 			
 			//mark as exported
 			transactionsDbAdapter.markAsExported(account.getUID());

From 17f61876ba17849f41538bdc4438482037f1dca6 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 16 Jan 2013 23:42:44 +0100
Subject: [PATCH 15/27] Fixed: Crash when creating accounts with
 non-alphanumeric characters in their names (fixes #47) Fixed: GnuCashMobile
 declares itself as a launcher application (fixes #48). Declaration removed.
 Fixed: all default accounts created with account type 'CASH'. Now assigns the
 appropriate account type Improved: SGML headers now used by default for OFX
 export. Setting now enables XML headers instead

---
 GnucashMobile/AndroidManifest.xml                  |  1 -
 GnucashMobile/res/values-es/strings.xml            |  5 +---
 GnucashMobile/res/values/strings.xml               |  6 ++---
 .../res/xml/fragment_general_preferences.xml       |  2 +-
 .../src/org/gnucash/android/data/Account.java      |  2 +-
 .../android/ui/accounts/AccountsActivity.java      | 29 +++++++++++++++++++++-
 .../android/ui/accounts/ExportDialogFragment.java  | 10 ++++----
 7 files changed, 39 insertions(+), 16 deletions(-)

diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index 5386d5f6..85b6a8ad 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -53,7 +53,6 @@
             android:launchMode="singleTop">
             <intent-filter>
                 <action android:name="android.intent.action.MAIN" />
-				<category android:name="android.intent.category.HOME"/>
                 <category android:name="android.intent.category.LAUNCHER" />
             </intent-filter>
         </activity>
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index f8eab257..117933b3 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -296,8 +296,5 @@
 	<string name="title_export_all_transactions">Exportar siempre todas las transacciones</string>
 	<string name="title_always_delete_exported_transactions">Borrar siempre todas las transacciones exportadas</string>
 	<string name="title_default_export_email">Correo electr&#243;nico por defecto para exportar</string>
-	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Se puede cambiar en cada exportaci&#243;n.</string>
-	<string name="key_sgml_ofx_header">sgml_ofx_header</string>
-	<string name="title_sgml_ofx_header">Usar SGML para el encabezado OFX</string>
-	<string name="summary_sgml_ofx_header">Permite a la versi&#243;n de escritorio de GnuCash detectar correctamente la codificaci&#243;n del archivo OFX. &#218;til para conjuntos de caracteres no latinos.</string>
+	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Se puede cambiar en cada exportaci&#243;n.</string>	
 </resources>
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 797e5d5f..53f65136 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -495,7 +495,7 @@
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
 	<string name="label_account_currency">Currency</string>
 	<string name="label_parent_account">Parent account</string>
-	<string name="key_sgml_ofx_header">sgml_ofx_header</string>
-	<string name="title_sgml_ofx_header">Use SGML for OFX header</string>
-	<string name="summary_sgml_ofx_header">Enables better encoding support in desktop GnuCash. Deactivate if you are not exporting to desktop GnuCash</string>
+	<string name="key_xml_ofx_header">xml_ofx_header</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
diff --git a/GnucashMobile/res/xml/fragment_general_preferences.xml b/GnucashMobile/res/xml/fragment_general_preferences.xml
index 6dfc7854..fcf8e459 100644
--- a/GnucashMobile/res/xml/fragment_general_preferences.xml
+++ b/GnucashMobile/res/xml/fragment_general_preferences.xml
@@ -29,7 +29,7 @@
             android:inputType="textEmailAddress"/>
         <CheckBoxPreference android:summary="@string/hint_export_choice" android:key="@string/key_export_all_transactions" android:title="@string/title_export_all_transactions"/>
         <CheckBoxPreference android:summary="@string/hint_delete_after_export" android:key="@string/key_delete_transactions_after_export" android:title="@string/title_always_delete_exported_transactions"/>
-        <CheckBoxPreference android:title="@string/title_sgml_ofx_header" android:key="@string/key_sgml_ofx_header" android:summary="@string/summary_sgml_ofx_header"/>
+        <CheckBoxPreference android:key="@string/key_xml_ofx_header" android:summary="@string/summary_xml_ofx_header" android:title="@string/title_xml_ofx_header"/>
         
     </PreferenceCategory>
     
diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index f7161cbc..f5c5b5a7 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -145,7 +145,7 @@ protected String generateUID(){
 		}
 		
 		uuid = uuid.substring(uuid.lastIndexOf("-"));
-		String name = mName.toLowerCase(Locale.US).replace(" ", "-");
+		String name = mName.replaceAll("[^A-Za-z0-9]", "").toLowerCase(Locale.US);
 		if (name.length() > 9)
 			name = name.substring(0, 10);
 		uuid = name + uuid;		
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
index 37377c5c..fd248ad3 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
@@ -23,6 +23,7 @@
 import org.gnucash.android.R;
 import org.gnucash.android.data.Account;
 import org.gnucash.android.data.Money;
+import org.gnucash.android.data.Account.AccountType;
 import org.gnucash.android.db.AccountsDbAdapter;
 import org.gnucash.android.ui.transactions.TransactionsActivity;
 import org.gnucash.android.ui.transactions.TransactionsListFragment;
@@ -192,7 +193,33 @@ public void onClick(DialogInterface dialog, int which) {
 				String[] defaultAccounts = getResources().getStringArray(R.array.default_accounts);
 				for (int index : mSelectedDefaultAccounts) {
 					String name = defaultAccounts[index];
-					dbAdapter.addAccount(new Account(name));
+					Account account = new Account(name);
+					
+					//these indices are bound to the order in which the accounts occur in strings.xml
+					switch (index) {
+					case 0:
+						account.setAccountType(AccountType.EXPENSE);
+						break;
+						
+					case 1:
+						account.setAccountType(AccountType.INCOME);
+						break;
+						
+					case 2:
+						account.setAccountType(AccountType.ASSET);
+						break;
+					case 3:
+						account.setAccountType(AccountType.EQUITY);
+						break;
+					case 4:
+						account.setAccountType(AccountType.LIABILITY);
+						break;
+						
+					default:
+						account.setAccountType(AccountType.CASH);
+						break;
+					}
+					dbAdapter.addAccount(account);
 				}
 				
 				dbAdapter.close();
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
index a64476cb..d78c0f3e 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/ExportDialogFragment.java
@@ -234,11 +234,13 @@ private void writeToExternalStorage(Document doc) throws IOException{
 		
 //		FileWriter writer = new FileWriter(file);
 		BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(file), "UTF-8"));
-		boolean useSgmlHeader = PreferenceManager.getDefaultSharedPreferences(getActivity())
-				.getBoolean(getString(R.string.key_sgml_ofx_header), false);
+		boolean useXmlHeader = PreferenceManager.getDefaultSharedPreferences(getActivity())
+				.getBoolean(getString(R.string.key_xml_ofx_header), false);
 
 		//if we want SGML OFX headers, write first to string and then prepend header
-		if (useSgmlHeader){
+		if (useXmlHeader){
+			write(doc, writer, false);
+		} else {			
 			Node ofxNode = doc.getElementsByTagName("OFX").item(0);
 			StringWriter stringWriter = new StringWriter();
 			write(ofxNode, stringWriter, true);
@@ -246,8 +248,6 @@ private void writeToExternalStorage(Document doc) throws IOException{
 			StringBuffer stringBuffer = new StringBuffer(OfxFormatter.OFX_SGML_HEADER);
 			stringBuffer.append('\n');
 			writer.write(stringBuffer.toString() + stringWriter.toString());
-		} else {
-			write(doc, writer, false);
 		}
 		
 		writer.flush();

From 941ee23f3f004ee6561b301fdc951ecfa7e02b7b Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Fri, 18 Jan 2013 00:38:29 +0100
Subject: [PATCH 16/27] Add support for parent accounts in Intent account
 creation Sealed Money class to enforce immutability Code refactoring

---
 GnucashMobile/res/values-es/strings.xml                          | 4 ++--
 GnucashMobile/src/org/gnucash/android/data/Account.java          | 9 ++++++++-
 GnucashMobile/src/org/gnucash/android/data/Money.java            | 2 +-
 GnucashMobile/src/org/gnucash/android/data/Transaction.java      | 2 +-
 .../src/org/gnucash/android/receivers/AccountCreator.java        | 6 +++---
 .../gnucash/android/ui/transactions/NewTransactionFragment.java  | 2 --
 6 files changed, 15 insertions(+), 10 deletions(-)

diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 117933b3..9df3595d 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
- Copyright (c) 2013 Ngewi Fet <ngewif@gmail.com>
- Copyright (c) 2013 Jorge Martnez Lpez <jorgeml@gmail.com>
+ Copyright (c) 2012 - 2013 Ngewi Fet <ngewif@gmail.com>
+ Copyright (c) 2012 - 2013 Jorge Martnez Lpez <jorgeml@gmail.com>
  
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
diff --git a/GnucashMobile/src/org/gnucash/android/data/Account.java b/GnucashMobile/src/org/gnucash/android/data/Account.java
index 066556d4..46bb0ecd 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Account.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Account.java
@@ -84,7 +84,7 @@
 	private List<Transaction> mTransactionsList = new ArrayList<Transaction>();
 
 	/**
-	 * Account UID of the parent account
+	 * Account UID of the parent account. Can be null
 	 */
 	private String mParentAccountUID;
 
@@ -94,6 +94,12 @@
 	public static final String EXTRA_CURRENCY_CODE 	= "org.gnucash.android.extra.currency_code";
 	
 	/**
+	 * Extra key for passing the unique ID of the parent account when creating a 
+	 * new account using Intents
+	 */
+	public static final String EXTRA_PARENT_UID 	= "org.gnucash.android.extra.parent_uid";
+	
+	/**
 	 * Constructor
 	 * Creates a new account with the default currency and a generated unique ID
 	 * @param name Name of the account
@@ -317,6 +323,7 @@ public String getParentUID() {
 	public static OfxAccountType convertToOfxAccountType(AccountType accountType){
 		switch (accountType) {
 		case CREDIT_CARD:
+		case LIABILITY:
 			return OfxAccountType.CREDITLINE;
 			
 		case CASH:
diff --git a/GnucashMobile/src/org/gnucash/android/data/Money.java b/GnucashMobile/src/org/gnucash/android/data/Money.java
index 6fa96fa0..4d69cc50 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Money.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Money.java
@@ -38,7 +38,7 @@
  * @author Ngewi Fet<ngewif@gmail.com>
  *
  */
-public class Money implements Comparable<Money>{
+public final class Money implements Comparable<Money>{
 
 	/**
 	 * Currency of the account
diff --git a/GnucashMobile/src/org/gnucash/android/data/Transaction.java b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
index be2968c5..50ce5743 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Transaction.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
@@ -98,7 +98,7 @@
 	private int mIsExported = 0;
 	
 	/**
-	 * Timestamp when this transaction occured
+	 * Timestamp when this transaction occurred
 	 */
 	private long mTimestamp;
 	
diff --git a/GnucashMobile/src/org/gnucash/android/receivers/AccountCreator.java b/GnucashMobile/src/org/gnucash/android/receivers/AccountCreator.java
index 7c02c9f2..0fa57e46 100644
--- a/GnucashMobile/src/org/gnucash/android/receivers/AccountCreator.java
+++ b/GnucashMobile/src/org/gnucash/android/receivers/AccountCreator.java
@@ -44,16 +44,16 @@ public void onReceive(Context context, Intent intent) {
 		Log.i("Gnucash", "Received account creation intent");
 		Bundle args = intent.getExtras();		
 		
-		String uid = args.getString(Intent.EXTRA_UID);
-		
 		Account account = new Account(args.getString(Intent.EXTRA_TITLE));
-		String currencyCode = args.getString(Account.EXTRA_CURRENCY_CODE);
+		account.setParentUID(args.getString(Account.EXTRA_PARENT_UID));
 		
+		String currencyCode = args.getString(Account.EXTRA_CURRENCY_CODE);				
 		if (currencyCode != null){
 			Currency currency = Currency.getInstance(currencyCode);
 			account.setCurrency(currency);
 		}
 		
+		String uid = args.getString(Intent.EXTRA_UID);
 		if (uid != null)
 			account.setUID(uid);
 		
diff --git a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
index 1101ff67..a620fb20 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/transactions/NewTransactionFragment.java
@@ -228,8 +228,6 @@ public void onActivityCreated(Bundle savedInstanceState) {
 		mTransactionId = getArguments().getLong(SELECTED_TRANSACTION_ID);
 		mTransactionsDbAdapter = new TransactionsDbAdapter(getActivity());
 		mTransaction = mTransactionsDbAdapter.getTransaction(mTransactionId);
-				
-		mAccountsDbAdapter = new AccountsDbAdapter(getActivity());
 		
 		setListeners();
 		if (mTransaction == null)

From d18d15b8875fea9734aa363c5a42d54b1d00cb8c Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Sat, 19 Jan 2013 01:15:42 +0100
Subject: [PATCH 17/27] Updated strings to be translated

---
 GnucashMobile/res/values-de/strings.xml     | 14 +++++++++++---
 GnucashMobile/res/values-el/strings.xml     | 12 ++++++++++--
 GnucashMobile/res/values-es-rMX/strings.xml | 12 ++++++++++--
 GnucashMobile/res/values-es/strings.xml     | 15 ++++++++++++---
 GnucashMobile/res/values-fr/strings.xml     | 12 ++++++++++--
 GnucashMobile/res/values-hu/strings.xml     | 14 +++++++++++---
 GnucashMobile/res/values-it/strings.xml     | 12 ++++++++++--
 GnucashMobile/res/values-nb/strings.xml     | 12 ++++++++++--
 GnucashMobile/res/values-nl/strings.xml     | 12 ++++++++++--
 GnucashMobile/res/values-pt-rBR/strings.xml | 12 ++++++++++--
 GnucashMobile/res/values-ru/strings.xml     | 12 ++++++++++--
 GnucashMobile/res/values/strings.xml        | 12 ++++++------
 12 files changed, 120 insertions(+), 31 deletions(-)

diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index fdc513a9..e85303de 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -293,9 +293,17 @@
 	<string name="delete_all_transactions_confirmation_message">Wollen Sie wirklich ALLE Buchungen l&#246;schen?</string>
 	<string name="delete_transaction_confirmation_message">Wollen Sie wirklich diese Buchung l&#246;schen?</string>	
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
-	<string name="toast_no_account_name_entered">Bitte tragen Sie einen Kontoname ein</string>
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index f5e3341a..48aff993 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -299,9 +299,17 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>		
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
diff --git a/GnucashMobile/res/values-es-rMX/strings.xml b/GnucashMobile/res/values-es-rMX/strings.xml
index 6b3f27c9..b9393d96 100644
--- a/GnucashMobile/res/values-es-rMX/strings.xml
+++ b/GnucashMobile/res/values-es-rMX/strings.xml
@@ -292,9 +292,17 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 9df3595d..9a9dd363 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -293,8 +293,17 @@
 	<string name="delete_all_transactions_confirmation_message">&#191;Borrar TODAS las transacciones?</string>
 	<string name="delete_transaction_confirmation_message">&#191;Borrar esta transacci&#243;n?</string>
 	<string name="title_export_preference_category">Exportaci&#243;n</string>
-	<string name="title_export_all_transactions">Exportar siempre todas las transacciones</string>
-	<string name="title_always_delete_exported_transactions">Borrar siempre todas las transacciones exportadas</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Correo electr&#243;nico por defecto para exportar</string>
-	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Se puede cambiar en cada exportaci&#243;n.</string>	
+	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Se puede cambiar en cada exportaci&#243;n.</string>
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>	
 </resources>
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index f5fc18f4..70093a8d 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -293,9 +293,17 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-hu/strings.xml b/GnucashMobile/res/values-hu/strings.xml
index d95128d1..948dee40 100644
--- a/GnucashMobile/res/values-hu/strings.xml
+++ b/GnucashMobile/res/values-hu/strings.xml
@@ -292,9 +292,17 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
-	<string name="toast_no_account_name_entered">Please enter an account name</string>	
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
+	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>	
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index 00c3b7de..c821526c 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -293,9 +293,17 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
diff --git a/GnucashMobile/res/values-nb/strings.xml b/GnucashMobile/res/values-nb/strings.xml
index 1857a6eb..3636e63d 100644
--- a/GnucashMobile/res/values-nb/strings.xml
+++ b/GnucashMobile/res/values-nb/strings.xml
@@ -296,9 +296,17 @@ format og importeres i regnskapsprogrammet GnuCash for PC.</string>
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
diff --git a/GnucashMobile/res/values-nl/strings.xml b/GnucashMobile/res/values-nl/strings.xml
index 704c1176..335c2630 100644
--- a/GnucashMobile/res/values-nl/strings.xml
+++ b/GnucashMobile/res/values-nl/strings.xml
@@ -293,9 +293,17 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index 0823abed..b1a8f890 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -292,9 +292,17 @@
   <string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
   <string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
   <string name="title_export_preference_category">Export</string>
-  <string name="title_export_all_transactions">Always export all transactions</string>
-  <string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+  <string name="title_export_all_transactions">Export all transactions</string>
+  <string name="title_always_delete_exported_transactions">Delete exported transactions</string>
   <string name="title_default_export_email">Default export email</string>
   <string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>  
+ 	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index 78796349..6c564385 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -293,9 +293,17 @@
 	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
+	<string name="label_account_currency">Currency</string>
+	<string name="label_parent_account">Parent account</string>
+	<string name="title_xml_ofx_header">Use XML OFX header</string>
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 53f65136..423d08c2 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -481,21 +481,21 @@
 	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
 	<string name="title_export_preference_category">Export</string>
 	<string name="key_export_all_transactions">export_all_transactions</string>
-	<string name="title_export_all_transactions">Always export all transactions</string>
+	<string name="title_export_all_transactions">Export all transactions</string>
 	<string name="key_delete_transactions_after_export">delete_transactions_after_export</string>
-	<string name="title_always_delete_exported_transactions">Always delete all exported transactions</string>
+	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
 	<string name="key_default_export_email">export_email_target</string>
 	<string name="title_default_export_email">Default export email</string>
 	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
-	<string name="label_double_entry_account">Transfer to</string>
-	<string name="key_use_double_entry">use_double_entry</string>
-	<string name="summary_use_double_entry">All transactions will involve two accounts: source and destination accounts</string>
+	<string name="key_use_double_entry">use_double_entry</string>	
+	<string name="key_xml_ofx_header">xml_ofx_header</string>
+	<string name="label_double_entry_account">Transfer Account</string>
+	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
 	<string name="title_use_double_entry">Activate Double Entry</string>
 	<string name="account_balance">Balance</string>
 	<string name="toast_no_account_name_entered">Please enter an account name</string>
 	<string name="label_account_currency">Currency</string>
 	<string name="label_parent_account">Parent account</string>
-	<string name="key_xml_ofx_header">xml_ofx_header</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
 </resources>

From cafe6c3fdfdb17c8e21ee4d2f2a367532a8dfd84 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 23 Jan 2013 21:24:23 +0100
Subject: [PATCH 18/27] Added What's new dialog for new feature releases

---
 GnucashMobile/res/values-de/strings.xml            |   9 +
 GnucashMobile/res/values-el/strings.xml            |   9 +
 GnucashMobile/res/values-es-rMX/strings.xml        |   9 +
 GnucashMobile/res/values-es/strings.xml            |  11 +-
 GnucashMobile/res/values-fr/strings.xml            |   9 +
 GnucashMobile/res/values-hu/strings.xml            |  11 +-
 GnucashMobile/res/values-it/strings.xml            |   9 +
 GnucashMobile/res/values-nb/strings.xml            |   9 +
 GnucashMobile/res/values-nl/strings.xml            |   9 +
 GnucashMobile/res/values-pt-rBR/strings.xml        | 587 +++++++++++----------
 GnucashMobile/res/values-ru/strings.xml            |   9 +
 GnucashMobile/res/values/strings.xml               |  10 +
 .../android/ui/accounts/AccountsActivity.java      |  53 +-
 13 files changed, 451 insertions(+), 293 deletions(-)

diff --git a/GnucashMobile/res/values-de/strings.xml b/GnucashMobile/res/values-de/strings.xml
index e85303de..afc7b5ba 100644
--- a/GnucashMobile/res/values-de/strings.xml
+++ b/GnucashMobile/res/values-de/strings.xml
@@ -306,4 +306,13 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index 48aff993..d91ab519 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -312,4 +312,13 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
diff --git a/GnucashMobile/res/values-es-rMX/strings.xml b/GnucashMobile/res/values-es-rMX/strings.xml
index b9393d96..255d9be8 100644
--- a/GnucashMobile/res/values-es-rMX/strings.xml
+++ b/GnucashMobile/res/values-es-rMX/strings.xml
@@ -305,4 +305,13 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index 9a9dd363..d69ef110 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -305,5 +305,14 @@
 	<string name="label_account_currency">Currency</string>
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
-	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>	
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>	
 </resources>
diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index 70093a8d..14c6dee3 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -306,4 +306,13 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-hu/strings.xml b/GnucashMobile/res/values-hu/strings.xml
index 948dee40..b9d5486c 100644
--- a/GnucashMobile/res/values-hu/strings.xml
+++ b/GnucashMobile/res/values-hu/strings.xml
@@ -304,5 +304,14 @@
 	<string name="label_account_currency">Currency</string>
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
-	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>	
+	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>	
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index c821526c..718db92a 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -306,4 +306,13 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
diff --git a/GnucashMobile/res/values-nb/strings.xml b/GnucashMobile/res/values-nb/strings.xml
index 3636e63d..181de6d1 100644
--- a/GnucashMobile/res/values-nb/strings.xml
+++ b/GnucashMobile/res/values-nb/strings.xml
@@ -309,4 +309,13 @@ format og importeres i regnskapsprogrammet GnuCash for PC.</string>
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
diff --git a/GnucashMobile/res/values-nl/strings.xml b/GnucashMobile/res/values-nl/strings.xml
index 335c2630..76673b99 100644
--- a/GnucashMobile/res/values-nl/strings.xml
+++ b/GnucashMobile/res/values-nl/strings.xml
@@ -306,4 +306,13 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index b1a8f890..df7526cc 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -16,293 +16,302 @@
  limitations under the License.
 -->
 <resources>
-  <string name="app_name">GnuCash</string>
-  <string name="title_add_account">Criar Conta</string>
-  <string name="title_edit_account">Editar Conta</string>
-  <string name="info_details">Info</string>
-  <string name="title_settings">Configuraes</string>
-  <string name="menu_export_ofx">Exportar OFX</string>
-  <string name="description_add_transaction_icon">Adicionar nova transao para uma conta</string>
-  <string name="label_no_accounts">Sem contas para apresentar</string>
-  <string name="label_account_name">Nome da conta</string>
-  <string name="btn_cancel">Cancelar</string>
-  <string name="btn_save">Salvar</string>
-  <string name="label_no_transactions_to_display">Sem transaes para apresentar</string>
-  <string name="label_transaction_name">Descrio</string>
-  <string name="label_transaction_amount">Valor</string>
-  <string name="title_add_transaction">Nova transao</string>
-  <string name="label_no_transactions">Sem transaes para apresentar</string>
-  <string name="label_timeanddate">DATA &amp; HORA</string>
-  <string name="label_account">Conta</string>
-  <string name="label_debit">DBITO</string>
-  <string name="label_credit">CRDITO</string>
-  <string name="title_accounts">Contas</string>
-  <string name="title_transactions">Transaes</string>
-  <string name="menu_delete">DELETAR</string>
-  <string name="alert_dialog_ok_delete">Deletar</string>
-  <string name="alert_dialog_cancel">Cancelar</string>
-  <string name="toast_account_deleted">Conta deletada</string>
-  <string name="title_confirm_delete">Confirmao excluso</string>
-  <string name="delete_account_confirmation_message">Todas as transaes nesta conta tambm sero deletadas</string>
-  <string name="title_edit_transaction">Editar Transao</string>
-  <string name="label_transaction_description">Nota</string>
-  <string name="menu_move">MOVER</string>
-  <string name="title_selected">%1$d selecionado</string>
-  <string name="label_transactions_total">Total:</string>
-  <string name="label_export_destination">Exportar para:</string>
-  <string name="title_export_dialog">Exportar OFX</string>
-  <string name="option_export_all_transactions">Exportar todas as transaes</string>
-  <string name="hint_export_choice">Por padro, s sero exportadas as transaes criadas aps o ltimo procedimento de exportar. Selecionar essa opo para exportar todas as transaes.</string>
-  <string name="error_exporting">Erro ao exportar os dados OFX</string>
-  <string name="btn_export">Exportar</string>
-  <string name="option_delete_after_export">Deletar aps exportar</string>
-  <string name="hint_delete_after_export">Todas as transao exportadas sero deletadas aps completar o procedimento de exportar.</string>
-  <string name="title_settings">Configuraes</string>
-  <string-array name="export_destinations">
-    <item>Compartilhar arquivo</item>
-    <item>Carto SD</item>
-  </string-array>
-  <string name="btn_move">Mover</string>
-  <string name="title_move_transactions">Mover %1$d transao(es)</string>
-  <string name="label_move_destination">Conta de destino</string>
-  <string name="permission_access_sdcard">Acessar carto SD</string>
-  <string name="title_share_ofx_with">Compartilhar OFX exportado com&#8230;</string>
-  <string name="toast_incompatible_currency">No  possvel mover as transaes. \nA conta de destino usa uma moeda padro diferente da moeda usada pela conta de origem.</string>
-  <string name="header_general_settings">Geral</string>
-  <string name="header_about_gnucash">Sobre</string>
-  <string name="title_choose_currency">Escolher moeda padro</string>
-  <string name="title_default_currency">Moeda padro</string>
-  <string name="summary_default_currency">Moeda padro para novas contas</string>
-  <string name="label_permission_record_transactions">Habilitar gravao de transao no GnuCash para Android</string>
-  <string name="label_permission_create_accounts">Habilitar a criao de contas no GnuCash para Android</string>
-  <string name="label_permission_group">Seu arquivo GnuCash</string>
-  <string name="description_permission_group">Ler e modificar o arquivo GnuCash</string>
-  <string name="label_permission_record_transaction">gravar transaes</string>
-  <string name="label_permission_create_account">criar contas</string>
-  <string name="label_display_account">Mostrar conta</string>
-  <string name="btn_create_accounts">Criar Contas</string>
-  <string name="title_default_accounts">Selecionar contas para criar</string>
-  <string-array name="currency_names">
-    <item>Afegane</item>
-    <item>Dinar Argelino</item>
-    <item>Peso Argentino</item>
-    <item>Dram Armeniano</item>
-    <item>Florim de Aruba</item>
-    <item>Dlar Australiano</item>
-    <item>Manat Azerbaijo</item>
-    <item>Dlar Bahamas</item>
-    <item>Dinar de Bahrein</item>
-    <item>Bath Tailandez</item>
-    <item>Balboa</item>
-    <item>Dlar de Barbados</item>
-    <item>Rublo Belarus</item>
-    <item>Dlar de Belize</item>
-    <item>Dlar de Bermudas</item>
-    <item>Bolivar Forte</item>
-    <item>Boliviano</item>
-    <item>Real Brasileiro</item>
-    <item>Dlar de Brunei</item>
-    <item>Lev Blgaro</item>
-    <item>Franco de Burundi</item>
-    <item>Dlar Canadense</item>
-    <item>Escudo de Cabo Verde</item>
-    <item>Dlar das Ilhas Cayman</item>
-    <item>Franco CFA BCEAO</item>
-    <item>Franco CFA BEAC</item>
-    <item>Franco CFP</item>
-    <item>Peso Chileno</item>
-    <item>Cotao de teste</item>
-    <item>Peso Colombiano</item>
-    <item>Franco de Comores</item>
-    <item>Franco Congoles</item>
-    <item>Marco Conversvel</item>
-    <item>Ouro Cordoba</item>
-    <item>Colon de Costa Rica</item>
-    <item>Kuna Croata</item>
-    <item>Peso Cubano</item>
-    <item>Coroa Tcheca</item>
-    <item>Dalasi</item>
-    <item>Coroa da Dinamarca</item>
-    <item>Dinar Macedonia</item>
-    <item>Franco de Djibuti</item>
-    <item>Dobra de So Tome e Principe</item>
-    <item>Peso Dominicano</item>
-    <item>Dongue</item>
-    <item>Dlar do Caribe Oriental</item>
-    <item>Libra Egpcia</item>
-    <item>Colon de El Salvador</item>
-    <item>Birr da Etiopia</item>
-    <item>Euro</item>
-    <item>Libra das Ilhas Falkland</item>
-    <item>Dlar Fiji</item>
-    <item>Forint</item>
-    <item>Cedi de Gana</item>
-    <item>Libra de Gibraltar</item>
-    <item>Ouro</item>
-    <item>Gourde Haitiano</item>
-    <item>Guarani</item>
-    <item>Franco de Guine</item>
-    <item>Dlar da Guiana</item>
-    <item>Dlar de Hong Kong</item>
-    <item>Hryvnia</item>
-    <item>Coroa da Islandia</item>
-    <item>Rupia Indiana</item>
-    <item>Rial Iraniano</item>
-    <item>Dinar Iraquiano</item>
-    <item>Dlar Jamaicano</item>
-    <item>Dinar Jordaniano</item>
-    <item>Xelim do Quenia</item>
-    <item>Kina</item>
-    <item>Quipe</item>
-    <item>Dinar Kwait</item>
-    <item>Quacha</item>
-    <item>Kwanza</item>
-    <item>Quiate</item>
-    <item>Lari</item>
-    <item>Lat da Letonia</item>
-    <item>Libra do Lbano</item>
-    <item>Lek</item>
-    <item>Lempira</item>
-    <item>Leone</item>
-    <item>Dlar Liberiano</item>
-    <item>Dinar Libia</item>
-    <item>Lilangeni</item>
-    <item>Lita da Lituania</item>
-    <item>Loti</item>
-    <item>Ariary de Madagascar</item>
-    <item>Ringgit da Malasia</item>
-    <item>Rupia de Mauricio</item>
-    <item>Peso Mexicano</item>
-    <item>Unidade Mexicana de Inverso</item>
-    <item>Leu da Moldvia</item>
-    <item>Dirham de Marrocos</item>
-    <item>Nova Metical de Moambique</item>
-    <item>Mvdol</item>
-    <item>Naira</item>
-    <item>Nakfa</item>
-    <item>Dlar da Nambia</item>
-    <item>Rupia do Nepal</item>
-    <item>Florim das Antilhas Holandesas</item>
-    <item>Shequl Israelense</item>
-    <item>Novo Leu Romeno</item>
-    <item>Novo Dlar Taiwanes</item>
-    <item>Dlar Neozelands</item>
-    <item>Ngultrum</item>
-    <item>Won Norte Koreano</item>
-    <item>Krone Noruegues</item>
-    <item>Novo Sol</item>
-    <item>Uguia</item>
-    <item>Paanga</item>
-    <item>Rupia do Paquisto</item>
-    <item>Paladio</item>
-    <item>Pataca</item>
-    <item>Peso conversvel</item>
-    <item>Peso Uruguaio</item>
-    <item>Peso Filipino</item>
-    <item>Platina</item>
-    <item>Libra Esterlina</item>
-    <item>Pula</item>
-    <item>Rial do Catar</item>
-    <item>Quetzal</item>
-    <item>Rande</item>
-    <item>Rial de Om</item>
-    <item>Riel</item>
-    <item>Rufia</item>
-    <item>Rupia da Indonesia</item>
-    <item>Rublo Russo</item>
-    <item>Franco de Ruanda</item>
-    <item>Libra de Santa Helena</item>
-    <item>Rial da Arbia Saudita</item>
-    <item>Direito especial</item>
-    <item>Dinar Srvio</item>
-    <item>Rupia de Seycheles</item>
-    <item>Prata</item>
-    <item>Dlar de Cingapura</item>
-    <item>Dlar das Ilhas Salomo</item>
-    <item>Som Quirguisto</item>
-    <item>Xelim da Somlia</item>
-    <item>Somoni</item>
-    <item>Libra Sul Sudanesa</item>
-    <item>Rupia do Sri Lanka</item>
-    <item>Sucre</item>
-    <item>Nova Libra Sudanesa</item>
-    <item>Dlar do Suriname</item>
-    <item>Coroa Sueca</item>
-    <item>Franco Suio</item>
-    <item>Libra Siria</item>
-    <item>Taca</item>
-    <item>Tala</item>
-    <item>Xelim da Tanzania</item>
-    <item>Tenge</item>
-    <item>Sem moeda</item>
-    <item>Dlar de Trinidad e Tobago</item>
-    <item>Tugrik</item>
-    <item>Dinar Tunisiano</item>
-    <item>Nova Lira Turca</item>
-    <item>Novo Manat Turcomenisto</item>
-    <item>Dirham EAU</item>
-    <item>Xelim de Uganda</item>
-    <item>UIC-Franc</item>
-    <item>Unidade de Valor Real</item>
-    <item>unidades de fomento</item>
-    <item>Uruguai Peso em Unidades Indexadas</item>
-    <item>Dlar dos EUA</item>
-    <item>Som do Uzbequisto</item>
-    <item>Vatu</item>
-    <item>WIR Euro</item>
-    <item>WIR Franc</item>
-    <item>Won Sul Coreano</item>
-    <item>Rial de Iemen</item>
-    <item>Iene</item>
-    <item>Renmimbi de Iuan</item>
-    <item>Quacha do Zambia</item>
-    <item>Dlar do Zimbabue</item>
-    <item>Zloty</item>
-  </string-array>
-  <string-array name="default_accounts">
-    <item>Despesas</item>
-    <item>Receitas</item>
-    <item>Ativos</item>
-    <item>Equity</item>
-	<item>Liabilities</item>
-  </string-array>
-  <string name="error_no_accounts">No existem contas no GnuCash.\nCriar uma conta antes de adicionar um widget</string>
-  <string name="title_build_version">Verso de compilao</string>
-  <string name="title_license">Licena</string>
-  <string name="summary_licence_details">Apache License v2.0. Clique para mais detalhes</string>
-  <string name="title_general_prefs">Preferncias Gerais</string>
-  <string name="label_widget_configuration">Selecionar Conta</string>
-  <string name="toast_no_transactions_to_export">No existem transaes disponveis para exportar</string>
-  <string name="title_about_gnucash">Sobre o GnuCash</string>
-  <string name="summary_about_gnucash">GnuCash  um aplicativo para controle de despesas no Android.\nEle proporciona uma forma flexvel de registrar despesas on-the-go, que podem ser exportadas para o formato Open Financial eXchange (OFX) e importadas para o Gnucash para desktop.</string>
-  <string name="title_about">Sobre</string>
-  <string name="toast_error_exporting">No foi possvel gravar o arquivo OFX em :\n</string>
-  <string name="toast_ofx_exported_to">Arquivo OFX exportado para:\n</string>
-  <string name="title_export_email">Exportar GnuCash OFX</string>
-  <string name="description_export_email">Exportar GnuCash OFX de</string>
-  <string name="header_transaction_settings">Transaes</string>
-  <string name="title_transaction_preferences">Preferncias para Transaes</string>
-  <string name="title_account_preferences">Preferncias para Contas</string>
-  <string name="title_default_transaction_type">Tipo de Transao Padro</string>
-  <string name="summary_default_transaction_type">O tipo de transao a ser usada por padro, CRDITO ou DBITO</string>
-  <string-array name="transaction_types">
-    <item>CRDITO</item>
-    <item>DBITO</item>
-  </string-array>
-  <string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-  <string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
-  <string name="title_export_preference_category">Export</string>
-  <string name="title_export_all_transactions">Export all transactions</string>
-  <string name="title_always_delete_exported_transactions">Delete exported transactions</string>
-  <string name="title_default_export_email">Default export email</string>
-  <string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>  
- 	<string name="label_double_entry_account">Transfer Account</string>
-	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
-	<string name="title_use_double_entry">Activate Double Entry</string>
-	<string name="account_balance">Balance</string>
-	<string name="toast_no_account_name_entered">Please enter an account name</string>
-	<string name="label_account_currency">Currency</string>
-	<string name="label_parent_account">Parent account</string>
-	<string name="title_xml_ofx_header">Use XML OFX header</string>
-	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	  <string name="app_name">GnuCash</string>
+	  <string name="title_add_account">Criar Conta</string>
+	  <string name="title_edit_account">Editar Conta</string>
+	  <string name="info_details">Info</string>
+	  <string name="title_settings">Configuraes</string>
+	  <string name="menu_export_ofx">Exportar OFX</string>
+	  <string name="description_add_transaction_icon">Adicionar nova transao para uma conta</string>
+	  <string name="label_no_accounts">Sem contas para apresentar</string>
+	  <string name="label_account_name">Nome da conta</string>
+	  <string name="btn_cancel">Cancelar</string>
+	  <string name="btn_save">Salvar</string>
+	  <string name="label_no_transactions_to_display">Sem transaes para apresentar</string>
+	  <string name="label_transaction_name">Descrio</string>
+	  <string name="label_transaction_amount">Valor</string>
+	  <string name="title_add_transaction">Nova transao</string>
+	  <string name="label_no_transactions">Sem transaes para apresentar</string>
+	  <string name="label_timeanddate">DATA &amp; HORA</string>
+	  <string name="label_account">Conta</string>
+	  <string name="label_debit">DBITO</string>
+	  <string name="label_credit">CRDITO</string>
+	  <string name="title_accounts">Contas</string>
+	  <string name="title_transactions">Transaes</string>
+	  <string name="menu_delete">DELETAR</string>
+	  <string name="alert_dialog_ok_delete">Deletar</string>
+	  <string name="alert_dialog_cancel">Cancelar</string>
+	  <string name="toast_account_deleted">Conta deletada</string>
+	  <string name="title_confirm_delete">Confirmao excluso</string>
+	  <string name="delete_account_confirmation_message">Todas as transaes nesta conta tambm sero deletadas</string>
+	  <string name="title_edit_transaction">Editar Transao</string>
+	  <string name="label_transaction_description">Nota</string>
+	  <string name="menu_move">MOVER</string>
+	  <string name="title_selected">%1$d selecionado</string>
+	  <string name="label_transactions_total">Total:</string>
+	  <string name="label_export_destination">Exportar para:</string>
+	  <string name="title_export_dialog">Exportar OFX</string>
+	  <string name="option_export_all_transactions">Exportar todas as transaes</string>
+	  <string name="hint_export_choice">Por padro, s sero exportadas as transaes criadas aps o ltimo procedimento de exportar. Selecionar essa opo para exportar todas as transaes.</string>
+	  <string name="error_exporting">Erro ao exportar os dados OFX</string>
+	  <string name="btn_export">Exportar</string>
+	  <string name="option_delete_after_export">Deletar aps exportar</string>
+	  <string name="hint_delete_after_export">Todas as transao exportadas sero deletadas aps completar o procedimento de exportar.</string>
+	  <string name="title_settings">Configuraes</string>
+	  <string-array name="export_destinations">
+	    <item>Compartilhar arquivo</item>
+	    <item>Carto SD</item>
+	  </string-array>
+	  <string name="btn_move">Mover</string>
+	  <string name="title_move_transactions">Mover %1$d transao(es)</string>
+	  <string name="label_move_destination">Conta de destino</string>
+	  <string name="permission_access_sdcard">Acessar carto SD</string>
+	  <string name="title_share_ofx_with">Compartilhar OFX exportado com&#8230;</string>
+	  <string name="toast_incompatible_currency">No  possvel mover as transaes. \nA conta de destino usa uma moeda padro diferente da moeda usada pela conta de origem.</string>
+	  <string name="header_general_settings">Geral</string>
+	  <string name="header_about_gnucash">Sobre</string>
+	  <string name="title_choose_currency">Escolher moeda padro</string>
+	  <string name="title_default_currency">Moeda padro</string>
+	  <string name="summary_default_currency">Moeda padro para novas contas</string>
+	  <string name="label_permission_record_transactions">Habilitar gravao de transao no GnuCash para Android</string>
+	  <string name="label_permission_create_accounts">Habilitar a criao de contas no GnuCash para Android</string>
+	  <string name="label_permission_group">Seu arquivo GnuCash</string>
+	  <string name="description_permission_group">Ler e modificar o arquivo GnuCash</string>
+	  <string name="label_permission_record_transaction">gravar transaes</string>
+	  <string name="label_permission_create_account">criar contas</string>
+	  <string name="label_display_account">Mostrar conta</string>
+	  <string name="btn_create_accounts">Criar Contas</string>
+	  <string name="title_default_accounts">Selecionar contas para criar</string>
+	  <string-array name="currency_names">
+	    <item>Afegane</item>
+	    <item>Dinar Argelino</item>
+	    <item>Peso Argentino</item>
+	    <item>Dram Armeniano</item>
+	    <item>Florim de Aruba</item>
+	    <item>Dlar Australiano</item>
+	    <item>Manat Azerbaijo</item>
+	    <item>Dlar Bahamas</item>
+	    <item>Dinar de Bahrein</item>
+	    <item>Bath Tailandez</item>
+	    <item>Balboa</item>
+	    <item>Dlar de Barbados</item>
+	    <item>Rublo Belarus</item>
+	    <item>Dlar de Belize</item>
+	    <item>Dlar de Bermudas</item>
+	    <item>Bolivar Forte</item>
+	    <item>Boliviano</item>
+	    <item>Real Brasileiro</item>
+	    <item>Dlar de Brunei</item>
+	    <item>Lev Blgaro</item>
+	    <item>Franco de Burundi</item>
+	    <item>Dlar Canadense</item>
+	    <item>Escudo de Cabo Verde</item>
+	    <item>Dlar das Ilhas Cayman</item>
+	    <item>Franco CFA BCEAO</item>
+	    <item>Franco CFA BEAC</item>
+	    <item>Franco CFP</item>
+	    <item>Peso Chileno</item>
+	    <item>Cotao de teste</item>
+	    <item>Peso Colombiano</item>
+	    <item>Franco de Comores</item>
+	    <item>Franco Congoles</item>
+	    <item>Marco Conversvel</item>
+	    <item>Ouro Cordoba</item>
+	    <item>Colon de Costa Rica</item>
+	    <item>Kuna Croata</item>
+	    <item>Peso Cubano</item>
+	    <item>Coroa Tcheca</item>
+	    <item>Dalasi</item>
+	    <item>Coroa da Dinamarca</item>
+	    <item>Dinar Macedonia</item>
+	    <item>Franco de Djibuti</item>
+	    <item>Dobra de So Tome e Principe</item>
+	    <item>Peso Dominicano</item>
+	    <item>Dongue</item>
+	    <item>Dlar do Caribe Oriental</item>
+	    <item>Libra Egpcia</item>
+	    <item>Colon de El Salvador</item>
+	    <item>Birr da Etiopia</item>
+	    <item>Euro</item>
+	    <item>Libra das Ilhas Falkland</item>
+	    <item>Dlar Fiji</item>
+	    <item>Forint</item>
+	    <item>Cedi de Gana</item>
+	    <item>Libra de Gibraltar</item>
+	    <item>Ouro</item>
+	    <item>Gourde Haitiano</item>
+	    <item>Guarani</item>
+	    <item>Franco de Guine</item>
+	    <item>Dlar da Guiana</item>
+	    <item>Dlar de Hong Kong</item>
+	    <item>Hryvnia</item>
+	    <item>Coroa da Islandia</item>
+	    <item>Rupia Indiana</item>
+	    <item>Rial Iraniano</item>
+	    <item>Dinar Iraquiano</item>
+	    <item>Dlar Jamaicano</item>
+	    <item>Dinar Jordaniano</item>
+	    <item>Xelim do Quenia</item>
+	    <item>Kina</item>
+	    <item>Quipe</item>
+	    <item>Dinar Kwait</item>
+	    <item>Quacha</item>
+	    <item>Kwanza</item>
+	    <item>Quiate</item>
+	    <item>Lari</item>
+	    <item>Lat da Letonia</item>
+	    <item>Libra do Lbano</item>
+	    <item>Lek</item>
+	    <item>Lempira</item>
+	    <item>Leone</item>
+	    <item>Dlar Liberiano</item>
+	    <item>Dinar Libia</item>
+	    <item>Lilangeni</item>
+	    <item>Lita da Lituania</item>
+	    <item>Loti</item>
+	    <item>Ariary de Madagascar</item>
+	    <item>Ringgit da Malasia</item>
+	    <item>Rupia de Mauricio</item>
+	    <item>Peso Mexicano</item>
+	    <item>Unidade Mexicana de Inverso</item>
+	    <item>Leu da Moldvia</item>
+	    <item>Dirham de Marrocos</item>
+	    <item>Nova Metical de Moambique</item>
+	    <item>Mvdol</item>
+	    <item>Naira</item>
+	    <item>Nakfa</item>
+	    <item>Dlar da Nambia</item>
+	    <item>Rupia do Nepal</item>
+	    <item>Florim das Antilhas Holandesas</item>
+	    <item>Shequl Israelense</item>
+	    <item>Novo Leu Romeno</item>
+	    <item>Novo Dlar Taiwanes</item>
+	    <item>Dlar Neozelands</item>
+	    <item>Ngultrum</item>
+	    <item>Won Norte Koreano</item>
+	    <item>Krone Noruegues</item>
+	    <item>Novo Sol</item>
+	    <item>Uguia</item>
+	    <item>Paanga</item>
+	    <item>Rupia do Paquisto</item>
+	    <item>Paladio</item>
+	    <item>Pataca</item>
+	    <item>Peso conversvel</item>
+	    <item>Peso Uruguaio</item>
+	    <item>Peso Filipino</item>
+	    <item>Platina</item>
+	    <item>Libra Esterlina</item>
+	    <item>Pula</item>
+	    <item>Rial do Catar</item>
+	    <item>Quetzal</item>
+	    <item>Rande</item>
+	    <item>Rial de Om</item>
+	    <item>Riel</item>
+	    <item>Rufia</item>
+	    <item>Rupia da Indonesia</item>
+	    <item>Rublo Russo</item>
+	    <item>Franco de Ruanda</item>
+	    <item>Libra de Santa Helena</item>
+	    <item>Rial da Arbia Saudita</item>
+	    <item>Direito especial</item>
+	    <item>Dinar Srvio</item>
+	    <item>Rupia de Seycheles</item>
+	    <item>Prata</item>
+	    <item>Dlar de Cingapura</item>
+	    <item>Dlar das Ilhas Salomo</item>
+	    <item>Som Quirguisto</item>
+	    <item>Xelim da Somlia</item>
+	    <item>Somoni</item>
+	    <item>Libra Sul Sudanesa</item>
+	    <item>Rupia do Sri Lanka</item>
+	    <item>Sucre</item>
+	    <item>Nova Libra Sudanesa</item>
+	    <item>Dlar do Suriname</item>
+	    <item>Coroa Sueca</item>
+	    <item>Franco Suio</item>
+	    <item>Libra Siria</item>
+	    <item>Taca</item>
+	    <item>Tala</item>
+	    <item>Xelim da Tanzania</item>
+	    <item>Tenge</item>
+	    <item>Sem moeda</item>
+	    <item>Dlar de Trinidad e Tobago</item>
+	    <item>Tugrik</item>
+	    <item>Dinar Tunisiano</item>
+	    <item>Nova Lira Turca</item>
+	    <item>Novo Manat Turcomenisto</item>
+	    <item>Dirham EAU</item>
+	    <item>Xelim de Uganda</item>
+	    <item>UIC-Franc</item>
+	    <item>Unidade de Valor Real</item>
+	    <item>unidades de fomento</item>
+	    <item>Uruguai Peso em Unidades Indexadas</item>
+	    <item>Dlar dos EUA</item>
+	    <item>Som do Uzbequisto</item>
+	    <item>Vatu</item>
+	    <item>WIR Euro</item>
+	    <item>WIR Franc</item>
+	    <item>Won Sul Coreano</item>
+	    <item>Rial de Iemen</item>
+	    <item>Iene</item>
+	    <item>Renmimbi de Iuan</item>
+	    <item>Quacha do Zambia</item>
+	    <item>Dlar do Zimbabue</item>
+	    <item>Zloty</item>
+	  </string-array>
+	  <string-array name="default_accounts">
+	    <item>Despesas</item>
+	    <item>Receitas</item>
+	    <item>Ativos</item>
+	    <item>Equity</item>
+		<item>Liabilities</item>
+	  </string-array>
+	  <string name="error_no_accounts">No existem contas no GnuCash.\nCriar uma conta antes de adicionar um widget</string>
+	  <string name="title_build_version">Verso de compilao</string>
+	  <string name="title_license">Licena</string>
+	  <string name="summary_licence_details">Apache License v2.0. Clique para mais detalhes</string>
+	  <string name="title_general_prefs">Preferncias Gerais</string>
+	  <string name="label_widget_configuration">Selecionar Conta</string>
+	  <string name="toast_no_transactions_to_export">No existem transaes disponveis para exportar</string>
+	  <string name="title_about_gnucash">Sobre o GnuCash</string>
+	  <string name="summary_about_gnucash">GnuCash  um aplicativo para controle de despesas no Android.\nEle proporciona uma forma flexvel de registrar despesas on-the-go, que podem ser exportadas para o formato Open Financial eXchange (OFX) e importadas para o Gnucash para desktop.</string>
+	  <string name="title_about">Sobre</string>
+	  <string name="toast_error_exporting">No foi possvel gravar o arquivo OFX em :\n</string>
+	  <string name="toast_ofx_exported_to">Arquivo OFX exportado para:\n</string>
+	  <string name="title_export_email">Exportar GnuCash OFX</string>
+	  <string name="description_export_email">Exportar GnuCash OFX de</string>
+	  <string name="header_transaction_settings">Transaes</string>
+	  <string name="title_transaction_preferences">Preferncias para Transaes</string>
+	  <string name="title_account_preferences">Preferncias para Contas</string>
+	  <string name="title_default_transaction_type">Tipo de Transao Padro</string>
+	  <string name="summary_default_transaction_type">O tipo de transao a ser usada por padro, CRDITO ou DBITO</string>
+	  <string-array name="transaction_types">
+	    <item>CRDITO</item>
+	    <item>DBITO</item>
+	  </string-array>
+	  <string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
+	  <string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	  <string name="title_export_preference_category">Export</string>
+	  <string name="title_export_all_transactions">Export all transactions</string>
+	  <string name="title_always_delete_exported_transactions">Delete exported transactions</string>
+	  <string name="title_default_export_email">Default export email</string>
+	  <string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>  
+	  <string name="label_double_entry_account">Transfer Account</string>
+	  <string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
+	  <string name="title_use_double_entry">Activate Double Entry</string>
+	  <string name="account_balance">Balance</string>
+	  <string name="toast_no_account_name_entered">Please enter an account name</string>
+	  <string name="label_account_currency">Currency</string>
+	  <string name="label_parent_account">Parent account</string>
+	  <string name="title_xml_ofx_header">Use XML OFX header</string>
+	  <string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	  <string name="title_whats_new">What\'s New</string>
+	  <string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+	    - Double entry accounting\n
+	    - Nested accounts\n
+	    - SGML is default OFX export format\n
+	    - Numerous bug fixes\n	        
+	  </string>
+	  <string name="label_dismiss">Dismiss</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index 6c564385..d1ac7c99 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -306,4 +306,13 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
\ No newline at end of file
diff --git a/GnucashMobile/res/values/strings.xml b/GnucashMobile/res/values/strings.xml
index 423d08c2..ad913b50 100644
--- a/GnucashMobile/res/values/strings.xml
+++ b/GnucashMobile/res/values/strings.xml
@@ -498,4 +498,14 @@
 	<string name="label_parent_account">Parent account</string>
 	<string name="title_xml_ofx_header">Use XML OFX header</string>
 	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
+	<string name="key_previous_minor_version">previous_minor_version</string>
+	<string name="title_whats_new">What\'s New</string>
+	<string name="whats_new">
+	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
+        - Double entry accounting\n
+        - Nested accounts\n
+        - SGML is default OFX export format\n
+        - Numerous bug fixes\n	        
+	</string>
+	<string name="label_dismiss">Dismiss</string>
 </resources>
diff --git a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
index fd248ad3..ff288188 100644
--- a/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
+++ b/GnucashMobile/src/org/gnucash/android/ui/accounts/AccountsActivity.java
@@ -34,6 +34,8 @@
 import android.content.Intent;
 import android.content.SharedPreferences;
 import android.content.SharedPreferences.Editor;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager.NameNotFoundException;
 import android.os.Bundle;
 import android.preference.PreferenceManager;
 import android.support.v4.app.Fragment;
@@ -106,8 +108,7 @@ public void onCreate(Bundle savedInstanceState) {
 			Log.e(TAG, e.getMessage());
 			currencyCode = "USD"; //just use USD and let the user choose
 		}
-			
-		
+					
 		Money.DEFAULT_CURRENCY_CODE = currencyCode;		
 		
 		boolean firstRun = prefs.getBoolean(getString(R.string.key_first_run), true);
@@ -128,8 +129,56 @@ public void onCreate(Bundle savedInstanceState) {
 
 			fragmentTransaction.commit();
 		}
+		
+		
+		if (hasNewFeatures()){
+			showWhatsNewDialog();
+		}
 	}
 
+	/**
+	 * Checks if the minor version has been increased and displays the What's New dialog box.
+	 * This is the minor version as per semantic versioning.
+	 * @return <code>true</code> if the minor version has been increased, <code>false</code> otherwise.
+	 */
+	private boolean hasNewFeatures(){
+		try {
+			PackageInfo packageInfo = getPackageManager().getPackageInfo(getPackageName(), 0);
+			String versionName = packageInfo.versionName;			
+			int end = versionName.indexOf('.');
+			int currentMinor = Integer.parseInt(versionName.substring(0, end));
+			
+			SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
+			int previousMinor = prefs.getInt(getString(R.string.key_previous_minor_version), 0);
+			if (currentMinor > previousMinor){
+				Editor editor = prefs.edit();
+				editor.putInt(getString(R.string.key_previous_minor_version), currentMinor);
+				editor.commit();
+				return true;
+			}
+		} catch (NameNotFoundException e) {
+			//do not show anything in that case
+			e.printStackTrace();			
+		}		
+		return false;
+	}
+	
+	/**
+	 * Show dialog with new features for this version
+	 */
+	private void showWhatsNewDialog(){
+		new AlertDialog.Builder(this)
+		.setTitle(R.string.title_whats_new)
+		.setMessage(R.string.whats_new)
+		.setPositiveButton(R.string.label_dismiss, new DialogInterface.OnClickListener() {
+			
+			@Override
+			public void onClick(DialogInterface dialog, int which) {
+				dialog.dismiss();
+			}
+		}).show();
+	}
+	
 	@Override
 	public boolean onCreateOptionsMenu(Menu menu) {
 		MenuInflater inflater = getSupportMenuInflater();

From a06e3cfebb0d9e7588bf5edc055a11ea77c7e8df Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 23 Jan 2013 22:41:16 +0100
Subject: [PATCH 19/27] Add intent support for creation of double entry
 transactions Updated change log

---
 CHANGELOG.md                                                | 13 +++++++++++++
 GnucashMobile/src/org/gnucash/android/data/Transaction.java |  5 +++++
 .../org/gnucash/android/receivers/TransactionRecorder.java  |  3 +++
 3 files changed, 21 insertions(+)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 744a4a85..b97bf1b9 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,6 +1,19 @@
 Change Log
 ===============================================================================
 
+Version 1.1.0 *(2013-01-31)*
+----------------------------
+
+* Feature: Double entry accounting - every transaction is a transfer
+* Feature: Nested accounts
+* Feature: SGML support for OFX exports. Fixes encoding detection problems during imports
+* Feature: Display what's new to user after minor/major updates
+* Improved: Reworked UX for creating accounts
+* Improved: Default accounts now match GnuCash desktop accounts
+* Fixed: Crash when creating accounts with special characters in the names
+* Fixed: GnuCash declares itself as launcher application
+
+
 Version 1.0.3 *(2012-11-23)*
 ----------------------------
 
diff --git a/GnucashMobile/src/org/gnucash/android/data/Transaction.java b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
index 50ce5743..a13531d3 100644
--- a/GnucashMobile/src/org/gnucash/android/data/Transaction.java
+++ b/GnucashMobile/src/org/gnucash/android/data/Transaction.java
@@ -55,6 +55,11 @@
 	public static final String EXTRA_ACCOUNT_UID 	= "org.gnucash.android.extra.account_uid";
 	
 	/**
+	 * Key for specifying the double entry account
+	 */
+	public static final String EXTRA_DOUBLE_ACCOUNT_UID = "org.gnucash.android.extra.double_account_uid";
+	
+	/**
 	 * Key for identifying the amount of the transaction through an Intent
 	 */
 	public static final String EXTRA_AMOUNT 		= "org.gnucash.android.extra.amount";
diff --git a/GnucashMobile/src/org/gnucash/android/receivers/TransactionRecorder.java b/GnucashMobile/src/org/gnucash/android/receivers/TransactionRecorder.java
index 81a9c3a8..c0dbf13e 100644
--- a/GnucashMobile/src/org/gnucash/android/receivers/TransactionRecorder.java
+++ b/GnucashMobile/src/org/gnucash/android/receivers/TransactionRecorder.java
@@ -59,11 +59,14 @@ public void onReceive(Context context, Intent intent) {
 		if (accountUID == null)
 			accountUID = "uncategorized";
 		
+		String doubleAccountUID = args.getString(Transaction.EXTRA_DOUBLE_ACCOUNT_UID);
+		
 		Money amount = new Money(new BigDecimal(amountDouble), Currency.getInstance(currencyCode));
 		Transaction transaction = new Transaction(amount, name);
 		transaction.setTime(System.currentTimeMillis());
 		transaction.setDescription(note);	
 		transaction.setAccountUID(accountUID);
+		transaction.setDoubleEntryAccountUID(doubleAccountUID);
 		
 		TransactionsDbAdapter transacionsDbAdapter = new TransactionsDbAdapter(context);
 		transacionsDbAdapter.addTransaction(transaction);

From 8c7295a6fe5c7c9a78f5ec2a6bd3bcb606335260 Mon Sep 17 00:00:00 2001
From: pedroabel <pedroabel@gmail.com>
Date: Wed, 23 Jan 2013 23:00:25 -0200
Subject: [PATCH 20/27] Update GnucashMobile/res/values-pt-rBR/strings.xml

Updated Brazilian Portuguese translation
---
 GnucashMobile/res/values-pt-rBR/strings.xml | 44 ++++++++++++++---------------
 1 file changed, 22 insertions(+), 22 deletions(-)

diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index df7526cc..862eabdb 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -289,29 +289,29 @@
 	    <item>CRDITO</item>
 	    <item>DBITO</item>
 	  </string-array>
-	  <string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-	  <string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
-	  <string name="title_export_preference_category">Export</string>
-	  <string name="title_export_all_transactions">Export all transactions</string>
-	  <string name="title_always_delete_exported_transactions">Delete exported transactions</string>
-	  <string name="title_default_export_email">Default export email</string>
-	  <string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>  
-	  <string name="label_double_entry_account">Transfer Account</string>
-	  <string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
-	  <string name="title_use_double_entry">Activate Double Entry</string>
-	  <string name="account_balance">Balance</string>
-	  <string name="toast_no_account_name_entered">Please enter an account name</string>
-	  <string name="label_account_currency">Currency</string>
-	  <string name="label_parent_account">Parent account</string>
-	  <string name="title_xml_ofx_header">Use XML OFX header</string>
-	  <string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
-	  <string name="title_whats_new">What\'s New</string>
+	  <string name="delete_all_transactions_confirmation_message">Voc tem certeza que quer deletar TODAS as transaes?</string>
+	  <string name="delete_transaction_confirmation_message">Voc tem certeza que quer deletar essa esta transao?</string>
+	  <string name="title_export_preference_category">Exportar</string>
+	  <string name="title_export_all_transactions">Exportar todas as transaes</string>
+	  <string name="title_always_delete_exported_transactions">Delear transaes exportadas</string>
+	  <string name="title_default_export_email">Email padro para exportao</string>
+	  <string name="summary_default_export_email">O email padro para enviar a exportao. Voc poder alterar isso quando for exportar.</string>  
+	  <string name="label_double_entry_account">Conta de transferncia</string>
+	  <string name="summary_use_double_entry">Todas as transaes sero uma transferncia de uma conta para outra</string>
+	  <string name="title_use_double_entry">Ativar Partidas Dobradas</string>
+	  <string name="account_balance">Balano</string>
+	  <string name="toast_no_account_name_entered">Por favor adicione um nome para a conta</string>
+	  <string name="label_account_currency">Moeda</string>
+	  <string name="label_parent_account">Conta superior</string>
+	  <string name="title_xml_ofx_header">Usar cabealho XML OFX</string>
+	  <string name="summary_xml_ofx_header">Habilitar essa opo quando estiver exportando para um software terceiro, diferente do GnuCash para desktop</string>
+	  <string name="title_whats_new">O que h de novo</string>
 	  <string name="whats_new">
 	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
-	    - Double entry accounting\n
+	    - Contabilidade por partidas dobradas\n
 	    - Nested accounts\n
-	    - SGML is default OFX export format\n
-	    - Numerous bug fixes\n	        
+	    - SGML  o formato padro para exportao de OFX\n
+	    - Diversas correes de bugs\n	        
 	  </string>
-	  <string name="label_dismiss">Dismiss</string>
-</resources>
\ No newline at end of file
+	  <string name="label_dismiss">Descartar</string>
+</resources>

From a554df3a497610ca9ca50ad7e19bfa0a0cdb50e6 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jorge=20Mart=C3=ADnez=20L=C3=B3pez?= <jorgeml@gmail.com>
Date: Thu, 24 Jan 2013 07:16:56 +0000
Subject: [PATCH 21/27] Spanish translation of new strings.

---
 GnucashMobile/res/values-es/strings.xml | 44 ++++++++++++++++-----------------
 1 file changed, 22 insertions(+), 22 deletions(-)

diff --git a/GnucashMobile/res/values-es/strings.xml b/GnucashMobile/res/values-es/strings.xml
index d69ef110..93326927 100644
--- a/GnucashMobile/res/values-es/strings.xml
+++ b/GnucashMobile/res/values-es/strings.xml
@@ -264,8 +264,8 @@
 	    <item>Gastos</item>
 	    <item>Ingresos</item>
 	    <item>Activos</item>	    
-	    <item>Equity</item>
-	    <item>Liabilities</item>
+	    <item>Capital</item>
+	    <item>Pasivo</item>
 	</string-array>
 	<string name="error_no_accounts">No hay cuentas en Gnucash.\nCree una cuenta antes de a&#241;adir un widget</string>
 	<string name="title_build_version">Versi&#243;n de compilaci&#243;n</string>
@@ -276,7 +276,7 @@
 	<string name="toast_no_transactions_to_export">No hay transacciones disponibles para exportar</string>
 	<string name="title_about_gnucash">Acerca de Gnucash</string>
 	<string name="summary_about_gnucash">GnucashMobile es una aplicaci&#243;n de registro de gastos financieros para Android.\nPermite un registro flexible de gastos en cualquier lugar que luego pueden ser exportados al formato Open Financial eXchange (OFX) e importados en la aplicaci&#243;n Gnucash para el escritorio.</string>
-	<string name="title_about">About</string>
+	<string name="title_about">Acerca de</string>
 	<string name="toast_error_exporting">No se pudo guardar el archivo OFX en:\n</string>
 	<string name="toast_ofx_exported_to">Archivo OFX exportado a:\n</string>
 	<string name="title_export_email">Exportaci&#243;n OFX de Gnucash</string>
@@ -293,26 +293,26 @@
 	<string name="delete_all_transactions_confirmation_message">&#191;Borrar TODAS las transacciones?</string>
 	<string name="delete_transaction_confirmation_message">&#191;Borrar esta transacci&#243;n?</string>
 	<string name="title_export_preference_category">Exportaci&#243;n</string>
-	<string name="title_export_all_transactions">Export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
-	<string name="title_default_export_email">Correo electr&#243;nico por defecto para exportar</string>
+	<string name="title_export_all_transactions">Exportar todas las transacciones</string>
+	<string name="title_always_delete_exported_transactions">Borrar las transacciones exportadas</string>
+	<string name="title_default_export_email">Correo electr&#243;nico para exportar por defecto</string>
 	<string name="summary_default_export_email">La direcci&#243;n de correo electr&#243;nico a la que enviar las exportaciones por defecto. Se puede cambiar en cada exportaci&#243;n.</string>
-	<string name="label_double_entry_account">Transfer Account</string>
-	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
-	<string name="title_use_double_entry">Activate Double Entry</string>
-	<string name="account_balance">Balance</string>
-	<string name="toast_no_account_name_entered">Please enter an account name</string>
-	<string name="label_account_currency">Currency</string>
-	<string name="label_parent_account">Parent account</string>
-	<string name="title_xml_ofx_header">Use XML OFX header</string>
-	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
-	<string name="title_whats_new">What\'s New</string>
+	<string name="label_double_entry_account">Transferir Cuenta</string>
+	<string name="summary_use_double_entry">Todas las transacciones ser&#225;n transferidas de una cuenta a otra</string>
+	<string name="title_use_double_entry">Activar Doble Entrada</string>
+	<string name="account_balance">Saldo</string>
+	<string name="toast_no_account_name_entered">Por favor introduzca un nombre para la cuenta</string>
+	<string name="label_account_currency">Divisa</string>
+	<string name="label_parent_account">Cuenta padre</string>
+	<string name="title_xml_ofx_header">Usar cabecera XML OFX</string>
+	<string name="summary_xml_ofx_header">Active esta opci&#243;n para exportar a otras aplicaciones distintas a GnuCash para escritorio</string>
+	<string name="title_whats_new">Novedades</string>
 	<string name="whats_new">
-	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
-        - Double entry accounting\n
-        - Nested accounts\n
-        - SGML is default OFX export format\n
-        - Numerous bug fixes\n	        
+	    <b>Versi&#243;n 1.1.0 - 31.01.2013</b>\n\n
+        - Contabilidad de doble entrada\n
+        - Cuentas anidadas\n
+        - SGML es el formato por defecto para la exportaci&#243;n OFX\n
+        - Varios bugs solucionados\n	        
 	</string>
-	<string name="label_dismiss">Dismiss</string>	
+	<string name="label_dismiss">Cerrar</string>	
 </resources>

From 43d57bef9d946093ee90c8f4506266651f7efe65 Mon Sep 17 00:00:00 2001
From: Menelaos Maglis <mmaglis@metacom.gr>
Date: Thu, 24 Jan 2013 12:12:54 +0100
Subject: [PATCH 22/27] Update Greek Translation

---
 GnucashMobile/res/values-el/strings.xml | 56 ++++++++++++++++-----------------
 1 file changed, 28 insertions(+), 28 deletions(-)

diff --git a/GnucashMobile/res/values-el/strings.xml b/GnucashMobile/res/values-el/strings.xml
index d91ab519..d7ee655f 100644
--- a/GnucashMobile/res/values-el/strings.xml
+++ b/GnucashMobile/res/values-el/strings.xml
@@ -262,13 +262,13 @@
     </string-array>
 	<string-array name="default_accounts">
 	    <item></item>
-	    <item></item>
+	    <item></item>
 	    <item></item>	    
-	    <item>Equity</item>
-	    <item>Liabilities</item>
+	    <item> </item>
+	    <item></item>
 	</string-array>
 	<string name="error_no_accounts">   
-	GnuCash.\n      widget</string>
+	GnuCash.\n       </string>
 	<string name="title_build_version"></string>
 	<string name="title_license"> </string>
 	<string name="summary_licence_details">  Apache v2.0.   </string>
@@ -296,29 +296,29 @@
 		<item></item>
 		<item></item>
 	</string-array>
-	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
-	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
-	<string name="title_default_export_email">Default export email</string>
-	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>		
-	<string name="label_double_entry_account">Transfer Account</string>
-	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
-	<string name="title_use_double_entry">Activate Double Entry</string>
-	<string name="account_balance">Balance</string>
-	<string name="toast_no_account_name_entered">Please enter an account name</string>
-	<string name="label_account_currency">Currency</string>
-	<string name="label_parent_account">Parent account</string>
-	<string name="title_xml_ofx_header">Use XML OFX header</string>
-	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
-	<string name="title_whats_new">What\'s New</string>
+	<string name="delete_all_transactions_confirmation_message">      ;</string>
+	<string name="delete_transaction_confirmation_message">      ;</string>
+	<string name="title_export_preference_category"></string>
+	<string name="title_export_all_transactions">   </string>
+	<string name="title_always_delete_exported_transactions">  </string>
+	<string name="title_default_export_email"> email </string>
+	<string name="summary_default_export_email">   email   .        .</string>		
+	<string name="label_double_entry_account"> </string>
+	<string name="summary_use_double_entry">          .</string>
+	<string name="title_use_double_entry">   </string>
+	<string name="account_balance"></string>
+	<string name="toast_no_account_name_entered">    </string>
+	<string name="label_account_currency"></string>
+	<string name="label_parent_account"> </string>
+	<string name="title_xml_ofx_header">  XML OFX</string>
+	<string name="summary_xml_ofx_header">        ,   GnuCash   .</string>
+	<string name="title_whats_new">  </string>
 	<string name="whats_new">
-	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
-        - Double entry accounting\n
-        - Nested accounts\n
-        - SGML is default OFX export format\n
-        - Numerous bug fixes\n        
+	    <b> 1.1.0 - 31.01.2013</b>\n\n
+        -   \n
+        -  \n
+        - SGML     OFX\n
+        -    \n        
 	</string>
-	<string name="label_dismiss">Dismiss</string>
-</resources>
+	<string name="label_dismiss"></string>
+</resources>

From 4cbefbdd76ac541785e1c9757e6cf69e8d19fa0f Mon Sep 17 00:00:00 2001
From: pedroabel <pedroabel@gmail.com>
Date: Thu, 24 Jan 2013 19:43:06 -0200
Subject: [PATCH 23/27] Update GnucashMobile/res/values-pt-rBR/strings.xml

Brazilian translation update
---
 GnucashMobile/res/values-pt-rBR/strings.xml | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/GnucashMobile/res/values-pt-rBR/strings.xml b/GnucashMobile/res/values-pt-rBR/strings.xml
index 862eabdb..6dd7a471 100644
--- a/GnucashMobile/res/values-pt-rBR/strings.xml
+++ b/GnucashMobile/res/values-pt-rBR/strings.xml
@@ -263,8 +263,8 @@
 	    <item>Despesas</item>
 	    <item>Receitas</item>
 	    <item>Ativos</item>
-	    <item>Equity</item>
-		<item>Liabilities</item>
+	    <item>Patrimnio lquido</item>
+		<item>Passivos</item>
 	  </string-array>
 	  <string name="error_no_accounts">No existem contas no GnuCash.\nCriar uma conta antes de adicionar um widget</string>
 	  <string name="title_build_version">Verso de compilao</string>
@@ -309,7 +309,7 @@
 	  <string name="whats_new">
 	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
 	    - Contabilidade por partidas dobradas\n
-	    - Nested accounts\n
+	    - Subcontas\n
 	    - SGML  o formato padro para exportao de OFX\n
 	    - Diversas correes de bugs\n	        
 	  </string>

From afdde961452c409639e57958f41978fceef49356 Mon Sep 17 00:00:00 2001
From: yapiti <wicowyn@gmail.com>
Date: Fri, 25 Jan 2013 18:07:35 +0100
Subject: [PATCH 24/27] Update french translation

---
 GnucashMobile/res/values-fr/strings.xml | 98 ++++++++++++++++-----------------
 1 file changed, 49 insertions(+), 49 deletions(-)

diff --git a/GnucashMobile/res/values-fr/strings.xml b/GnucashMobile/res/values-fr/strings.xml
index 14c6dee3..64672e76 100644
--- a/GnucashMobile/res/values-fr/strings.xml
+++ b/GnucashMobile/res/values-fr/strings.xml
@@ -19,20 +19,20 @@
 <resources>
     <string name="app_name">GnuCash</string>
     <string name="title_add_account">Cr&#233;er un compte</string>
-    <string name="title_edit_account">&#233;diter le compte</string>
-    <string name="info_details">Information</string>
+    <string name="title_edit_account">Editer le compte</string>
+    <string name="info_details">Informations</string>
     <string name="title_settings">Param&#232;tres</string>
     <string name="menu_export_ofx">Exporter en OFX</string>
-    <string name="description_add_transaction_icon">Ajouter une nouvelle transaction &#192; un compte</string>
-    <string name="label_no_accounts">Aucun compte &#192; afficher</string>
+    <string name="description_add_transaction_icon">Ajouter une nouvelle transaction &#224; un compte</string>
+    <string name="label_no_accounts">Aucun compte &#224; afficher</string>
     <string name="label_account_name">Nom de compte</string>
     <string name="btn_cancel">Annuler</string>
     <string name="btn_save">Sauvgarder</string>
-    <string name="label_no_transactions_to_display">Aucune transaction &#192; afficher</string>
+    <string name="label_no_transactions_to_display">Aucune transaction &#224; afficher</string>
     <string name="label_transaction_name">Description</string>
     <string name="label_transaction_amount">Montant</string>
     <string name="title_add_transaction">Nouvelle transaction</string>
-    <string name="label_no_transactions">Aucune transaction &#192; afficher</string>
+    <string name="label_no_transactions">Aucune transaction &#224; afficher</string>
     <string name="label_timeanddate">DATE &amp; HEURE</string>
     <string name="label_account">Compte</string>
     <string name="label_debit">DEBIT</string>
@@ -43,8 +43,8 @@
     <string name="alert_dialog_ok_delete">Supprimer</string>
     <string name="alert_dialog_cancel">Annuler</string>
     <string name="toast_account_deleted">Compte supprim&#233;</string>
-    <string name="title_confirm_delete">Confirmer la suppression</string>
-    <string name="delete_account_confirmation_message">Toute les transactions dans ce compte seront supprimer</string>
+    <string name="title_confirm_delete">Confirmation de suppression</string>
+    <string name="delete_account_confirmation_message">Toutes les transactions dans ce compte seront supprimer</string>
     <string name="title_edit_transaction">Editer la transaction</string>
     <string name="label_transaction_description">Note</string>
     <string name="menu_move">DEPLACER</string>
@@ -52,11 +52,11 @@
     <string name="label_transactions_total">Total:</string>
     <string name="label_export_destination">Destination d\'export</string>
     <string name="title_export_dialog">Exporter en OFX</string>
-    <string name="option_export_all_transactions">Exporter toute les transactions</string>
+    <string name="option_export_all_transactions">Exporter toutes les transactions</string>
     <string name="hint_export_choice">Par d&#233;faut, seul les nouvelles transactions depuis le dernier export seront exporter. Cochez cette option pour exporter toutes les transactions</string>
     <string name="error_exporting">Erreur lors de l\'export des donn&#233;es en OFX</string>    
     <string name="btn_export">Exporter</string>
-    <string name="option_delete_after_export">Supprimer apr&#233;s export</string>
+    <string name="option_delete_after_export">Supprimer apr&#232;s export</string>
     <string name="hint_delete_after_export">Toutes les transactions export&#233; seront supprimer apr&#233;s l\'export</string>
     <string name="title_settings">Param&#232;tres</string>
     <string-array name="export_destinations">
@@ -67,13 +67,13 @@
     <string name="title_move_transactions">D&#233;placer %1$d transaction(s)</string>
     <string name="label_move_destination">Compte de destination</string>
     <string name="permission_access_sdcard">Acc&#233;s carte SD</string>
-    <string name="title_share_ofx_with">Partager l\export en OFX avec&#8230;</string>
+    <string name="title_share_ofx_with">Partager l\'export en OFX avec</string>
     <string name="toast_incompatible_currency">Impposible de d&#233;placer les transactions.\nLe compte de destination utilise une monnaie diff&#233;rente du compte d\'origine</string>
     <string name="header_general_settings">G&#233;n&#233;ral</string>
-    <string name="header_about_gnucash">&#192; propos</string>
+    <string name="header_about_gnucash">A propos</string>
     <string name="title_choose_currency">Choisisez une monnaie par d&#233;faut</string>
     <string name="title_default_currency">Monnaie par d&#233;faut</string>
-    <string name="summary_default_currency">Monnaie par d&#233;faut &#192; assigner aux nouveau comptes</string>
+    <string name="summary_default_currency">Monnaie par d&#233;faut &#224; assigner aux nouveau comptes</string>
     <string name="label_permission_record_transactions">Permettre l\'enregistrement des transactions dans Gnucash pour Android</string>
     <string name="label_permission_create_accounts">Permettre la cr&#233;ation de comptes dans Gnucash pour Android</string>
     <string name="label_permission_group">Vos donn&#233;es GnuCash</string>
@@ -82,7 +82,7 @@
     <string name="label_permission_create_account">cr&#233;er les comptes</string>
     <string name="label_display_account">Afficher le compte</string>
     <string name="btn_create_accounts">Cr&#233;er les comptes</string>
-    <string name="title_default_accounts">Choisisez les comptes &#192; cr&#233;er</string>
+    <string name="title_default_accounts">Choisisez les comptes &#224; cr&#233;er</string>
     <string-array name="currency_names">
         <item>Afghani</item>
 		<item>Algerian Dinar</item>
@@ -261,58 +261,58 @@
 		<item>Zloty</item>
     </string-array>
 	<string-array name="default_accounts">
-	    <item>D&#233;pense</item>
-	    <item>Revenu</item>
-	    <item>Actif</item>	    
-	    <item>Equity</item>
-	    <item>Liabilities</item>
+	    <item>D&#233;penses</item>
+	    <item>Revenus</item>
+	    <item>Actifs</item>	    
+	    <item>Capitaux propres</item>
+	    <item>Charges</item>
 	</string-array>
 	<string name="error_no_accounts">Aucun compte &#233;xistant dans Gnucash.\nCr&#233;er un compte avant d\'ajouter un widget</string>
 	<string name="title_build_version">Version logiciel</string>
 	<string name="title_license">Licence</string>
-	<string name="summary_licence_details">Apache License v2.0. Click pour plus de d&#233;tails</string>
+	<string name="summary_licence_details">Apache License v2.0. Clickez pour plus de d&#233;tails</string>
 	<string name="title_general_prefs">G&#233;n&#233;ral</string>
-	<string name="label_widget_configuration">Selectionnez un compte</string>
+	<string name="label_widget_configuration">S&#233;lectionnez un compte</string>
 	<string name="toast_no_transactions_to_export">Il n\'existe pas de transactions disponible pour l\'exportation</string>
-	<string name="title_about_gnucash">&#192; propos de Gnucash</string>
-	<string name="summary_about_gnucash">GnucashMobile est une application mobile de suivis de finance pour Android.\nIl permet un suivi simple des d&#233;penses et qui peut tre export&#233; vers le format Open Financial eXchange (OFX) et import&#233;s dans Gnucash pour PC.</string>
-	<string name="title_about">&#192; propos</string>
+	<string name="title_about_gnucash">A propos de Gnucash</string>
+	<string name="summary_about_gnucash">GnucashMobile est une application mobile de suivis de finance pour Android.\nElle permet un suivi simple des d&#233;penses qui peut &#234;tre export&#233; vers le format Open Financial eXchange (OFX) et import&#233; dans Gnucash pour PC.</string>
+	<string name="title_about"> A propos</string>
 	<string name="toast_error_exporting">Impossible d\'&#233;crire un fichier OFX en:\n</string>
 	<string name="toast_ofx_exported_to">Fichier OFX export&#233; en:\n</string>
 	<string name="title_export_email">Gnucash OFX export</string>
-	<string name="description_export_email">Gnucash OFX Export von </string>
+	<string name="description_export_email">Gnucash OFX Export de </string>
 	<string name="header_transaction_settings">Transactions</string>
-	<string name="title_transaction_preferences">Prfrences des transactions</string>
-	<string name="title_account_preferences">Prfrences du compte</string>
-	<string name="title_default_transaction_type">Type de transaction par dfaut</string>
-	<string name="summary_default_transaction_type">Le type de transaction  utiliser par dfaut, CREDIT ou DEBIT</string>
+	<string name="title_transaction_preferences">Pr&#233;f&#233;rences des transactions</string>
+	<string name="title_account_preferences">Pr&#233;f&#233;rences du compte</string>
+	<string name="title_default_transaction_type">Type de transaction par d&#233;faut</string>
+	<string name="summary_default_transaction_type">Le type de transaction &#224; utiliser par d&#233;faut, CREDIT ou DEBIT</string>
 	<string-array name="transaction_types">
 		<item>CREDIT</item>
 		<item>DEBIT</item>
 	</string-array>
-	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
+	<string name="delete_all_transactions_confirmation_message">Etes vous s&#251;re de vouloir supprimer TOUTES les transactions?</string>
+	<string name="delete_transaction_confirmation_message">Etes vous s&#251;re de vouloir supprimer cette transaction?</string>
 	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
-	<string name="title_default_export_email">Default export email</string>
-	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>
-	<string name="label_double_entry_account">Transfer Account</string>
-	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
-	<string name="title_use_double_entry">Activate Double Entry</string>
+	<string name="title_export_all_transactions">Exporter toutes les transactions</string>
+	<string name="title_always_delete_exported_transactions">Supprimer les transactions export&#233;s</string>
+	<string name="title_default_export_email">Email par d&#233;faut d\'export</string>
+	<string name="summary_default_export_email">Email par d&#233;faut pour les exports. Vous pourrez toujours le changer lors de votre prochain export.</string>
+	<string name="label_double_entry_account">Transfert entre compte</string>
+	<string name="summary_use_double_entry">Toutes les transactions seront transf&#233;rer d\'un compte &#224; l\'autre</string>
+	<string name="title_use_double_entry">Activer les doubles entr&#233;es</string>
 	<string name="account_balance">Balance</string>
-	<string name="toast_no_account_name_entered">Please enter an account name</string>
-	<string name="label_account_currency">Currency</string>
-	<string name="label_parent_account">Parent account</string>
-	<string name="title_xml_ofx_header">Use XML OFX header</string>
-	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
-	<string name="title_whats_new">What\'s New</string>
+	<string name="toast_no_account_name_entered">Veuillez entrer un nom de compte</string>
+	<string name="label_account_currency">Monnaie</string>
+	<string name="label_parent_account">Compte parent</string>
+	<string name="title_xml_ofx_header">Utiliser l\'ent&#234;te XML d\'OFX</string>
+	<string name="summary_xml_ofx_header">Activez cette option lors d\'un export vers une application tierce autre que GnuCash pour bureau</string>
+	<string name="title_whats_new">Quoi de nouveau</string>
 	<string name="whats_new">
 	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
-        - Double entry accounting\n
-        - Nested accounts\n
-        - SGML is default OFX export format\n
-        - Numerous bug fixes\n	        
+        - Comptes &#224; double entr&#233;e\n
+        - Imbriquation de comptes\n
+        - SGML est par d&#233;faut le format d\'export OFX\n
+        - Plusieurs correctifs\n	        
 	</string>
-	<string name="label_dismiss">Dismiss</string>
+	<string name="label_dismiss">Passer</string>
 </resources>
\ No newline at end of file

From 66ce9c3adf4e4113566322531f123a2295bb9e91 Mon Sep 17 00:00:00 2001
From: cmarchi <cri.penta@gmail.com>
Date: Sat, 26 Jan 2013 11:14:29 +0100
Subject: [PATCH 25/27] Update GnucashMobile/res/values-it/strings.xml

Update Italian translation
---
 GnucashMobile/res/values-it/strings.xml | 66 ++++++++++++++++-----------------
 1 file changed, 33 insertions(+), 33 deletions(-)

diff --git a/GnucashMobile/res/values-it/strings.xml b/GnucashMobile/res/values-it/strings.xml
index 718db92a..fb80a1b4 100644
--- a/GnucashMobile/res/values-it/strings.xml
+++ b/GnucashMobile/res/values-it/strings.xml
@@ -263,26 +263,26 @@
 	<string-array name="default_accounts">
 	    <item>Uscite</item>
 	    <item>Entrate</item>
-	    <item>Capitali</item>	    
-	    <item>Equity</item>
-	    <item>Liabilities</item>
+	    <item>Beni</item>	    
+	    <item>Capitali</item>
+	    <item>Passivit</item>
 	</string-array>
-	<string name="error_no_accounts">Non esiste alcun conto in Gnucash.\nCreare un conto prima di aggiungere il widget</string>
+	<string name="error_no_accounts">Non esiste alcun conto in GnuCash.\nCreare un conto prima di aggiungere il widget</string>
 	<string name="title_build_version">Versione build</string>
 	<string name="title_license">Licenza</string>
 	<string name="summary_licence_details">Apache License v2.0. Fare clic per i dettagli</string>
 	<string name="title_general_prefs">Generale</string>
 	<string name="label_widget_configuration">Seleziona conto</string>
 	<string name="toast_no_transactions_to_export">Non sono disponibili transazioni da esportare</string>
-	<string name="title_about_gnucash">Informazioni su Gnucash</string>
-	<string name="summary_about_gnucash">GnucashMobile &#232; un\'applicazione Android per tenere traccia delle proprie spese.\nPermette di registrare le proprie uscite al volo, di esportarle in formato OFX (Open Financial eXchange) e di importarle nella versione desktop di GnuCash.</string>
+	<string name="title_about_gnucash">Informazioni su GnuCcash</string>
+	<string name="summary_about_gnucash">GnuCashMobile &#232; un\'applicazione Android per tenere traccia delle proprie spese.\nPermette di registrare le proprie uscite al volo, di esportarle in formato OFX (Open Financial eXchange) e di importarle nella versione desktop di GnuCash.</string>
 	<string name="title_about">Informazioni</string>
 	<string name="toast_error_exporting">Impossibile scrivere il file OFX in:\n</string>
 	<string name="toast_ofx_exported_to">File OFX esportato in:\n</string>
-	<string name="title_export_email">Esportazione file OFX di Gnucash</string>
-	<string name="description_export_email">Esportazione OFX di Gnucash con </string>
+	<string name="title_export_email">Esportazione file OFX di GnuCash</string>
+	<string name="description_export_email">Esportazione OFX di GnuCash con </string>
 	<string name="header_transaction_settings">Transazioni</string>
-	<string name="title_transaction_preferences">Preferenza della transazione</string>
+	<string name="title_transaction_preferences">Preferenze della transazione</string>
 	<string name="title_account_preferences">Preferenze del conto</string>
 	<string name="title_default_transaction_type">Tipo di transazione predefinita</string>
 	<string name="summary_default_transaction_type">Il tipo di transazione da usare come predefinita, CREDITO o DEBITO</string>
@@ -290,29 +290,29 @@
 	 	<item>CREDITO</item>
 	 	<item>DEBITO</item>
 	</string-array>
-	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
-	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
-	<string name="title_default_export_email">Default export email</string>
-	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
-	<string name="label_double_entry_account">Transfer Account</string>
-	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
-	<string name="title_use_double_entry">Activate Double Entry</string>
-	<string name="account_balance">Balance</string>
-	<string name="toast_no_account_name_entered">Please enter an account name</string>
-	<string name="label_account_currency">Currency</string>
-	<string name="label_parent_account">Parent account</string>
-	<string name="title_xml_ofx_header">Use XML OFX header</string>
-	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
-	<string name="title_whats_new">What\'s New</string>
+	<string name="delete_all_transactions_confirmation_message">Eliminare TUTTE le transazioni?</string>
+	<string name="delete_transaction_confirmation_message">Eliminare davvero questa transazione?</string>
+	<string name="title_export_preference_category">Esporta</string>
+	<string name="title_export_all_transactions">Esporta tutte le transazioni</string>
+	<string name="title_always_delete_exported_transactions">Elimina le transazioni esportate</string>
+	<string name="title_default_export_email">Email predefinita di esportazione</string>
+	<string name="summary_default_export_email">L\'indirizzo email predefinito a cui inviare i file esportati.  comunque possibile modificare l\'indirizzo quando si esporta.</string>	
+	<string name="label_double_entry_account">Conto di trasferimento</string>
+	<string name="summary_use_double_entry">Tutte le transazioni consisteranno in un trasferimento di denaro da un conto a un altro</string>
+	<string name="title_use_double_entry">Abilita partita doppia</string>
+	<string name="account_balance">Saldo</string>
+	<string name="toast_no_account_name_entered">Inserire un nome per il conto</string>
+	<string name="label_account_currency">Valuta</string>
+	<string name="label_parent_account">Conto principale</string>
+	<string name="title_xml_ofx_header">Usa header XML OFX</string>
+	<string name="summary_xml_ofx_header">Abilitare questa opzione quando si esporta verso un\'applicazione diversa da GnuCash versione desktop</string>
+	<string name="title_whats_new">Novit</string>
 	<string name="whats_new">
-	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
-        - Double entry accounting\n
-        - Nested accounts\n
-        - SGML is default OFX export format\n
-        - Numerous bug fixes\n	        
+	    <b>Versione 1.1.0 - 31.01.2013</b>\n\n
+        - Contabilit a partita doppia\n
+        - Conti nidificati\n
+        - SGML  il formato OFX predefinito per l\'esportazione\n
+        - Molte correzioni di bug\n	        
 	</string>
-	<string name="label_dismiss">Dismiss</string>
-</resources>
+	<string name="label_dismiss">Chiudi</string>
+</resources>

From df53ec10ef4e6f10a609c20b15a250bb61252a65 Mon Sep 17 00:00:00 2001
From: Alexander Galanin <al@galanin.nnov.ru>
Date: Sun, 27 Jan 2013 19:03:13 +0400
Subject: [PATCH 26/27] Updated Russian translation

---
 GnucashMobile/res/values-ru/strings.xml | 58 ++++++++++++++++-----------------
 1 file changed, 29 insertions(+), 29 deletions(-)

diff --git a/GnucashMobile/res/values-ru/strings.xml b/GnucashMobile/res/values-ru/strings.xml
index d1ac7c99..82ac3a40 100644
--- a/GnucashMobile/res/values-ru/strings.xml
+++ b/GnucashMobile/res/values-ru/strings.xml
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
- Copyright (c) 2012 Ngewi Fet <ngewif@gmail.com>
- Copyright (c) 2012 Alexander Galanin <al@galanin.nnov.ru>
+ Copyright (c) 2012-13 Ngewi Fet <ngewif@gmail.com>
+ Copyright (c) 2012-13 Alexander Galanin <al@galanin.nnov.ru>
  
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
@@ -235,7 +235,7 @@
 		<item>Tala</item>
 		<item>Tanzanian Shilling</item>
 		<item>Tenge</item>
-		<item>No currency</item>
+		<item> </item>
 		<item>Trinidad and Tobago Dollar</item>
 		<item>Tugrik</item>
 		<item>Tunisian Dinar</item>
@@ -264,8 +264,8 @@
 	    <item></item>
 	    <item></item>
 	    <item></item>	    
-	    <item>Equity</item>
-	    <item>Liabilities</item>
+	    <item></item>
+	    <item></item>
 	</string-array>
 	<string name="error_no_accounts">   Gnucash.\n  ,    .</string>
 	<string name="title_build_version"> </string>
@@ -280,7 +280,7 @@
 	<string name="toast_error_exporting">    OFX  :\n</string>
 	<string name="toast_ofx_exported_to"> OFX  :\n</string>
 	<string name="title_export_email"> OFX-  Gnucash</string>
-	<string name="description_export_email">OFX-,   Gnucash</string>
+	<string name="description_export_email">OFX-,   Gnucash </string>
 	<string name="header_transaction_settings"></string>
 	<string name="title_transaction_preferences"> </string>
 	<string name="title_account_preferences"> </string>
@@ -290,29 +290,29 @@
 	    <item></item>
 	    <item></item>
 	</string-array>
-	<string name="delete_all_transactions_confirmation_message">Are you sure you want to delete ALL transactions?</string>
-	<string name="delete_transaction_confirmation_message">Are you sure you want to delete this transaction?</string>
-	<string name="title_export_preference_category">Export</string>
-	<string name="title_export_all_transactions">Export all transactions</string>
-	<string name="title_always_delete_exported_transactions">Delete exported transactions</string>
-	<string name="title_default_export_email">Default export email</string>
-	<string name="summary_default_export_email">The default email address to send exports to. You can still change this when you export.</string>	
-	<string name="label_double_entry_account">Transfer Account</string>
-	<string name="summary_use_double_entry">All transactions will be a transfer from one account to another</string>
-	<string name="title_use_double_entry">Activate Double Entry</string>
-	<string name="account_balance">Balance</string>
-	<string name="toast_no_account_name_entered">Please enter an account name</string>
-	<string name="label_account_currency">Currency</string>
-	<string name="label_parent_account">Parent account</string>
-	<string name="title_xml_ofx_header">Use XML OFX header</string>
-	<string name="summary_xml_ofx_header">Enable this option when exporting to third-party application other than GnuCash for desktop</string>
-	<string name="title_whats_new">What\'s New</string>
+	<string name="delete_all_transactions_confirmation_message">     ?</string>
+	<string name="delete_transaction_confirmation_message">     ?</string>
+	<string name="title_export_preference_category"></string>
+	<string name="title_export_all_transactions">  </string>
+	<string name="title_always_delete_exported_transactions">  </string>
+	<string name="title_default_export_email">E-mail  </string>
+	<string name="summary_default_export_email">     .     .</string>
+	<string name="label_double_entry_account"> </string>
+	<string name="summary_use_double_entry">   (    ).         .</string>
+	<string name="title_use_double_entry">  </string>
+	<string name="account_balance"></string>
+	<string name="toast_no_account_name_entered">  </string>
+	<string name="label_account_currency"></string>
+	<string name="label_parent_account"> </string>
+	<string name="title_xml_ofx_header"> XML- OFX</string>
+	<string name="summary_xml_ofx_header">  ,       GnuCash  </string>
+	<string name="title_whats_new"></string>
 	<string name="whats_new">
-	    <b>Version 1.1.0 - 31.01.2013</b>\n\n
-        - Double entry accounting\n
-        - Nested accounts\n
-        - SGML is default OFX export format\n
-        - Numerous bug fixes\n	        
+	    <b> 1.1.0 - 31.01.2013</b>\n\n
+        -  \n
+        -  \n
+        -  SGML -      OFX\n
+        -   \n
 	</string>
 	<string name="label_dismiss">Dismiss</string>
-</resources>
\ No newline at end of file
+</resources>

From 377cfce6dc5cb5cb5cfef952d779c9ea20b71938 Mon Sep 17 00:00:00 2001
From: Ngewi Fet <ngewif@gmail.com>
Date: Wed, 30 Jan 2013 22:47:58 +0100
Subject: [PATCH 27/27] Updated strings for v1.1.0 release

---
 CHANGELOG.md                      | 4 ++--
 GnucashMobile/AndroidManifest.xml | 2 +-
 GnucashMobile/pom.xml             | 2 +-
 README.md                         | 4 ++--
 4 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index b97bf1b9..6b944552 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -6,13 +6,13 @@ Version 1.1.0 *(2013-01-31)*
 
 * Feature: Double entry accounting - every transaction is a transfer
 * Feature: Nested accounts
-* Feature: SGML support for OFX exports. Fixes encoding detection problems during imports
+* Feature: SGML support for OFX exports. Exports are now SGML by default 
 * Feature: Display what's new to user after minor/major updates
 * Improved: Reworked UX for creating accounts
 * Improved: Default accounts now match GnuCash desktop accounts
 * Fixed: Crash when creating accounts with special characters in the names
 * Fixed: GnuCash declares itself as launcher application
-
+* Fixed: Encoding of exported OFX not properly detected by GnuCash desktop
 
 Version 1.0.3 *(2012-11-23)*
 ----------------------------
diff --git a/GnucashMobile/AndroidManifest.xml b/GnucashMobile/AndroidManifest.xml
index d59a8399..051ed14f 100644
--- a/GnucashMobile/AndroidManifest.xml
+++ b/GnucashMobile/AndroidManifest.xml
@@ -18,7 +18,7 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="org.gnucash.android"
     android:versionCode="5"
-    android:versionName="1.1.0.beta1" >
+    android:versionName="1.1.0" >
 
     <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15"/>
     
diff --git a/GnucashMobile/pom.xml b/GnucashMobile/pom.xml
index 33fca957..b2297596 100644
--- a/GnucashMobile/pom.xml
+++ b/GnucashMobile/pom.xml
@@ -23,7 +23,7 @@
   <description>Gnucash Android mobile application</description>
   
   <parent>
-    <version>1.0.0-SNAPSHOT</version>
+    <version>1.1.0</version>
     <groupId>org.gnucash.android</groupId>
     <artifactId>gnucash-android-parent</artifactId>
   </parent>
diff --git a/README.md b/README.md
index b8359e72..b8f6e8b6 100644
--- a/README.md
+++ b/README.md
@@ -1,14 +1,14 @@
 # Introduction
 
 Gnucash Mobile for Android is companion application for desktop Gnucash designed for Android.
-It allows you to record transactions on-the-go and export them in the OFX format and later import the data into Gnucash for the desktop. You can create multiple accounts for transactions in Gnucash.
+It allows you to record transactions on-the-go and export them in the OFX format and later import the data into Gnucash for the desktop. You can create multiple accounts for transactions in Gnucash. Double-entry accounting is also supported. 
 
 The application supports Android 2.2 Froyo (API level 8) and above. 
 
 
 # Installation
 
-There are different ways to get the Gnucash app for Android.
+There are different ways to get the Gnucash app for Android; through the app store, or building it yourself.
 
 
 ### App Store
